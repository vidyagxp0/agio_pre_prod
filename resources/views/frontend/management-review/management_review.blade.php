@extends('frontend.layout.main')
@section('container')
    <style>
        textarea.note-codable {
            display: none !important;
        }

        header {
            display: none;
        }

        .swal-modal {
            scale: 0.7 !important;
        }

        .whyblock-bottom {
            margin-bottom: 10px;
        }

        .swal-icon {
            scale: 0.8 !important;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"
        integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    @if (Session::has('swal'))
        <script>
            swal("{{ Session::get('swal')['title'] }}", "{{ Session::get('swal')['message'] }}",
                "{{ Session::get('swal')['type'] }}")
        </script>
    @endif



    <script>
        function otherController(value, checkValue, blockID) {
            let block = document.getElementById(blockID)
            let blockTextarea = block.getElementsByTagName('textarea')[0];
            let blockLabel = block.querySelector('label span.text-danger');
            if (value === checkValue) {
                blockLabel.classList.remove('d-none');
                blockTextarea.setAttribute('required', 'required');
            } else {
                blockLabel.classList.add('d-none');
                blockTextarea.removeAttribute('required');
            }
        }
    </script>
    @php
        $users = DB::table('users')->get();
    @endphp

    <div class="form-field-head">

        <div class="division-bar">
            <strong>Site Division/Project</strong> :
            {{ Helpers::getDivisionName($data->division_id) }} / Management Review
        </div>
    </div>

    <div id="change-control-view">
        <div class="container-fluid">

            <div class="inner-block state-block">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="main-head">Record Workflow </div>

                    <div class="d-flex" style="gap:20px;">
                        {{-- @php
                            $userRoles = DB::table('user_roles')
                                ->where(['user_id' => Auth::user()->id, 'q_m_s_divisions_id' => $data->division_id])
                                ->get();
                            $userRoleIds = $userRoles->pluck('q_m_s_roles_id')->toArray();
                        @endphp --}}
                        @php
                            $userRoles = DB::table('user_roles')
                                ->where(['user_id' => Auth::user()->id, 'q_m_s_divisions_id' => $data->division_id])
                                ->get();
                            $userRoleIds = $userRoles->pluck('q_m_s_roles_id')->toArray();
                            $cftRolesAssignUsers = collect($userRoleIds); //->contains(fn ($roleId) => $roleId >= 22 && $roleId <= 33);
                            $cftUsers = DB::table('management_cfts')
                                ->where(['ManagementReview_id' => $data->id])
                                ->first();

                            // Define the column names
                            $columns = [
                                'Production_Table_Person',
                                'Production_Injection_Person',
                                'ResearchDevelopment_person',
                                'Store_person',
                                'Quality_Control_Person',
                                'QualityAssurance_person',
                                'RegulatoryAffair_person',
                                'ProductionLiquid_person',
                                'Microbiology_person',
                                'Engineering_person',
                                'ContractGiver_person',
                                'Environment_Health_Safety_person',
                                'Human_Resource_person',
                                'CorporateQualityAssurance_person',
                            ];

                            // Initialize an array to store the values
                            $valuesArray = [];

                            // Iterate over the columns and retrieve the values
                            foreach ($columns as $column) {
                                $value = $cftUsers->$column;
                                // Check if the value is not null and not equal to 0
                                if ($value !== null && $value != 0) {
                                    $valuesArray[] = $value;
                                }
                            }
                            $cftCompleteUser = DB::table('management_cft__responses')
                                ->whereIn('status', ['In-progress', 'Completed'])
                                ->where('ManagementReview_id', $data->id)
                                ->where('cft_user_id', Auth::user()->id)
                                ->whereNull('deleted_at')
                                ->first();
                            // dd($cftCompleteUser);
                        @endphp

                        @php
                            $userRoles = DB::table('user_roles')
                                ->where(['user_id' => Auth::user()->id, 'q_m_s_divisions_id' => $data->division_id])
                                ->get();
                            $userRoleIds = $userRoles->pluck('q_m_s_roles_id')->toArray();
                            $cftRolesAssignUsers = collect($userRoleIds); //->contains(fn ($roleId) => $roleId >= 22 && $roleId <= 33);
                            $hodcftUsers = DB::table('hodmanagement_cfts')
                                ->where(['ManagementReview_id' => $data->id])
                                ->first();

                            // Define the column names
                            $columns2 = [
                                'hod_Production_Table_Person',
                                'hod_Production_Injection_Person',
                                'hod_ResearchDevelopment_person',
                                'hod_Store_person',
                                'hod_Quality_Control_Person',
                                'hod_QualityAssurance_person',
                                'hod_RegulatoryAffair_person',
                                'hod_ProductionLiquid_person',
                                'hod_Microbiology_person',
                                'hod_Engineering_person',
                                'hod_ContractGiver_person',
                                'hod_Environment_Health_Safety_person',
                                'hod_Human_Resource_person',
                                'hod_CorporateQualityAssurance_person',
                            ];

                            // Initialize an array to store the values
                            $valuesArray = [];

                            // Iterate over the columns and retrieve the values
                            foreach ($columns2 as $column) {
                                $value = $hodcftUsers->$column;
                                // Check if the value is not null and not equal to 0
                                if ($value !== null && $value != 0) {
                                    $valuesArray[] = $value;
                                }
                            }
                            $hodcftCompleteUser = DB::table('hodmanagement_cft__responses')
                                ->whereIn('status', ['In-progress', 'Completed'])
                                ->where('ManagementReview_id', $data->id)
                                ->where('cft_user_id', Auth::user()->id)
                                ->whereNull('deleted_at')
                                ->first();
                            // dd($cftCompleteUser);
                        @endphp

                        {{-- <button class="button_theme1" onclick="window.print();return false;"
                            class="new-doc-btn">Print</button> --}}
                        <button class="button_theme1"> <a class="text-white"
                                href="{{ url('ManagementReviewAuditTrial', $data->id) }}"> Audit Trail </a> </button>

                        @if ($data->stage == 1 && Helpers::check_roles($data->division_id, 'Management Review', 7))
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                Submit
                            </button>
                        @elseif($data->stage == 2 && Helpers::check_roles($data->division_id, 'Management Review', 42))
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#rejection-modal">
                                More Info Required
                            </button>
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                QA Head Review Complete
                            </button>


                            <!-- <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#child-modal">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Child
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </button> -->
                        @elseif($data->stage == 3 && Helpers::check_roles($data->division_id, 'Management Review', 7))
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                Meeting and Summary Complete
                            </button>
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#child-modal">
                                Child
                            </button>
                            <!-- <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#child-modal">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Child
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </button> -->
                            {{-- <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#rejection-modal">
                                More Info Required
                            </button> --}}
                        @elseif(
                            ($data->stage == 4 && Helpers::check_roles($data->division_id, 'Management Review', 5)) ||
                                in_array(Auth::user()->id, $valuesArray))
                            <!-- @if (!$cftCompleteUser)
    -->
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                CFT Action Complete
                            </button>
                            <!--
    @endif -->
                        @elseif(
                            ($data->stage == 5 && Helpers::check_roles($data->division_id, 'Management Review', 5)) ||
                                in_array(Auth::user()->id, $valuesArray))
                            <!-- @if (!$hodcftCompleteUser)
    -->
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                CFT HOD Review Complete
                            </button>
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#rejection-modal">
                                More Info Required
                            </button>
                            <!--
    @endif -->
                        @elseif($data->stage == 6 && Helpers::check_roles($data->division_id, 'Management Review', 7))
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                QA Verification Complete
                            </button>
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#rejection-modal">
                                More Info Required
                            </button>
                        @elseif($data->stage == 7 && Helpers::check_roles($data->division_id, 'Management Review', 42))
                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#signature-modal">
                                Approved
                            </button>

                            <button class="button_theme1" data-bs-toggle="modal" data-bs-target="#rejection-modal">
                                More Info Required
                            </button>
                        @endif
                        <button class="button_theme1"> <a class="text-white" href="{{ url('rcms/qms-dashboard') }}"> Exit
                            </a> </button>


                    </div>

                </div>
                <div class="status">
                    <div class="head">Current Status</div>
                    {{-- ------------------------------By Pankaj-------------------------------- --}}
                    @if ($data->stage == 0)
                        <div class="progress-bars">
                            <div class="bg-danger">Closed-Cancelled</div>
                        </div>
                    @else
                        <div class="progress-bars">
                            @if ($data->stage >= 1)
                                <div class="active">Opened</div>
                            @else
                                <div class="">Opened</div>
                            @endif

                            {{-- @if ($data->stage >= 2)
                                <div class="active">In Progress </div>
                            @else
                                <div class="">In Progress</div>
                            @endif --}}
                            @if ($data->stage >= 2)
                                <div class="active">QA Head Review </div>
                            @else
                                <div class="">QA Head Review</div>
                            @endif
                            @if ($data->stage >= 3)
                                <div class="active">Meeting And Summary </div>
                            @else
                                <div class="">Meeting And Summary</div>
                            @endif
                            @if ($data->stage >= 4)
                                <div class="active">CFT Actions </div>
                            @else
                                <div class="">CFT Actions </div>
                            @endif
                            @if ($data->stage >= 5)
                                <div class="active">CFT HOD Review </div>
                            @else
                                <div class="">CFT HOD Review</div>
                            @endif
                            @if ($data->stage >= 6)
                                <div class="active">QA Verification </div>
                            @else
                                <div class="">QA Verification</div>
                            @endif
                            @if ($data->stage >= 7)
                                <div class="active">QA Head Closure Approval </div>
                            @else
                                <div class="">QA Head Closure Approval</div>
                            @endif
                            @if ($data->stage >= 8)
                                <div class="bg-danger">Closed - Done</div>
                            @else
                                <div class="">Closed - Done</div>
                            @endif
                    @endif


                </div>
                {{-- @endif --}}
                {{-- ---------------------------------------------------------------------------------------- --}}
            </div>
        </div>
    </div>


    {{-- ======================================
                    DATA FIELDS
    ======================================= --}}
    <div id="change-control-fields">

        <div class="container-fluid">



            <!-- Tab links -->
            <div class="cctab">
                <button class="cctablinks active" onclick="openCity(event, 'CCForm1')">General Information</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm2')">QA Head Review </button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm3')">Meetings and Summary</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm6')">CFT</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm7')">CFT HOD Review</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm8')">QA Verification</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm4')">Closure</button>
                <button class="cctablinks" onclick="openCity(event, 'CCForm5')">Activity log</button>
            </div>

            <form action="{{ route('manageUpdate', $data->id) }}" method="post" enctype="multipart/form-data">
                @csrf
                <div id="step-form">
                    <div id="CCForm1" class="inner-block cctabcontent">
                        <div class="inner-block-content">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="RLS Record Number"><b>Record Number</b></label>
                                        <input disabled type="text" name="record_number"
                                            value=" {{ Helpers::getDivisionName($data->division_id) }}/MR/{{ Helpers::year($data->created_at) }}/{{ $data->record }}">
                                        {{-- <div class="static">QMS-EMEA/CAPA/{{ date('Y') }}/{{ $record_number }}</div> --}}
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Division Code"><b>Site/Location Code</b></label>
                                        <input disabled type="text" name="division_code"
                                            value=" {{ Helpers::getDivisionName($data->division_id) }}">
                                        {{-- <div class="static">{{ Helpers::getDivisionName(session()->get('division')) }}</div> --}}
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Initiator"><b>Initiator</b></label>
                                        <input type="hidden" name="initiator_id">
                                        <input disabled type="text" value="{{ $data->initiator_name }}">
                                    </div>
                                </div>
                                {{-- <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="originator">Initiator</label>
                                        <input disabled type="text" name="initiator" value="{{ Auth::user()->name }}" />
                                    </div>
                                </div> --}}
                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Date Due"><b>Date of Initiation</b></label>
                                        <input disabled type="text"
                                            value="{{ Helpers::getdateFormat($data->intiation_date) }}"
                                            name="intiation_date">
                                        {{-- <input type="hidden" value="{{ $data->intiation_date }}" name="intiation_date"> --}}

                                        {{-- <div class="static">{{ date('d-M-Y') }}</div> --}}
                                    </div>
                                </div>
                                {{-- <div class="col-md-6">
                                    <div class="group-input">
                                        <label for="search">
                                            Assigned To <span class="text-danger"></span>
                                        </label>
                                        <select id="select-state" placeholder="Select..." name="assign_to"
                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>
                                            <option value="">Select a value</option>
                                            @foreach ($users as $key => $value)
                                                <option
                                                    value="{{ $value->id }}"@if ($data->assign_to == $value->id) selected @endif>
                                                    {{ $value->name }}</option>
                                            @endforeach
                                        </select>
                                        @error('assign_to')
                                            <p class="text-danger">{{ $message }}</p>
                                        @enderror
                                    </div>
                                </div> --}}

                                {{-- <div class="col-md-6">
                                    <div class="group-input">
                                        <label for="due-date">Due Date <span class="text-danger"></span></label>
                                        <div><small class="text-primary">Please Mention justification if due date
                                                iscrossed</small></div>
                                        <input readonly type="text"
                                            value="{{ Helpers::getdateFormat($data->due_date) }}"
                                            name="due_date"{{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>


                                    </div>
                                </div> --}}
                                {{-- <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Due Date"> Due Date </label>
                                        <div><small class="text-primary">Please Mention justification if due date
                                                iscrossed</small></div>
                                        <input type="text" id="due_date" readonly placeholder="DD-MMM-YYYY"
                                            value="{{ \Carbon\Carbon::parse($due_date)->format('d-M-Y') }}" />
                                        <input type="hidden" name="due_date"
                                            id="due_date_input"{{ $data->stage == 0 || $data->stage == 4 ? 'disabled' : '' }}
                                            value="{{ $due_date }}" />

                                        {{-- <input type="hidden" value="{{ $due_date }}" name="due_date">
                                        <input disabled type="text" value="{{ Helpers::getdateFormat($due_date) }}"> --}}
                                {{-- <input type="date" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                            value="" name="due_date">
                                    </div>
                                </div> --}}
                                <div class="row">
                                    {{--
                                 <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Initiator Group"><b>Initiator Department<span class="text-danger">*</span></b></label>
                                        <select name="initiator_Group"
                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                            id="initiator_group">
                                            <option value="">-- Select --</option>
                                            @foreach (Helpers::getDepartments() as $key => $value)
                                                <option value="{{ $key }}" @if ($data->initiator_Group == $key) selected @endif>
                                                    {{ $value }}
                                                </option>
                                            @endforeach
                                        </select>


                                        @error('initiator_Group')
                                            <div class="text-danger">
                                                {{ $message }}
                                            </div>
                                        @enderror
                                    </div>
                                </div> --}}
                                <div class="col-md-12">
                                    <div class="group-input">
                                        <label for="Initiator Group"><b>Initiator Department<span class="text-danger">*</span></b></label>
                                        <select name="initiator_Group" id="initiator_group"
                                            @if ($data->stage != 1) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach (Helpers::getDepartments() as $key => $value)
                                                <option value="{{ $key }}"
                                                    @if ($data->initiator_Group == $key) selected @endif>
                                                    {{ $value }}
                                                </option>
                                            @endforeach
                                        </select>
                                        @if ($data->stage != 1)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="initiator_Group" value="{{ $data->initiator_Group }}">
                                        @endif
                                    </div>
                                    @error('initiator_Group')
                                        <div class="text-danger">{{ $message }}</div>
                                    @enderror
                                </div>


                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Initiator Group Code">Initiator Department Code</label>
                                            <input type="text" name="initiator_group_code"
                                                value="{{ $data->initiator_Group }}" id="initiator_group_code"
                                                value="{{ $data->initiator_Group }}" readonly>
                                        </div>
                                    </div>

                                </div>
                                <!-- <div class="col-12">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <div class="group-input">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <label for="Short Description">Short Description <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span></label>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div><small class="text-primary">Please mention brief summary</small></div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <textarea name="short_description" id="short_desc"  {{ $data->stage != 1 ? 'readonly' : '' }}>{{ $data->short_description }}</textarea>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                 </div> -->






                               <div class="col-12">
                                <div class="group-input">
                                    <label for="Short_Description">Short Description<span class="text-danger">*</span></label>
                                    <span id="rchars">255</span> characters remaining

                                    <input name="short_description" id="docname" type="text" maxlength="255" required
                                        value="{{ $data->short_description }}"
                                        @if ($data->stage != 1) readonly @endif />

                                    @if ($data->stage != 1)
                                        <!-- Hidden field to retain the value if input is readonly -->
                                        <input type="hidden" name="short_description" value="{{ $data->short_description }}">
                                    @endif

                                    <p id="docnameError" style="color:red">**Short Description is required</p>
                                </div>
                            </div>




                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="type">Type
                                            @if ($data->stage == 1)
                                                <span class="text-danger">*</span>
                                            @endif
                                        </label>
                                        <select name="summary_recommendation" id="summary_recommendation"
                                            onchange="toggleReviewPeriod()"
                                            @if ($data->stage != 1) disabled @endif required>
                                            <option value="">Select Type</option>
                                            <option @if ($data->summary_recommendation == 'Monthly') selected @endif value="Monthly">
                                                Monthly
                                            </option>
                                            <option @if ($data->summary_recommendation == 'Six Monthly') selected @endif value="Six Monthly">
                                                Six Monthly
                                            </option>
                                        </select>

                                        @if ($data->stage != 1)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="summary_recommendation" value="{{ $data->summary_recommendation }}">
                                        @endif
                                    </div>
                                </div>



                                <!-- Review Period for Monthly (initially hidden) -->

                                <div class="col-lg-6" id="review_period_monthly" style="display: none;">
                                    <div class="group-input">
                                        <label for="review_period">Review Period
                                            @if ($data->stage == 1)
                                                <span class="text-danger">*</span>
                                            @endif
                                        </label>
                                        <select name="review_period_monthly" id="review_period_monthly_select" required
                                            @if ($data->stage != 1) disabled @endif>
                                            <option value="">Select Month</option>
                                            <option @if ($data->review_period_monthly == 'January') selected @endif value="January">January</option>
                                            <option @if ($data->review_period_monthly == 'February') selected @endif value="February">February</option>
                                            <option @if ($data->review_period_monthly == 'March') selected @endif value="March">March</option>
                                            <option @if ($data->review_period_monthly == 'April') selected @endif value="April">April</option>
                                            <option @if ($data->review_period_monthly == 'May') selected @endif value="May">May</option>
                                            <option @if ($data->review_period_monthly == 'June') selected @endif value="June">June</option>
                                            <option @if ($data->review_period_monthly == 'July') selected @endif value="July">July</option>
                                            <option @if ($data->review_period_monthly == 'August') selected @endif value="August">August</option>
                                            <option @if ($data->review_period_monthly == 'September') selected @endif value="September">September</option>
                                            <option @if ($data->review_period_monthly == 'October') selected @endif value="October">October</option>
                                            <option @if ($data->review_period_monthly == 'November') selected @endif value="November">November</option>
                                            <option @if ($data->review_period_monthly == 'December') selected @endif value="December">December</option>
                                        </select>

                                        @if ($data->stage != 1)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="review_period_monthly" value="{{ $data->review_period_monthly }}">
                                        @endif

                                        <span id="monthly_error" style="color: red; display: none;">Please select a month</span>
                                    </div>
                                </div>



                                <!-- Review Period for Six Monthly (initially hidden) -->
                                <div class="col-lg-6" id="review_period_six_monthly" style="display: none;">
                                    <div class="group-input">
                                        <label for="review_period">Review Period
                                            @if ($data->stage == 1)
                                                <span class="text-danger">*</span>
                                            @endif
                                        </label>
                                        <select name="review_period_six_monthly" id="review_period_six_monthly_select" required
                                            @if ($data->stage != 1) disabled @endif>
                                            <option value="">Select Period</option>
                                            <option @if ($data->review_period_six_monthly == 'January to June') selected @endif value="January to June">
                                                January to June
                                            </option>
                                            <option @if ($data->review_period_six_monthly == 'July to December') selected @endif value="July to December">
                                                July to December
                                            </option>
                                        </select>

                                        @if ($data->stage != 1)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="review_period_six_monthly" value="{{ $data->review_period_six_monthly }}">
                                        @endif

                                        <span id="six_monthly_error" style="color: red; display: none;">Please select a six-month period</span>
                                    </div>
                                </div>

                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        // Call the function to set the correct fields when the page loads
                                        toggleReviewPeriod();
                                    });

                                    function toggleReviewPeriod() {
                                        // Get the selected value of the "Type" dropdown
                                        let type = document.getElementById('summary_recommendation').value;

                                        // Get both the "Review Period" fields
                                        let reviewPeriodMonthlyField = document.getElementById('review_period_monthly');
                                        let reviewPeriodSixMonthlyField = document.getElementById('review_period_six_monthly');

                                        // Reset both fields and hide initially
                                        reviewPeriodMonthlyField.style.display = 'none';
                                        reviewPeriodSixMonthlyField.style.display = 'none';
                                        document.getElementById('review_period_monthly_select').removeAttribute('required');
                                        document.getElementById('review_period_six_monthly_select').removeAttribute('required');

                                        // Show appropriate field based on the selection
                                        if (type === 'Monthly') {
                                            reviewPeriodMonthlyField.style.display = 'block';
                                            document.getElementById('review_period_monthly_select').setAttribute('required', 'required');
                                        } else if (type === 'Six Monthly') {
                                            reviewPeriodSixMonthlyField.style.display = 'block';
                                            document.getElementById('review_period_six_monthly_select').setAttribute('required', 'required');
                                        }
                                    }

                                    // Form submission validation
                                    function validateForm() {
                                        let type = document.getElementById('summary_recommendation').value;
                                        let monthlySelect = document.getElementById('review_period_monthly_select').value;
                                        let sixMonthlySelect = document.getElementById('review_period_six_monthly_select').value;
                                        let valid = true;

                                        // Hide error messages initially
                                        document.getElementById('monthly_error').style.display = 'none';
                                        document.getElementById('six_monthly_error').style.display = 'none';

                                        // If "Monthly" is selected but no month is chosen
                                        if (type === 'Monthly' && !monthlySelect) {
                                            document.getElementById('monthly_error').style.display = 'block';
                                            valid = false;
                                        }

                                        // If "Six Monthly" is selected but no period is chosen
                                        if (type === 'Six Monthly' && !sixMonthlySelect) {
                                            document.getElementById('six_monthly_error').style.display = 'block';
                                            valid = false;
                                        }

                                        return valid;
                                    }

                                    // Add form submission handler
                                    document.querySelector('form').addEventListener('submit', function(e) {
                                        if (!validateForm()) {
                                            e.preventDefault(); // Prevent form submission if validation fails
                                        }
                                    });
                                </script>

                                {{-- <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="type">Type</label>
                                        <select  {{ $data->stage != 1 ? 'readonly' : '' }}
                                            name="type">
                                            <option value="0">-- Select type --</option>
                                            <option @if ($data->type == 'Other') selected @endif value="Other">
                                                Other</option>
                                            <option @if ($data->type == 'Training') selected @endif value="Training">
                                                Training</option>
                                            <option @if ($data->type == 'Finance') selected @endif value="Finance">
                                                Finance</option>
                                            <option @if ($data->type == 'follow Up') selected @endif value="follow Up">
                                                Follow Up</option>
                                            <option @if ($data->type == 'Marketing') selected @endif value="Marketing">
                                                Marketing</option>
                                            <option @if ($data->type == 'Sales') selected @endif value="Sales">
                                                Sales</option>
                                            <option @if ($data->type == 'Account Service') selected @endif
                                                value="Account Service">Account Service</option>
                                            <option @if ($data->type == 'Recent Product Launch') selected @endif
                                                value="Recent Product Launch">Recent Product Launch</option>
                                            <option @if ($data->type == 'IT') selected @endif value="IT">
                                                IT
                                            </option>
                                        </select>
                                    </div>
                                </div> --}}
                                {{-- <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Priority Level">Priority Level</label>
                                        <select  {{ $data->stage != 1 ? 'readonly' : '' }}
                                            name="priority_level">
                                            <option @if ($data->priority_level == 'High') selected @endif value="High">
                                                High
                                            </option>
                                            <option @if ($data->priority_level == 'Medium') selected @endif value="Medium">
                                                Medium</option>
                                            <option @if ($data->priority_level == 'Low') selected @endif value="Low">
                                                Low
                                            </option>
                                        </select>
                                    </div>
                                </div> --}}
                                {{-- <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Scheduled Start Date">Scheduled Start Date</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="start_date"  readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data->start_date) }}"/>
                                            <input type="date"  id="start_date_checkdate"  {{ $data->stage != 1 ? 'readonly' : '' }} value="{{ $data->start_date}} "
                                            name="start_date" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" class="hide-input"
                                                oninput="handleDateInput(this, 'start_date');checkDate('start_date_checkdate','end_date_checkdate')" />
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Scheduled end date">Scheduled end date</label>
                                        {{-- <input type="text" name="end_date"
                                             {{ $data->stage != 1 ? 'readonly' : '' }}> --}}
                                {{-- <div class="calenderauditee">
                                                <input type="text" id="end_date"  readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data->end_date) }}"/>
                                                <input type="date"  id="end_date_checkdate"  {{ $data->stage != 1 ? 'readonly' : '' }} name="end_date" value="{{ $data->end_date }} "
                                                class="hide-input"
                                                    oninput="handleDateInput(this, 'end_date');checkDate('start_date_checkdate','end_date_checkdate')" />
                                            </div>
                                    </div>
                                </div> --}}
                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit Start Date">Proposed Scheduled Start Date
                                            @if ($data->stage == 1)
                                                <span class="text-danger">*</span>
                                            @endif
                                        </label>
                                        <div class="calenderauditee">
                                            <input type="text" id="start_date" readonly placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data->start_date) }}" />

                                            <input type="date" id="start_date_checkdate"
                                                name="start_date"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                                value="{{ $data->start_date }}"
                                                class="hide-input"
                                                @if($data->stage != 1) disabled @endif
                                                required
                                                oninput="handleDateInput(this, 'start_date');checkDate('start_date_checkdate','end_date_checkdate')" />

                                            @if($data->stage != 1)
                                                <!-- Hidden field to retain the value if date input is disabled -->
                                                <input type="hidden" name="start_date" value="{{ $data->start_date }}">
                                            @endif
                                        </div>
                                    </div>
                                </div>


                                {{-- <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit End Date">Scheduled end date</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="end_date" readonly placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data->end_date) }}" />
                                            <input type="date" id="end_date_checkdate"
                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                name="end_date" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                                value="{{ $data->end_date }}" class="hide-input"
                                                oninput="handleDateInput(this, 'end_date');checkDate('start_date_checkdate','end_date_checkdate')" />
                                        </div>
                                    </div>
                                </div> --}}
                                {{-- <div class="col-12">
                                    <div class="group-input">
                                        <label for="Attendees">Attendess</label>
                                        <textarea name="attendees"  {{ $data->stage != 1 ? 'readonly' : '' }}>{{ $data->attendees }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="agenda">
                                            Agenda<button type="button" name="agenda"
                                                onclick="addAgendaManRev('agenda')">+</button>
                                        </label>
                                        <table class="table table-bordered" id="agenda">
                                            <thead>
                                                <tr>
                                                    <th style="width:5%">Row #</th>
                                                    <th>Date</th>
                                                    <th>Topic</th>
                                                    <th>Responsible</th>
                                                    <th>Time Start</th>
                                                    <th>Time End</th>
                                                    <th>Comment</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (unserialize($agenda->topic) as $key => $temps)
                                                    <tr>
                                                        <td><input disabled type="text" name="serial_number[]"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                value="{{ $key + 1 }}"></td>

                                                        <td>
                                                            <div class="group-input new-date-data-field mb-0">
                                                                <div class="input-date ">
                                                                    <div class="calenderauditee">
                                                                        <input type="text"
                                                                            id="date{{ $key }}"
                                                                             {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                            readonly placeholder="DD-MMM-YYYY"
                                                                            value="{{ Helpers::getdateFormat(unserialize($agenda->date)[$key] ?? null) }}" />
                                                                        <input type="date" name="date[]"
                                                                             {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                            min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                                                            value="{{ unserialize($agenda->date)[$key] ?? null }}"
                                                                            class="hide-input"
                                                                            oninput="handleDateInput(this, `date{{ $key }}`)" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td><input type="text" name="topic[]"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                value="{{ unserialize($agenda->topic)[$key] ?? '' }}">
                                                        </td>
                                                        <td><input type="text" name="responsible[]"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                value="{{ unserialize($agenda->responsible)[$key] ? unserialize($agenda->responsible)[$key] : '' }}">
                                                        </td>
                                                        <td><input type="time" name="start_time[]"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                value="{{ unserialize($agenda->start_time)[$key] ? unserialize($agenda->start_time)[$key] : '' }}">
                                                        </td>
                                                        <td><input type="time"
                                                                name="end_time[]"{{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                                value="{{ unserialize($agenda->end_time)[$key] ? unserialize($agenda->end_time)[$key] : '' }}">
                                                        </td>
                                                        <td><input type="text" name="comment[]"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                value="{{ unserialize($agenda->comment)[$key] ? unserialize($agenda->comment)[$key] : '' }}">
                                                        </td>
                                                        <td>
                                                            <button type="button"
                                                                 {{ $data->stage != 1 ? 'readonly' : '' }}
                                                                class="removeRow">remove

                                                            </button>
                                                        </td>
                                                    </tr>
                                                @endforeach
                                            </tbody>
                                        </table>
                                    </div>
                                </div> --}}
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Description">Description</label>
                                        <textarea name="description"  {{ $data->stage != 1 ? 'readonly' : '' }}>{{ $data->description }}</textarea>
                                    </div>
                                </div>

                                {{-- <div class="col-12">
                                    <div class="group-input">
                                        <label for="Inv Attachments">File Attachment</label>
                                        <div>
                                            <small class="text-primary">
                                                Please Attach all relevant or supporting documents
                                            </small>
                                        </div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="audit_file_attachment">
                                                @if ($data->inv_attachment)
                                                    @foreach (json_decode($data->inv_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                                    class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input type="file" id="audit_file_attachment" name="inv_attachment[]"
                                                     {{ $data->stage != 1 ? 'readonly' : '' }}
                                                    oninput="addMultipleFiles(this, 'audit_file_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div> --}}
                                {{-- <div class="col-12">
                                    <div class="group-input">
                                        <label for="Inv Attachments">GI Attachment</label>
                                        <div>
                                            <small class="text-primary">
                                                Please Attach all relevant or supporting documents
                                            </small>
                                        </div>
                                        <div class="file-attachment-field">
                                            <div class="file-attachment-list" id="inv_attachment">
                                                @if ($data->inv_attachment)
                                                    @foreach (json_decode($data->inv_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                                    class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input type="file" id="inv_attachment" name="inv_attachment[]"
                                                     {{ $data->stage != 1 ? 'readonly' : '' }}
                                                    oninput="addMultipleFiles(this, 'inv_attachment')" multiple>
                                            </div>
                                        </div>
                                        <!-- Hidden input to store removed files -->
                                        <input type="hidden" name="removed_files" id="removed_files">
                                    </div>
                                </div>

                                <script>
                                    document.querySelectorAll('.remove-file').forEach(function(element) {
                                        element.addEventListener('click', function() {
                                            const fileName = this.getAttribute('data-file-name');

                                            // Remove file from the UI
                                            this.closest('.file-container').remove();

                                            // Add the file name to the hidden input for removed files
                                            let removedFilesInput = document.getElementById('removed_files');
                                            let currentRemovedFiles = removedFilesInput.value ? removedFilesInput.value.split(',') : [];
                                            currentRemovedFiles.push(fileName);
                                            removedFilesInput.value = currentRemovedFiles.join(',');
                                        });
                                    });
                                </script> --}}
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="inv_attachment">GI Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div class="file-attachment-list" id="inv_attachment">
                                                @if ($data->inv_attachment)
                                                    @foreach (json_decode($data->inv_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}" target="_blank">
                                                                <i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i>
                                                            </a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}">
                                                                <i class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i>
                                                            </a>
                                                            <input type="hidden" name="existing_inv_attachment[]"
                                                                value="{{ $file }}">
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input type="file" id="myfile" name="inv_attachment[]"
                                                     {{ $data->stage != 1 ? 'readonly' : '' }}
                                                    oninput="addMultipleFiles(this, 'inv_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Hidden field to keep track of files to be deleted -->
                                <input type="hidden" id="deleted_inv_attachment" name="deleted_inv_attachment"
                                    value="">

                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        const removeButtons = document.querySelectorAll('.remove-file');

                                        removeButtons.forEach(button => {
                                            button.addEventListener('click', function() {
                                                const fileName = this.getAttribute('data-file-name');
                                                const fileContainer = this.closest('.file-container');

                                                // Hide the file container
                                                if (fileContainer) {
                                                    fileContainer.style.display = 'none';
                                                    // Remove hidden input associated with this file
                                                    const hiddenInput = fileContainer.querySelector('input[type="hidden"]');
                                                    if (hiddenInput) {
                                                        hiddenInput.remove();
                                                    }

                                                    // Add the file name to the deleted files list
                                                    const deletedFilesInput = document.getElementById('deleted_inv_attachment');
                                                    let deletedFiles = deletedFilesInput.value ? deletedFilesInput.value.split(
                                                        ',') : [];
                                                    deletedFiles.push(fileName);
                                                    deletedFilesInput.value = deletedFiles.join(',');
                                                }
                                            });
                                        });
                                    });

                                    function addMultipleFiles(input, id) {
                                        const fileListContainer = document.getElementById(id);
                                        const files = input.files;

                                        for (let i = 0; i < files.length; i++) {
                                            const file = files[i];
                                            const fileName = file.name;
                                            const fileContainer = document.createElement('h6');
                                            fileContainer.classList.add('file-container', 'text-dark');
                                            fileContainer.style.backgroundColor = 'rgb(243, 242, 240)';

                                            const fileText = document.createElement('b');
                                            fileText.textContent = fileName;

                                            const viewLink = document.createElement('a');
                                            viewLink.href = '#'; // You might need to adjust this to handle local previews
                                            viewLink.target = '_blank';
                                            viewLink.innerHTML = '<i class="fa fa-eye text-primary" style="font-size:20px; margin-right:-10px;"></i>';

                                            const removeLink = document.createElement('a');
                                            removeLink.classList.add('remove-file');
                                            removeLink.dataset.fileName = fileName;
                                            removeLink.innerHTML = '<i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i>';
                                            removeLink.addEventListener('click', function() {
                                                fileContainer.style.display = 'none';
                                            });

                                            fileContainer.appendChild(fileText);
                                            fileContainer.appendChild(viewLink);
                                            fileContainer.appendChild(removeLink);

                                            fileListContainer.appendChild(fileContainer);
                                        }
                                    }
                                </script>


                            </div>
                            <div class="button-block">
                                <button type="submit" id="ChangesaveButton" class="saveButton"
                                     {{ $data->stage != 1 ? 'readonly' : '' }}>Save</button>
                                <button type="button" id="ChangeNextButton" class="nextButton">Next</button>
                                <button type="button"> <a class="text-white" href="{{ url('rcms/qms-dashboard') }}">
                                        Exit </a> </button>
                            </div>
                        </div>
                    </div>

                    <div id="CCForm2" class="inner-block cctabcontent">
                        <div class="inner-block-content">
                            {{-- <div class="group-input">
                                <label for="Operations">
                                    QA review comment<span class="text-danger">*</span>
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-operations-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="Operations" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->Operations }}</textarea>
                            </div> --}}
                            <div class="col-md-12">
                                @if ($data->stage == 2)
                                    <div class="group-input">
                                        <label for="HOD Remarks">QA Head Review comment <span
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="tiny" name="Operations" id="summernote-4" required>{{ $data->Operations }}</textarea>
                                    </div>
                                @else
                                    <div class="group-input">
                                        <label for="QA review comment">QA Head Review comment</label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea readonly class="tiny" name="Operations" id="summernote-4">{{ $data->Operations }}</textarea>
                                    </div>
                                @endif
                                @error('Operations')
                                    <div class="text-danger">{{ $message }}</div>
                                @enderror
                            </div>
                            @php
                            $assignedUsers = !empty($data->assign_to) ? explode(',', $data->assign_to) : [];
                        @endphp
                      <div class="col-lg-12">
                        <div class="group-input">
                            <label for="assign_to">Invite Person Notify
                                @if ($data->stage == 2)
                                    <span class="text-danger">*</span>
                                @endif
                            </label>

                            <!-- Disabled select for stages not equal to 1 -->
                            <select id="assign_to" name="assign_to[]"
                                @if ($data->stage != 2) disabled @endif multiple>
                                <option value="">Select a value</option>
                                @foreach ($users as $user)
                                    <option value="{{ $user->name }}" {{ in_array($user->name, $assignedUsers) ? 'selected' : '' }}>
                                        {{ $user->name }}
                                    </option>
                                @endforeach
                            </select>

                            @if ($data->stage != 2)
                                <!-- Hidden fields to retain selected values when select is disabled -->
                                @foreach ($assignedUsers as $assignedUser)
                                    <input type="hidden" name="assign_to[]" value="{{ $assignedUser }}">
                                @endforeach
                            @endif

                            @error('assign_to')
                                <p class="text-danger">{{ $message }}</p>
                            @enderror
                        </div>
                    </div>



                            {{-- <div class="col-12">
                                <div class="group-input">
                                    <label for="Inv Attachments">QA Head Review Attachment</label>
                                    <div>
                                        <small class="text-primary">
                                            Please Attach all relevant or supporting documents
                                        </small>
                                    </div>
                                    <div class="file-attachment-field">
                                        <div class="file-attachment-list" id="file_attchment_if_any">
                                            @if ($data->file_attchment_if_any)
                                                @foreach (json_decode($data->file_attchment_if_any) as $file)
                                                    <h6 type="button" class="file-container text-dark"
                                                        style="background-color: rgb(243, 242, 240);">
                                                        <b>{{ $file }}</b>
                                                        <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                                class="fa fa-eye text-primary"
                                                                style="font-size:20px; margin-right:-10px;"></i></a>
                                                        <a type="button" class="remove-file"
                                                            data-file-name="{{ $file }}"><i
                                                                class="fa-solid fa-circle-xmark"
                                                                style="color:red; font-size:20px;"></i></a>
                                                    </h6>
                                                @endforeach
                                            @endif
                                        </div>
                                        <div class="add-btn">
                                            <div>Add</div>
                                            <input type="file" id="file_attchment_if_any"
                                                name="file_attchment_if_any[]"
                                                {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                oninput="addMultipleFiles(this, 'file_attchment_if_any')" multiple>
                                        </div>
                                    </div>
                                    <!-- Hidden input to store removed files -->
                                    <input type="hidden" name="removed_files" id="removed_files">
                                      </div>
                            </div> --}}
                            <div class="col-12">
                                <div class="group-input">
                                    <label for="file_attchment_if_any">QA Head Review Attachment</label>
                                    <div><small class="text-primary">Please Attach all relevant or supporting
                                            documents</small></div>
                                    <div class="file-attachment-field">
                                        <div class="file-attachment-list" id="file_attchment_if_any">
                                            @if ($data->file_attchment_if_any)
                                                @foreach (json_decode($data->file_attchment_if_any) as $file)
                                                    <h6 type="button" class="file-container text-dark"
                                                        style="background-color: rgb(243, 242, 240);">
                                                        <b>{{ $file }}</b>
                                                        <a href="{{ asset('upload/' . $file) }}" target="_blank">
                                                            <i class="fa fa-eye text-primary"
                                                                style="font-size:20px; margin-right:-10px;"></i>
                                                        </a>
                                                        <a type="button" class="remove-file"
                                                            data-file-name="{{ $file }}">
                                                            <i class="fa-solid fa-circle-xmark"
                                                                style="color:red; font-size:20px;"></i>
                                                        </a>
                                                        <input type="hidden" name="existing_file_attchment_if_any[]"
                                                            value="{{ $file }}">
                                                    </h6>
                                                @endforeach
                                            @endif
                                        </div>
                                        <div class="add-btn">
                                            <div>Add</div>
                                            <input type="file" id="myfile" name="file_attchment_if_any[]"
                                            {{ $data->stage != 2 ? 'readonly' : '' }}
                                                oninput="addMultipleFiles(this, 'file_attchment_if_any')" multiple>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Hidden field to keep track of files to be deleted -->
                            <input type="hidden" id="deleted_file_attchment_if_any" name="deleted_file_attchment_if_any"
                                value="">

                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const removeButtons = document.querySelectorAll('.remove-file');

                                    removeButtons.forEach(button => {
                                        button.addEventListener('click', function() {
                                            const fileName = this.getAttribute('data-file-name');
                                            const fileContainer = this.closest('.file-container');

                                            // Hide the file container
                                            if (fileContainer) {
                                                fileContainer.style.display = 'none';
                                                // Remove hidden input associated with this file
                                                const hiddenInput = fileContainer.querySelector('input[type="hidden"]');
                                                if (hiddenInput) {
                                                    hiddenInput.remove();
                                                }

                                                // Add the file name to the deleted files list
                                                const deletedFilesInput = document.getElementById(
                                                    'deleted_file_attchment_if_any');
                                                let deletedFiles = deletedFilesInput.value ? deletedFilesInput.value.split(
                                                    ',') : [];
                                                deletedFiles.push(fileName);
                                                deletedFilesInput.value = deletedFiles.join(',');
                                            }
                                        });
                                    });
                                });

                                function addMultipleFiles(input, id) {
                                    const fileListContainer = document.getElementById(id);
                                    const files = input.files;

                                    for (let i = 0; i < files.length; i++) {
                                        const file = files[i];
                                        const fileName = file.name;
                                        const fileContainer = document.createElement('h6');
                                        fileContainer.classList.add('file-container', 'text-dark');
                                        fileContainer.style.backgroundColor = 'rgb(243, 242, 240)';

                                        const fileText = document.createElement('b');
                                        fileText.textContent = fileName;

                                        const viewLink = document.createElement('a');
                                        viewLink.href = '#'; // You might need to adjust this to handle local previews
                                        viewLink.target = '_blank';
                                        viewLink.innerHTML = '<i class="fa fa-eye text-primary" style="font-size:20px; margin-right:-10px;"></i>';

                                        const removeLink = document.createElement('a');
                                        removeLink.classList.add('remove-file');
                                        removeLink.dataset.fileName = fileName;
                                        removeLink.innerHTML = '<i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i>';
                                        removeLink.addEventListener('click', function() {
                                            fileContainer.style.display = 'none';
                                        });

                                        fileContainer.appendChild(fileText);
                                        fileContainer.appendChild(viewLink);
                                        fileContainer.appendChild(removeLink);

                                        fileListContainer.appendChild(fileContainer);
                                    }
                                }
                            </script>









                            {{-- <div class="group-input">
                                <label for="requirement_products_services">
                                    Requirements for Products and Services
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-requirement_products_services-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="requirement_products_services" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->requirement_products_services }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="design_development_product_services">
                                    Design and Development of Products and Services
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-design_development_product_services-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="design_development_product_services" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->design_development_product_services }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="control_externally_provide_services">
                                    Control of Externally Provided Processes, Products and Services
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-control_externally_provide_services-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="control_externally_provide_services" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->control_externally_provide_services }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="production_service_provision">
                                    Production and Service Provision
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-production_service_provision-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="production_service_provision" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->production_service_provision }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="release_product_services">
                                    Release of Products and Services
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-release_product_services-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="release_product_services" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->release_product_services }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="control_nonconforming_outputs">
                                    Control of Non-conforming Outputs
                                    <span class="text-primary" data-bs-toggle="modal"
                                        data-bs-target="#management-review-control_nonconforming_outputs-instruction-modal"
                                        style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                        (Launch Instruction)
                                    </span>
                                </label>
                                <textarea name="control_nonconforming_outputs" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->control_nonconforming_outputs }}</textarea>
                            </div> --}}
                            {{-- <div class="col-12">
                                <div class="group-input">
                                    <label for="performance_evaluation">
                                        Performance Evaluation
                                        <button type="button" name="performance_evaluation"
                                            onclick="addPerformanceEvoluation('performance_evaluation')">+</button>
                                        <span class="text-primary" data-bs-toggle="modal"
                                            data-bs-target="#management-review-performance_evaluation-instruction-modal"
                                            style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
                                            (Launch Instruction)
                                        </span>
                                    </label>
                                    <table class="table table-bordered" id="performance_evaluation">
                                        <thead>
                                            <tr>
                                                <th style="width:5%">Row #</th>
                                                <th>Monitoring</th>
                                                <th>Measurement</th>
                                                <th>Analysis</th>
                                                <th>Evalutaion</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <!-- <tbody>
                                                                                                                                                                                                <tr>
                                                                                                                                                                                                    <td><input type="text" name="row_no" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}  value="1" disabled></td>
                                                                                                                                                                                                    <td><input type="text" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}  name="monitoring"></td>
                                                                                                                                                                                                    <td><input type="text" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }} name="measurement"></td>
                                                                                                                                                                                                    <td><input type="text" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}  name="analysis"></td>
                                                                                                                                                                                                    <td><input type="text" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}  name="evaluation"></td>
                                                                                                                                                                                                </tr>
                                                                                                                                                                                            </tbody> -->
                                        <tbody>
                                            @foreach (unserialize($performance_evaluation->monitoring) as $key => $temps)
                                                <tr>
                                                    <td><input disabled type="text" name="serial_number[]"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            value="{{ $key + 1 }}"></td>
                                                    <td><input type="text" name="monitoring[]"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            value="{{ unserialize($performance_evaluation->monitoring)[$key] ? unserialize($performance_evaluation->monitoring)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="measurement[]"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            value="{{ unserialize($performance_evaluation->measurement)[$key] ? unserialize($performance_evaluation->measurement)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="analysis[]"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            value="{{ unserialize($performance_evaluation->analysis)[$key] ? unserialize($performance_evaluation->analysis)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="evaluation[]"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            value="{{ unserialize($performance_evaluation->evaluation)[$key] ? unserialize($performance_evaluation->evaluation)[$key] : '' }}">
                                                    </td>
                                                    <td>
                                                        <button type="button"
                                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                                            class="removeBtn">remove

                                                        </button>
                                                    </td>
                                                </tr>
                                            @endforeach
                                        </tbody>
                                    </table>
                                </div>
                            </div> --}}
                            <div class="button-block">
                                <button type="submit" class="saveButton">Save</button>
                                <button type="button" class="backButton" onclick="previousStep()">Back</button>
                                <button type="button" class="nextButton" onclick="nextStep()">Next</button>
                                <button type="button"> <a class="text-white"> Exit </a> </button>
                            </div>
                        </div>
                    </div>

                    <div id="CCForm3" class="inner-block cctabcontent">
                        <div class="inner-block-content">
                            <div class="row">
                                @if ($data->stage == 3)
                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit Start Date">Meeting Start Date @if ($data->stage == 3)
                                            <span class="text-danger">*</span>
                                        @endif</label>
                                        <div class="calenderauditee">
                                            <!-- Disabled state for stage 0 or 8 -->
                                            <input type="text" id="external_supplier_performance" readonly

                                                placeholder="DD-MMM-YYYY" required
                                                value="{{ Helpers::getdateFormat($data->external_supplier_performance) }}" />
                                            <input type="date" id="external_supplier_performance_checkdate"
                                                name="external_supplier_performance"
                                                    {{-- max="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" --}}

                                                value="{{ $data->external_supplier_performance }}" class="hide-input"
                                                oninput="handleDateInput(this, 'external_supplier_performance'); checkStartDate(this)" />

                                        </div>
                                    </div>
                                </div>
                                @else
                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit Start Date">Meeting Start Date @if ($data->stage == 3)
                                            <span class="text-danger">*</span>
                                        @endif</label>
                                        <div class="calenderauditee">
                                            <!-- Disabled state for stage 0 or 8 -->
                                            <input type="text" id="external_supplier_performance" readonly

                                                placeholder="DD-MMM-YYYY" required
                                                value="{{ Helpers::getdateFormat($data->external_supplier_performance) }}" />
                                            <input readonly type="date" id="external_supplier_performance_checkdate"
                                                name="external_supplier_performance"
                                                    {{-- max="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" --}}

                                                value="{{ $data->external_supplier_performance }}" class="hide-input"
                                                oninput="handleDateInput(this, 'external_supplier_performance'); checkStartDate(this)" />

                                        </div>
                                    </div>
                                </div>
                                @endif

                                @if ($data->stage == 3)
                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit End Date">Meeting End Date  @if ($data->stage == 3)
                                            <span class="text-danger">*</span>
                                        @endif</label>
                                        <div class="calenderauditee">

                                            <input type="text" id="customer_satisfaction_level" readonly

                                                placeholder="DD-MMM-YYYY" required
                                                value="{{ Helpers::getdateFormat($data->customer_satisfaction_level) }}" />
                                            <input type="date" id="customer_satisfaction_level_checkdate"
                                                name="customer_satisfaction_level"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"

                                                value="{{ $data->customer_satisfaction_level }}" class="hide-input"
                                                oninput="handleDateInput(this, 'customer_satisfaction_level')" />
                                        </div>
                                    </div>
                                </div>
                                @else
                                <div class="col-lg-6 new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Audit End Date">Meeting End Date  @if ($data->stage == 3)
                                            <span class="text-danger">*</span>
                                        @endif</label>
                                        <div class="calenderauditee">

                                            <input type="text" id="customer_satisfaction_level" readonly

                                                placeholder="DD-MMM-YYYY" required
                                                value="{{ Helpers::getdateFormat($data->customer_satisfaction_level) }}" />
                                            <input readonly type="date" id="customer_satisfaction_level_checkdate"
                                                name="customer_satisfaction_level"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"

                                                value="{{ $data->customer_satisfaction_level }}" class="hide-input"
                                                oninput="handleDateInput(this, 'customer_satisfaction_level')" />
                                        </div>
                                    </div>
                                </div>
                                @endif



                                <script>
                                    function checkStartDate(startDateInput) {
                                        let startDate = startDateInput.value;
                                        if (startDate) {
                                            // Set the minimum selectable date for the End Date to the selected Start Date
                                            document.getElementById('customer_satisfaction_level_checkdate').min = startDate;
                                        }
                                    }
                                </script>


                                <div class="col-6">
                                    <div class="group-input">
                                        <label for="Short_Description">Meeting Start Time</label>
                                        <input name="budget_estimates" id="docname" type="time"
                                        {{ $data->stage != 3 ? 'readonly' : '' }}
                                            value="{{ $data->budget_estimates }}">
                                    </div>
                                </div>

                                <div class="col-6">
                                    <div class="group-input">
                                        <label for="completion_of_previous_tasks">Meeting End Time</label>
                                        <input name="completion_of_previous_tasks" id="docname" type="time"
                                        {{ $data->stage != 3 ? 'readonly' : '' }}
                                            value="{{ $data->completion_of_previous_tasks }}">
                                    </div>
                                </div>

                            </div>
                            <div class="col-12">
                                <div class="group-input">
                                    <label for="management_review_participants">
                                        Management Review Participants
                                        <button type="button"{{ $data->stage != 3 ? 'disabled' : '' }}
                                            onclick="addManagementReviewParticipants('management_review_participants')">+</button>
                                    </label>
                                    <div class="instruction">
                                        {{-- <small class="text-primary">
                                            Refer Attached Performance Evaluation Grid
                                        </small> --}}
                                    </div>
                                    <table class="table table-bordered" id="management_review_participants">
                                        <thead>
                                            <tr>
                                                <th style="width:5%">Row #</th>
                                                <th>Invited Person</th>
                                                <th>Designation</th>
                                                <th>Department</th>
                                                <th>Meeting Attended</th>
                                                <th>Designee Name</th>
                                                <th>Designee Department/Designation</th>
                                                <th>Remarks</th>
                                                <th>Action</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (unserialize($management_review_participants->invited_Person) as $key => $temps)
                                                <tr>
                                                    <td><input disabled type="text" name="serial_number[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ $key + 1 }}"></td>
                                                    <td><input type="text" name="invited_Person[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->invited_Person)[$key] ? unserialize($management_review_participants->invited_Person)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="designee[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->designee)[$key] ? unserialize($management_review_participants->designee)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="department[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->department)[$key] ? unserialize($management_review_participants->department)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="meeting_Attended[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->meeting_Attended)[$key] ? unserialize($management_review_participants->meeting_Attended)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="designee_Name[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->designee_Name)[$key] ? unserialize($management_review_participants->designee_Name)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="designee_Department[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->designee_Department)[$key] ? unserialize($management_review_participants->designee_Department)[$key] : '' }}">
                                                    </td>
                                                    <td><input type="text" name="remarks[]"
                                                           {{ $data->stage != 3 ? 'readonly' : '' }}
                                                            value="{{ unserialize($management_review_participants->remarks)[$key] ? unserialize($management_review_participants->remarks)[$key] : '' }}">
                                                    </td>
                                                    <td>
                                                        <button type="button"
                                                           {{ $data->stage != 3 ? 'disabled' : '' }}
                                                            class="removeBtnaid">remove

                                                        </button>
                                                    </td>
                                                </tr>
                                            @endforeach
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="col-12">
                                <div class="group-input">
                                    <label for="meeting_and_summary_attachment">Meetings and Summary Attachment</label>
                                    <div><small class="text-primary">Please Attach all relevant or supporting
                                            documents</small></div>
                                    <div class="file-attachment-field">
                                        <div class="file-attachment-list" id="meeting_and_summary_attachment">
                                            @if ($data->meeting_and_summary_attachment)
                                                @foreach (json_decode($data->meeting_and_summary_attachment) as $file)

                                                    <h6 type="button" class="file-container text-dark"
                                                        style="background-color: rgb(243, 242, 240);">
                                                        <b>{{ $file }}</b>
                                                        <a href="{{ asset('upload/' . $file) }}" target="_blank">
                                                            <i class="fa fa-eye text-primary"
                                                                style="font-size:20px; margin-right:-10px;"></i>
                                                        </a>
                                                        <a type="button" class="remove-file"
                                                            data-file-name="{{ $file }}">
                                                            <i class="fa-solid fa-circle-xmark"
                                                                style="color:red; font-size:20px;"></i>
                                                        </a>
                                                        <input type="hidden" name="existing_meeting_and_summary_attachment[]"
                                                            value="{{ $file }}">
                                                    </h6>
                                                @endforeach
                                            @endif
                                        </div>
                                        <div class="add-btn">
                                            <div>Add</div>
                                            <input type="file" id="myfile" name="meeting_and_summary_attachment[]"
                                            {{ $data->stage != 3 ? 'disabled' : '' }}
                                                oninput="addMultipleFiles(this, 'meeting_and_summary_attachment')" multiple>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Hidden field to keep track of files to be deleted -->
                            <input type="hidden" id="deleted_meeting_and_summary_attachment" name="deleted_meeting_and_summary_attachment"
                                value="">

                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    const removeButtons = document.querySelectorAll('.remove-file');

                                    removeButtons.forEach(button => {
                                        button.addEventListener('click', function() {
                                            const fileName = this.getAttribute('data-file-name');
                                            const fileContainer = this.closest('.file-container');

                                            // Hide the file container
                                            if (fileContainer) {
                                                fileContainer.style.display = 'none';
                                                // Remove hidden input associated with this file
                                                const hiddenInput = fileContainer.querySelector('input[type="hidden"]');
                                                if (hiddenInput) {
                                                    hiddenInput.remove();
                                                }

                                                // Add the file name to the deleted files list
                                                const deletedFilesInput = document.getElementById(
                                                    'deleted_meeting_and_summary_attachment');
                                                let deletedFiles = deletedFilesInput.value ? deletedFilesInput.value.split(
                                                    ',') : [];
                                                deletedFiles.push(fileName);
                                                deletedFilesInput.value = deletedFiles.join(',');
                                            }
                                        });
                                    });
                                });

                                function addMultipleFiles(input, id) {
                                    const fileListContainer = document.getElementById(id);
                                    const files = input.files;

                                    for (let i = 0; i < files.length; i++) {
                                        const file = files[i];
                                        const fileName = file.name;
                                        const fileContainer = document.createElement('h6');
                                        fileContainer.classList.add('file-container', 'text-dark');
                                        fileContainer.style.backgroundColor = 'rgb(243, 242, 240)';

                                        const fileText = document.createElement('b');
                                        fileText.textContent = fileName;

                                        const viewLink = document.createElement('a');
                                        viewLink.href = '#'; // You might need to adjust this to handle local previews
                                        viewLink.target = '_blank';
                                        viewLink.innerHTML = '<i class="fa fa-eye text-primary" style="font-size:20px; margin-right:-10px;"></i>';

                                        const removeLink = document.createElement('a');
                                        removeLink.classList.add('remove-file');
                                        removeLink.dataset.fileName = fileName;
                                        removeLink.innerHTML = '<i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i>';
                                        removeLink.addEventListener('click', function() {
                                            fileContainer.style.display = 'none';
                                        });

                                        fileContainer.appendChild(fileText);
                                        fileContainer.appendChild(viewLink);
                                        fileContainer.appendChild(removeLink);

                                        fileListContainer.appendChild(fileContainer);
                                    }
                                }
                            </script>
                            {{-- <div class="group-input">
                                <label for="risk_opportunities">Risk & Opportunities</label>
                                <textarea name="risk_opportunities" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->risk_opportunities }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="external_supplier_performance">External Supplier Performance</label>
                                <textarea name="external_supplier_performance" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->external_supplier_performance }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="customer_satisfaction_level">Customer Satisfaction Level</label>
                                <textarea name="customer_satisfaction_level" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->customer_satisfaction_level }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="budget_estimates">Budget Estimates</label>
                                <textarea name="budget_estimates" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->budget_estimates }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="completion_of_previous_tasks">Completion of Previous Tasks</label>
                                <textarea name="completion_of_previous_tasks" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->completion_of_previous_tasks }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="production">Production</label>
                                <textarea name="production_new" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->production_new }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="plans">Plans</label>
                                <textarea name="plans_new" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->plans_new }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="forecast">Forecast</label>
                                <textarea name="forecast_new" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->forecast_new }}</textarea>
                            </div>
                            <div class="group-input">
                                <label for="additional_suport_required">Any Additional Support Required</label>
                                <textarea name="additional_suport_required" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->additional_suport_required }}</textarea>
                            </div> --}}
                            {{-- <div class="group-input">
                                <label for="file_attchment_if_any">File Attachment, if any</label>
                                <div><small class="text-primary">Please Attach all relevant or supporting
                                        documents</small></div>
                                <div class="file-attachment-field">
                                    <div disabled class="file-attachment-list" id="file_attchment_if_any">
                                        @if ($data->file_attchment_if_any)
                                            @foreach (json_decode($data->file_attchment_if_any) as $file)
                                                <h6 type="button" class="file-container text-dark"
                                                    style="background-color: rgb(243, 242, 240);">
                                                    <b>{{ $file }}</b>
                                                    <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                            class="fa fa-eye text-primary"
                                                            style="font-size:20px; margin-right:-10px;"></i></a>
                                                    <a type="button" class="remove-file"
                                                        data-file-name="{{ $file }}"><i
                                                            class="fa-solid fa-circle-xmark"
                                                            style="color:red; font-size:20px;"></i></a>
                                                </h6>
                                            @endforeach
                                        @endif

                                    </div>
                                    <div class="add-btn">
                                        <div>Add</div>
                                        <input type="file" id="myfile" name="file_attchment_if_any[]"
                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                            oninput="addMultipleFiles(this, 'file_attchment_if_any')" multiple>
                                    </div>
                                </div>
                            </div> --}}
                            <div class="button-block">
                                <button type="submit" class="saveButton">Save</button>
                                <button type="button" class="backButton" onclick="previousStep()">Back</button>
                                <button type="button" class="nextButton" onclick="nextStep()">Next</button>
                                <button type="button"> <a class="text-white"> Exit </a> </button>
                            </div>
                        </div>
                    </div>

                    <div id="CCForm6" class="inner-block cctabcontent">
                        <div class="inner-block-content">
                            <div class="row">
                                <div class="sub-head">
                                    Production (Tablet/Capsule/Powder)
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Production_Table_Review !== 'yes')
                                            $('.productionTable').hide();

                                            $('[name="Production_Table_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.productionTable').show();
                                                    $('.productionTable span').show();
                                                } else {
                                                    $('.productionTable').hide();
                                                    $('.productionTable span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Tablet">Hod Production Tablet/Capsule/Powder Action Required ?
                                                <span class="text-danger">*</span></label>
                                            <select name="Production_Table_Review" id="Production_Table_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Production_Table_Review == 'yes' ) selected @endif value='yes'>Yes</option>
                                                <option @if ($data1->Production_Table_Review == 'no') selected @endif value='no'>
                                                    No</option>
                                                {{-- <option @if ($data1->Production_Table_Review == 'na') selected @endif value='na'>
                                                    NA</option> --}}
                                                    <option @if ($data1->Production_Table_Review == 'na' || empty($data1->Production_Table_Review)) selected @endif value='na'>NA</option>

                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 51,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet notification">Production Tablet/Capsule/Powder
                                                Person <span id="asteriskPT"
                                                    style="display: {{ $data1->Production_Table_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Production_Table_Person" class="Production_Table_Person"
                                                id="Production_Table_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Production_Table_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet notification">Production Tablet/Capsule / Powder HOD Person  <span id="asteriskPT"
                                                    style="display: {{ $data1->Production_Table_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Production_Table_Person" class="hod_Production_Table_Person"
                                                id="hod_Production_Table_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Production_Table_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet assessment">Description of Action Item (By
                                                Tablet/Capsule/Powder
                                                ) <span id="asteriskPT1"
                                                    style="display: {{ $data1->Production_Table_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Production_Table_Review == 'yes' && $data->stage == 4) required @endif class="summernote Production_Table_Assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->Production_Table_Person) && Auth::user()->name != $data1->Production_Table_Person)) readonly @endif name="Production_Table_Assessment" id="summernote-17">{{ $data1->Production_Table_Assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet feedback">Production Tablet/Capsule/Powder Status
                                                of Action Item
                                                <span id="asteriskPT2"
                                                    style="display: {{ $data1->Production_Table_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Production_Table_Feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->Production_Table_Person) && Auth::user()->name != $data1->Production_Table_Person)) readonly @endif
                                                name="Production_Table_Feedback" id="summernote-18" @if ($data1->Production_Table_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Production_Table_Feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet attachment">HOD Production Tablet/Capsule/Powder
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Production_Table_Attachment">
                                                    @if ($data1->Production_Table_Attachment)
                                                        @foreach (json_decode($data1->Production_Table_Attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Production_Table_Attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Production_Table_Attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet Completed By">HOd Production Tablet/Capsule/Powder Action
                                                Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Production_Table_By }}"
                                                name="Production_Table_By"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Production_Table_By">


                                        </div>
                                    </div>

                                    {{-- <div class="col-6 productionTable new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Tablet Completed On">Production Tablet
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Production_Table_On" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Production_Table_On) }}" />
                                                <input readonly type="date" name="Production_Table_On"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-M-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Production_Table_On')" />
                                            </div>
                                            @error('Production_Table_On')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div> --}}
                                    <div class="col-6 mb-3 productionTable new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Tablet Completed On">HOD Production Tablet/Capsule/Powder Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Production_Table_On" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Production_Table_On) }}" />
                                                <input readonly type="date" name="Production_Table_On"
                                                    min="{{ \Carbon\Carbon::now()->format('d-M-Y') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Production_Table_On')" />
                                            </div>
                                            @error('Production_Table_On')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>


                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Production_Table_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'Production_Table_Person' to inputsToToggle
                                            var productionTableInputs = document.getElementsByClassName('Production_Table_Person');
                                            for (var i = 0; i < productionTableInputs.length; i++) {
                                                inputsToToggle.push(productionTableInputs[i]);
                                            }

                                            // Add elements with class 'hod_Production_Table_Person' to inputsToToggle
                                            var hodTableInputs = document.getElementsByClassName('hod_Production_Table_Person');
                                            for (var i = 0; i < hodTableInputs.length; i++) {
                                                inputsToToggle.push(hodTableInputs[i]);
                                            }

                                            // Other fields can be added in a similar manner as needed
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Table_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Table_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Tablet">Production Tablet/Capsule/Powder Action Required
                                                ?</label>
                                            <select name="Production_Table_Review" disabled id="Production_Table_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Production_Table_Review == 'yes') selected @endif value='yes'>Yes</option>
                                                <option @if ($data1->Production_Table_Review == 'no') selected @endif value='no'>
                                                    No</option>
                                                {{-- <option @if ($data1->Production_Table_Review == 'na') selected @endif value='na'>
                                                    NA</option> --}}
                                                    <option @if ($data1->Production_Table_Review == 'na' || empty($data1->Production_Table_Review)) selected @endif value='na'>NA</option>

                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 51,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet notification">Production Tablet/Capsule/Powder
                                                Person <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Production_Table_Person" disabled id="Production_Table_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Production_Table_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet notification">HOD Production Tablet/Capsule/
                                                Powder Person <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_Production_Table_Person" disabled
                                                id="hod_Production_Table_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Production_Table_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 productionTable">
                                            <div class="group-input">
                                                <label for="Production Tablet assessment">Description of Action Item (By
                                                    Tablet/Capsule/Powder
                                                    )
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi12" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Production_Table_Assessment" id="summernote-17">{{ $data1->Production_Table_Assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionTable">
                                            <div class="group-input">
                                                <label for="Production Tablet feedback">Production Tablet/Capsule/Powder
                                                    Status of Action
                                                    item
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Production_Table_Feedback" id="summernote-18">{{ $data1->Production_Table_Feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 productionTable">
                                            <div class="group-input">
                                                <label for="Production Tablet assessment">Description of Action Item (By
                                                    Tablet/Capsule/Powder)
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi12" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Production_Table_Assessment" id="summernote-17">{{ $data1->Production_Table_Assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionTable">
                                            <div class="group-input">
                                                <label for="Production Tablet feedback">Production Tablet/Capsule/Powder
                                                    Status of Action Item
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Production_Table_Feedback" id="summernote-18">{{ $data1->Production_Table_Feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet attachment">HOD Production Tablet/Capsule/Powder
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Production_Table_Attachment">
                                                    @if ($data1->Production_Table_Attachment)
                                                        @foreach (json_decode($data1->Production_Table_Attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Production_Table_Attachment[]"
                                                        oninput="addMultipleFiles(this, 'Production_Table_Attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet Completed By">HOD Production Tablet/Capsule/Powder Action Completed By</label>
                                            <input readonly type="text" value="{{ $data1->Production_Table_By }}"
                                                name="Production_Table_By" id="Production_Table_By">


                                        </div>
                                    </div>
                                    <div class="col-6 mb-3 productionTable new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Tablet Completed On">HOD Production Tablet/Capsule/Powder Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Production_Table_On" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Production_Table_On) }}" />
                                                <input readonly type="date" name="Production_Table_On"
                                                    min="{{ \Carbon\Carbon::now()->format('d-M-Y') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Production_Table_On')" />
                                            </div>
                                            @error('Production_Table_On')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif

                                <div class="sub-head">
                                    Production Injection
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Production_Injection_Review !== 'yes')
                                            $('.productionInjection').hide();

                                            $('[name="Production_Injection_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.productionInjection').show();
                                                    $('.productionInjection span').show();
                                                } else {
                                                    $('.productionInjection').hide();
                                                    $('.productionInjection span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();

                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Injection"> Production Injection Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Production_Injection_Review" id="Production_Injection_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Production_Injection_Review == 'yes') selected @endif value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Production_Injection_Review == 'no') selected @endif value='no'>
                                                    No</option>
                                                    <option @if ($data1->Production_Injection_Review == 'na' || empty($data1->Production_Injection_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 53,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection notification">Production Injection Person
                                                <span id="asteriskPT"
                                                    style="display: {{ $data1->Production_Injection_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Production_Injection_Person" class="Production_Injection_Person"
                                                id="Production_Injection_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Production_Injection_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection notification">Production Injection HOD Person 
                                                <span id="asteriskPT"
                                                    style="display: {{ $data1->Production_Injection_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Production_Injection_Person"
                                                class="hod_Production_Injection_Person"
                                                id="hod_Production_Injection_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Production_Injection_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection assessment">Description of Action Item (By
                                                Production
                                                Injection) <span id="asteriskPT1"
                                                    style="display: {{ $data1->Production_Injection_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Production_Injection_Review == 'yes' && $data->stage == 4) required @endif class="summernote Production_Injection_Assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->Production_Injection_Person) && Auth::user()->name != $data1->Production_Injection_Person)) readonly @endif name="Production_Injection_Assessment" id="summernote-17">{{ $data1->Production_Injection_Assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection Status of Action Item">Production Injection
                                                Status of Action Item <span id="asteriskPT2"
                                                    style="display: {{ $data1->Production_Injection_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Production_Injection_Feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->Production_Injection_Person) && Auth::user()->name != $data1->Production_Injection_Person)) readonly @endif
                                                name="Production_Injection_Feedback" id="summernote-18" @if ($data1->Production_Injection_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Production_Injection_Feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection attachment">Production Injection
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Production_Injection_Attachment">
                                                    @if ($data1->Production_Injection_Attachment)
                                                        @foreach (json_decode($data1->Production_Injection_Attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Production_Injection_Attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Production_Injection_Attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection Completed By">Production Injection Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Production_Injection_By }}"
                                                name="Production_Injection_By"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Production_Injection_By">


                                        </div>
                                    </div>
                                    <div class="col-6 productionInjection new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Injection Completed On">Production Injection Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Production_Injection_On" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Production_Injection_On) }}" />
                                                <input readonly type="date" name="Production_Injection_On"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Production_Injection_On')" />
                                            </div>
                                            @error('Production_Injection_On')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>




                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Production_Injection_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'Production_Injection_Person' to inputsToToggle
                                            var productionInjectionPersonInputs = document.getElementsByClassName('Production_Injection_Person');
                                            for (var i = 0; i < productionInjectionPersonInputs.length; i++) {
                                                inputsToToggle.push(productionInjectionPersonInputs[i]);
                                            }

                                            // Add elements with class 'hod_Production_Injection_Person' to inputsToToggle
                                            var hodProductionInjectionPersonInputs = document.getElementsByClassName(
                                                'hod_Production_Injection_Person');
                                            for (var i = 0; i < hodProductionInjectionPersonInputs.length; i++) {
                                                inputsToToggle.push(hodProductionInjectionPersonInputs[i]);
                                            }


                                            // Uncomment the following sections if you need these too
                                            // var productionInjectionAssessmentInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < productionInjectionAssessmentInputs.length; i++) {
                                            //     inputsToToggle.push(productionInjectionAssessmentInputs[i]);
                                            // }

                                            // var productionInjectionFeedbackInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < productionInjectionFeedbackInputs.length; i++) {
                                            //     inputsToToggle.push(productionInjectionFeedbackInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Injection">Production Injection Action Required ?</label>
                                            <select name="Production_Injection_Review" disabled
                                                id="Production_Injection_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Production_Injection_Review == 'yes') selected @endif value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Production_Injection_Review == 'no') selected @endif value='no'>
                                                    No</option>
                                                    <option @if ($data1->Production_Injection_Review == 'na' || empty($data1->Production_Injection_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 53,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection notification">Production Injection Person
                                                <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Production_Injection_Person" disabled
                                                id="Production_Injection_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Production_Injection_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection notification">HOD Production Injection Person
                                                <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_Production_Injection_Person" disabled
                                                id="hod_Production_Injection_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Production_Injection_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>

                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 productionInjection">
                                            <div class="group-input">
                                                <label for="Production Injection assessment">Description of Action Item (By
                                                    Production Injection)
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi12" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Production_Injection_Assessment" id="summernote-17">{{ $data1->Production_Injection_Assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionInjection">
                                            <div class="group-input">
                                                <label for="Production Injection Status of Action Item">Production
                                                    Injection Status of Action Item
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Production_Injection_Feedback" id="summernote-18">{{ $data1->Production_Injection_Feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 productionInjection">
                                            <div class="group-input">
                                                <label for="Production Injection assessment">Description of Action Item (By
                                                    Production Injection)
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi12" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Production_Injection_Assessment" id="summernote-17">{{ $data1->Production_Injection_Assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionInjection">
                                            <div class="group-input">
                                                <label for="Production Injection Status of Action Item">Production
                                                    Injection Status of Action Item
                                                    <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                                </label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Production_Injection_Feedback" id="summernote-18">{{ $data1->Production_Injection_Feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection attachment">Production Injection
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Production_Injection_Attachment">
                                                    @if ($data1->Production_Injection_Attachment)
                                                        @foreach (json_decode($data1->Production_Injection_Attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Production_Injection_Attachment[]"
                                                        oninput="addMultipleFiles(this, 'Production_Injection_Attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection Completed By">Production Injection Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Production_Injection_By }}"
                                                name="Production_Injection_By" id="Production_Injection_By">


                                        </div>
                                    </div>
                                    <div class="col-6 productionInjection new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Injection Completed On">Production Injection
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Production_Injection_On" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Production_Injection_On) }}" />
                                                <input readonly type="date" name="Production_Injection_On"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Production_Injection_On')" />
                                            </div>
                                            @error('Production_Injection_On')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif


                                <div class="sub-head">
                                    Research & Development
                                </div>
                                <script>
                                    $(document).ready(function() {

                                        @if ($data1->ResearchDevelopment_Review !== 'yes')
                                            $('.researchDevelopment').hide();

                                            $('[name="ResearchDevelopment_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.researchDevelopment').show();
                                                    $('.researchDevelopment span').show();
                                                } else {
                                                    $('.researchDevelopment').hide();
                                                    $('.researchDevelopment span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Research Development"> Research & Development Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="ResearchDevelopment_Review" id="ResearchDevelopment_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->ResearchDevelopment_Review == 'yes') selected @endif value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->ResearchDevelopment_Review == 'no') selected @endif value='no'>
                                                    No</option>
                                                    <option @if ($data1->ResearchDevelopment_Review == 'na' || empty($data1->ResearchDevelopment_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 55,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development notification">Research & Development Person
                                                <span id="asteriskPT"
                                                    style="display: {{ $data1->ResearchDevelopment_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="ResearchDevelopment_person" class="ResearchDevelopment_person"
                                                id="ResearchDevelopment_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->ResearchDevelopment_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development notification">Research & Development HOD Person
                                                <span id="asteriskPT"
                                                    style="display: {{ $data1->ResearchDevelopment_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_ResearchDevelopment_person"
                                                class="hod_ResearchDevelopment_person"
                                                id="hod_ResearchDevelopment_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_ResearchDevelopment_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development assessment">Description of Action Item (By
                                                Research &
                                                Development) <span id="asteriskPT1"
                                                    style="display: {{ $data1->ResearchDevelopment_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->ResearchDevelopment_Review == 'yes' && $data->stage == 4) required @endif class="summernote ResearchDevelopment_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->ResearchDevelopment_person) && Auth::user()->name != $data1->ResearchDevelopment_person)) readonly @endif name="ResearchDevelopment_assessment" id="summernote-17">{{ $data1->ResearchDevelopment_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development Status of Action Item">Research & Development
                                                Status of Action Item <span id="asteriskPT2"
                                                    style="display: {{ $data1->ResearchDevelopment_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote ResearchDevelopment_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->ResearchDevelopment_person) && Auth::user()->name != $data1->ResearchDevelopment_person)) readonly @endif
                                                name="ResearchDevelopment_feedback" id="summernote-18" @if ($data1->ResearchDevelopment_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->ResearchDevelopment_feedback }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development attachment">Research & Development
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="ResearchDevelopment_attachment">
                                                    @if ($data1->ResearchDevelopment_attachment)
                                                        @foreach (json_decode($data1->ResearchDevelopment_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="ResearchDevelopment_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'ResearchDevelopment_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development Completed By">Research & Development Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->ResearchDevelopment_by }}"
                                                name="ResearchDevelopment_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="ResearchDevelopment_by">


                                        </div>
                                    </div>

                                    <div class="col-6 researchDevelopment new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Research Development Completed On">Research & Development Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="ResearchDevelopment_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->ResearchDevelopment_on) }}" />
                                                <input readonly type="date" name="ResearchDevelopment_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'ResearchDevelopment_on')" />
                                            </div>
                                            @error('ResearchDevelopment_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('ResearchDevelopment_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('ResearchDevelopment_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Research Development">Research & Development Action Required ?</label>
                                            <select name="ResearchDevelopment_Review" disabled
                                                id="ResearchDevelopment_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->ResearchDevelopment_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->ResearchDevelopment_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->ResearchDevelopment_Review == 'na' || empty($data1->ResearchDevelopment_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 55,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development notification">Research & Development Person
                                                <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="ResearchDevelopment_person" disabled
                                                id="ResearchDevelopment_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->ResearchDevelopment_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development notification">HOD Research & Development
                                                Person
                                                <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_ResearchDevelopment_person" disabled
                                                id="hod_ResearchDevelopment_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_ResearchDevelopment_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 researchDevelopment">
                                            <div class="group-input">
                                                <label for="Research Development assessment">Description of Action Item
                                                    (By
                                                    Research &
                                                    Development)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="ResearchDevelopment_assessment" id="summernote-17">{{ $data1->ResearchDevelopment_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 researchDevelopment">
                                            <div class="group-input">
                                                <label for="Research Development Status of Action Item">Research &
                                                    Development
                                                    Feedback</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="ResearchDevelopment_feedback" id="summernote-18">{{ $data1->ResearchDevelopment_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 researchDevelopment">
                                            <div class="group-input">
                                                <label for="Research Development assessment">Description of Action Item
                                                    (By
                                                    Research &
                                                    Development)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="ResearchDevelopment_assessment" id="summernote-17">{{ $data1->ResearchDevelopment_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 researchDevelopment">
                                            <div class="group-input">
                                                <label for="Research Development Status of Action Item">Research &
                                                    Development
                                                    Feedback</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="ResearchDevelopment_feedback" id="summernote-18">{{ $data1->ResearchDevelopment_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development attachment">Research & Development
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="ResearchDevelopment_attachment">
                                                    @if ($data1->ResearchDevelopment_attachment)
                                                        @foreach (json_decode($data1->ResearchDevelopment_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="ResearchDevelopment_attachment[]"
                                                        oninput="addMultipleFiles(this, 'ResearchDevelopment_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development Completed By">Research & Development Action
                                                Completed
                                                By</label>
                                            <input readonly type="text"
                                                value="{{ $data1->ResearchDevelopment_by }}"
                                                name="ResearchDevelopment_by" id="StorResearchDevelopment_by">


                                        </div>
                                    </div>
                                    <div class="col-6 researchDevelopment new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Research Development Completed On">Research & Development Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="ResearchDevelopment_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->ResearchDevelopment_on) }}" />
                                                <input readonly type="date" name="ResearchDevelopment_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'ResearchDevelopment_on')" />
                                            </div>
                                            @error('ResearchDevelopment_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif



                                <div class="sub-head">
                                    Human Resource
                                </div>
                                <script>
                                    $(document).ready(function() {

                                        @if ($data1->Human_Resource_review !== 'yes')
                                            $('.Human_Resource').hide();

                                            $('[name="Human_Resource_review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.Human_Resource').show();
                                                    $('.Human_Resource span').show();
                                                } else {
                                                    $('.Human_Resource').hide();
                                                    $('.Human_Resource span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Human Resource"> Human Resource Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Human_Resource_review" id="Human_Resource_review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Human_Resource_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Human_Resource_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Human_Resource_review == 'na' || empty($data1->Human_Resource_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 31,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource notification">Human Resource Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Human_Resource_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Human_Resource_person" class="Human_Resource_person"
                                                id="Human_Resource_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Human_Resource_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource notification">Human Resourse HOD Person<span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Human_Resource_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Human_Resource_person" class="hod_Human_Resource_person"
                                                id="hod_Human_Resource_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Human_Resource_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource assessment">Description of Action Item (By Human
                                                Resource)
                                                <span id="asteriskPT1"
                                                    style="display: {{ $data1->Human_Resource_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Human_Resource_review == 'yes' && $data->stage == 4) required @endif class="summernote Human_Resource_assessment"
                                                @if ($data->stage == 3 || (isset($data1->Human_Resource_person) && Auth::user()->name != $data1->Human_Resource_person)) readonly @endif name="Human_Resource_assessment" id="summernote-17">{{ $data1->Human_Resource_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource Status of Action Item">Human Resource Status of
                                                Action Item <span id="asteriskPT2"
                                                    style="display: {{ $data1->Human_Resource_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Human_Resource_feedback" @if ($data->stage == 3 || (isset($data1->Human_Resource_person) && Auth::user()->name != $data1->Human_Resource_person)) readonly @endif
                                                name="Human_Resource_feedback" id="summernote-18" @if ($data1->Human_Resource_review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Human_Resource_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource attachment">Human Resource Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Human_Resource_attachment">
                                                    @if ($data1->Human_Resource_attachment)
                                                        @foreach (json_decode($data1->Human_Resource_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Human_Resource_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Human_Resource_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource Completed By">Human Resource Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Human_Resource_by }}"
                                                name="Human_Resource_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Human_Resource_by">


                                        </div>
                                    </div>

                                    <div class="col-lg-6 Human_Resource new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Human Resource Completed On">Human Resource Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Human_Resource_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Human_Resource_on) }}" />
                                                <input readonly type="date" name="Human_Resource_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Human_Resource_on')" />
                                            </div>
                                            @error('Human_Resource_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>

                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Human_Resource_review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Human_Resource_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Human Resource">Human Resource Action Required ?</label>
                                            <select name="Human_Resource_review" disabled id="Human_Resource_review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Human_Resource_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Human_Resource_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Human_Resource_review == 'na' || empty($data1->Human_Resource_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 31,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource notification">Human Resource Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Human_Resource_person" disabled id="Human_Resource_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Human_Resource_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource notification">HOD Human Resource Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_Human_Resource_person" disabled
                                                id="hod_Human_Resource_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Human_Resource_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 Human_Resource">
                                            <div class="group-input">
                                                <label for="Human Resource assessment">Description of Action Item (By
                                                    Human
                                                    Resource)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Human_Resource_assessment" id="summernote-17">{{ $data1->Human_Resource_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Human_Resource">
                                            <div class="group-input">
                                                <label for="Human Resource Status of Action Item">Human Resource Status of
                                                    Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Human_Resource_feedback" id="summernote-18">{{ $data1->Human_Resource_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 Human_Resource">
                                            <div class="group-input">
                                                <label for="Human Resource assessment">Description of Action Item (By
                                                    Human
                                                    Resource)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Human_Resource_assessment" id="summernote-17">{{ $data1->Human_Resource_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Human_Resource">
                                            <div class="group-input">
                                                <label for="Human Resource Status of Action Item">Human Resource Status of
                                                    Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Human_Resource_feedback" id="summernote-18">{{ $data1->Human_Resource_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource attachment">Human Resource Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Human_Resource_attachment">
                                                    @if ($data1->Human_Resource_attachment)
                                                        @foreach (json_decode($data1->Human_Resource_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Human_Resource_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Human_Resource_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource Completed By">Human Resource Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Human_Resource_by }}"
                                                name="Human_Resource_by" id="Human_Resource_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 Human_Resource new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Human Resource Completed On">Human Resource Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Human_Resource_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Human_Resource_on) }}" />
                                                <input readonly type="date" name="Human_Resource_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Human_Resource_on')" />
                                            </div>
                                            @error('Human_Resource_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif


                                <div class="sub-head">
                                    Corporate Quality Assurance
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->CorporateQualityAssurance_Review !== 'yes')
                                            $('.CQA').hide();

                                            $('[name="CorporateQualityAssurance_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.CQA').show();
                                                    $('.CQA span').show();
                                                } else {
                                                    $('.CQA').hide();
                                                    $('.CQA span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance"> Corporate Quality Assurance Action Required
                                                ? <span class="text-danger">*</span></label>
                                            <select name="CorporateQualityAssurance_Review"
                                                id="CorporateQualityAssurance_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->CorporateQualityAssurance_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->CorporateQualityAssurance_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->CorporateQualityAssurance_Review == 'na' || empty($data1->CorporateQualityAssurance_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 58,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance notification">Corporate Quality
                                                Assurance Person <span id="asteriskPT"
                                                    style="display: {{ $data1->CorporateQualityAssurance_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="CorporateQualityAssurance_person"
                                                class="CorporateQualityAssurance_person"
                                                id="CorporateQualityAssurance_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->CorporateQualityAssurance_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance notification">Corporate Quality Assurance HOD Person <span id="asteriskPT"
                                                    style="display: {{ $data1->CorporateQualityAssurance_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_CorporateQualityAssurance_person"
                                                class="hod_CorporateQualityAssurance_person"
                                                id="hod_CorporateQualityAssurance_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_CorporateQualityAssurance_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance assessment">Description of Action Item
                                                (By
                                                Corporate Quality
                                                Assurance) <span id="asteriskPT1"
                                                    style="display: {{ $data1->CorporateQualityAssurance_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->CorporateQualityAssurance_Review == 'yes' && $data->stage == 4) required @endif class="summernote CorporateQualityAssurance_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->CorporateQualityAssurance_person) &&
                                                            Auth::user()->name != $data1->CorporateQualityAssurance_person)) readonly @endif name="CorporateQualityAssurance_assessment"
                                                id="summernote-17">{{ $data1->CorporateQualityAssurance_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance feedback">Corporate Quality Assurance
                                                Status of Action Item
                                                <span id="asteriskPT2"
                                                    style="display: {{ $data1->CorporateQualityAssurance_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote CorporateQualityAssurance_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->CorporateQualityAssurance_person) &&
                                                        Auth::user()->name != $data1->CorporateQualityAssurance_person)) readonly @endif
                                                name="CorporateQualityAssurance_feedback" id="summernote-18"
                                                @if ($data1->CorporateQualityAssurance_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->CorporateQualityAssurance_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance attachment">Corporate Quality
                                                Assurance
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="CorporateQualityAssurance_attachment">
                                                    @if ($data1->CorporateQualityAssurance_attachment)
                                                        @foreach (json_decode($data1->CorporateQualityAssurance_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="CorporateQualityAssurance_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'CorporateQualityAssurance_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance Completed By">Corporate Quality
                                                Assurance Action Completed
                                                By</label>
                                            <input readonly type="text"
                                                value="{{ $data1->CorporateQualityAssurance_by }}"
                                                name="CorporateQualityAssurance_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="CorporateQualityAssurance_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 CQA">
                                        <div class="group-input ">
                                            <label for="Corporate Quality Assurance Completed On">Corporate Quality
                                                Assurance Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="CorporateQualityAssurance_on"
                                                name="CorporateQualityAssurance_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->CorporateQualityAssurance_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 CQA new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Corporate Quality Assurance Completed On">Corporate Quality
                                                Assurance Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="CorporateQualityAssurance_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->CorporateQualityAssurance_on) }}" />
                                                <input readonly type="date" name="CorporateQualityAssurance_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'CorporateQualityAssurance_on')" />
                                            </div>
                                            @error('CorporateQualityAssurance_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('CorporateQualityAssurance_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('CorporateQualityAssurance_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance">Corporate Quality Assurance Action Required
                                                ?</label>
                                            <select name="CorporateQualityAssurance_Review" disabled
                                                id="CorporateQualityAssurance_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->CorporateQualityAssurance_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->CorporateQualityAssurance_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->CorporateQualityAssurance_Review == 'na' || empty($data1->CorporateQualityAssurance_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 58,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance notification">Corporate Quality
                                                Assurance Person <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="CorporateQualityAssurance_person" disabled
                                                id="CorporateQualityAssurance_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->CorporateQualityAssurance_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance notification">HOD Corporate Quality
                                                Assurance Person <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_CorporateQualityAssurance_person" disabled
                                                id="hod_CorporateQualityAssurance_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_CorporateQualityAssurance_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 CQA">
                                            <div class="group-input">
                                                <label for="Corporate Quality Assurance assessment">Description of action
                                                    item (By
                                                    Corporate
                                                    Quality Assurance)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="CorporateQualityAssurance_assessment" id="summernote-17">{{ $data1->CorporateQualityAssurance_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 CQA">
                                            <div class="group-input">
                                                <label for="Corporate Quality Assurance feedback">Corporate Quality
                                                    Assurance
                                                    Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="CorporateQualityAssurance_feedback" id="summernote-18">{{ $data1->CorporateQualityAssurance_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 CQA">
                                            <div class="group-input">
                                                <label for="Corporate Quality Assurance assessment">Description of action
                                                    item (By
                                                    Corporate
                                                    Quality Assurance)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="CorporateQualityAssurance_assessment" id="summernote-17">{{ $data1->CorporateQualityAssurance_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 CQA">
                                            <div class="group-input">
                                                <label for="Corporate Quality Assurance feedback">Corporate Quality
                                                    Assurance
                                                    Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="CorporateQualityAssurance_feedback" id="summernote-18">{{ $data1->CorporateQualityAssurance_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance attachment">Corporate Quality
                                                Assurance
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="CorporateQualityAssurance_attachment">
                                                    @if ($data1->CorporateQualityAssurance_attachment)
                                                        @foreach (json_decode($data1->CorporateQualityAssurance_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile" name="Microbiology_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Microbiology_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance Completed By">Corporate Quality
                                                Assurance Action Completed
                                                By</label>
                                            <input readonly type="text"
                                                value="{{ $data1->CorporateQualityAssurance_by }}"
                                                name="CorporateQualityAssurance_by" id="CorporateQualityAssurance_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 CQA new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Corporate Quality Assurance Completed On">Corporate Quality
                                                Assurance Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="CorporateQualityAssurance_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->CorporateQualityAssurance_on) }}" />
                                                <input readonly type="date" name="CorporateQualityAssurance_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'CorporateQualityAssurance_on')" />
                                            </div>
                                            @error('CorporateQualityAssurance_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif



                                <div class="sub-head">
                                    Stores
                                </div>
                                <script>
                                    $(document).ready(function() {

                                        @if ($data1->Store_Review !== 'yes')
                                            $('.store').hide();

                                            $('[name="Store_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.store').show();
                                                    $('.store span').show();
                                                } else {
                                                    $('.store').hide();
                                                    $('.store span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Store"> Store Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Store_Review" id="Store_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Store_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Store_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Store_Review == 'na' || empty($data1->Store_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 54,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store notification">Store Person <span id="asteriskPT"
                                                    style="display: {{ $data1->Store_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Store_person" class="Store_person" id="Store_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Store_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store notification">Store HOD Person <span id="asteriskPT"
                                                    style="display: {{ $data1->Store_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Store_person" class="hod_Store_person"
                                                id="hod_Store_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Store_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 store">
                                        <div class="group-input">
                                            <label for="Store assessment">Description of Action Item (By Store) <span
                                                    id="asteriskPT1"
                                                    style="display: {{ $data1->Store_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Store_Review == 'yes' && $data->stage == 4) required @endif class="summernote Store_assessment"
                                                @if ($data->stage == 3 || (isset($data1->Store_person) && Auth::user()->name != $data1->Store_person)) readonly @endif name="Store_assessment" id="summernote-17">{{ $data1->Store_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 store">
                                        <div class="group-input">
                                            <label for="store feedback">store Status of Action Item <span
                                                    id="asteriskPT2"
                                                    style="display: {{ $data1->Store_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Store_feedback" @if ($data->stage == 3 || (isset($data1->Store_person) && Auth::user()->name != $data1->Store_person)) readonly @endif
                                                name="Store_feedback" id="summernote-18" @if ($data1->Store_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Store_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 store">
                                        <div class="group-input">
                                            <label for="Store attachment">Store Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Store_attachment">
                                                    @if ($data1->Store_attachment)
                                                        @foreach (json_decode($data1->Store_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Store_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Store_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 store">
                                        <div class="group-input">
                                            <label for="Store Completed By">Store Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Store_by }}"
                                                name="Store_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Store_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 store">
                                        <div class="group-input ">
                                            <label for="Store Completed On">Store Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Store_on"
                                                name="Store_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->Store_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 store new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Store Completed On">Store Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Store_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Store_on) }}" />
                                                <input readonly type="date" name="Store_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input" oninput="handleDateInput(this, 'Store_on')" />
                                            </div>
                                            @error('Store_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Store_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Store_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Store">Store Action Required ?</label>
                                            <select name="Store_Review" disabled id="Store_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Store_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Store_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Store_Review == 'na' || empty($data1->Store_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 54,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store notification">Store Person <span id="asteriskInvi11"
                                                    style="display: none" class="text-danger">*</span></label>
                                            <select name="Store_person" disabled id="Store_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Store_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store notification">HOD Store Person <span id="asteriskInvi11"
                                                    style="display: none" class="text-danger">*</span></label>
                                            <select name="hod_Store_person" disabled id="hod_Store_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Store_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 store">
                                            <div class="group-input">
                                                <label for="Store assessment">Description of Action Item (By
                                                    Store)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Store_assessment" id="summernote-17">{{ $data1->Store_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 store">
                                            <div class="group-input">
                                                <label for="Store feedback">Store Feedback</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Store_feedback" id="summernote-18">{{ $data1->Store_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 store">
                                            <div class="group-input">
                                                <label for="Store assessment">Description of Action Item (By
                                                    Store)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Store_assessment" id="summernote-17">{{ $data1->Store_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 store">
                                            <div class="group-input">
                                                <label for="Store feedback">Store Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Store_feedback" id="summernote-18">{{ $data1->Store_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 store">
                                        <div class="group-input">
                                            <label for="Store attachment">Store Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Store_attachment">
                                                    @if ($data1->Store_attachment)
                                                        @foreach (json_decode($data1->Store_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile" name="Store_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Store_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 store">
                                        <div class="group-input">
                                            <label for="Store Completed By">Store Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Store_by }}"
                                                name="Store_by" id="Store_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store Completed On">Store Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input readonly type="date" id="Store_on" name="Store_on"
                                                value="{{ $data1->Store_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 store new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Store Completed On">Store Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Store_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Store_on) }}" />
                                                <input readonly type="date" name="Store_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input" oninput="handleDateInput(this, 'Store_on')" />
                                            </div>
                                            @error('Store_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif
                                <div class="sub-head">
                                    Engineering
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Engineering_review !== 'yes')
                                            $('.Engineering').hide();

                                            $('[name="Engineering_review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.Engineering').show();
                                                    $('.Engineering span').show();
                                                } else {
                                                    $('.Engineering').hide();
                                                    $('.Engineering span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Engineering"> Engineering Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Engineering_review" id="Engineering_review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Engineering_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Engineering_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Engineering_review == 'na' || empty($data1->Engineering_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 25,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering notification">Engineering Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Engineering_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Engineering_person" class="Engineering_person"
                                                id="Engineering_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Engineering_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering notification">Engineering HOD Person<span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Engineering_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Engineering_person" class="hod_Engineering_person"
                                                id="hod_Engineering_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Engineering_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering assessment">Description of Action Item (By
                                                Engineering) <span id="asteriskPT1"
                                                    style="display: {{ $data1->Engineering_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Engineering_review == 'yes' && $data->stage == 4) required @endif class="summernote Engineering_assessment"
                                                @if ($data->stage == 3 || (isset($data1->Engineering_person) && Auth::user()->name != $data1->Engineering_person)) readonly @endif name="Engineering_assessment" id="summernote-17">{{ $data1->Engineering_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering feedback">Engineering Status of Action Item <span
                                                    id="asteriskPT2"
                                                    style="display: {{ $data1->Engineering_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Engineering_feedback" @if ($data->stage == 3 || (isset($data1->Engineering_person) && Auth::user()->name != $data1->Engineering_person)) readonly @endif
                                                name="Engineering_feedback" id="summernote-18" @if ($data1->Engineering_review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Engineering_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering attachment">Engineering Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Engineering_attachment">
                                                    @if ($data1->Engineering_attachment)
                                                        @foreach (json_decode($data1->Engineering_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Engineering_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Engineering_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering Completed By">Engineering Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Engineering_by }}"
                                                name="Engineering_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Engineering_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 Engineering">
                                        <div class="group-input ">
                                            <label for="Engineering Completed On">Engineering Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Engineering_on"
                                                name="Engineering_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->Engineering_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 Engineering new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Store Completed On">Engineering Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Engineering_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Engineering_on) }}" />
                                                <input readonly type="date" name="Engineering_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Engineering_on')" />
                                            </div>
                                            @error('Engineering_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Engineering_review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Engineering_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Engineering">Engineering Action Required ?</label>
                                            <select name="Engineering_review" disabled id="Engineering_review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Engineering_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Engineering_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Engineering_review == 'na' || empty($data1->Engineering_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 25,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering notification">Engineering Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Engineering_person" disabled id="Engineering_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Engineering_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering notification">HOD Engineering Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_Engineering_person" disabled id="hod_Engineering_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Engineering_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 Engineering">
                                            <div class="group-input">
                                                <label for="Engineering assessment">Description of Action Item (By
                                                    Engineering)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Engineering_assessment" id="summernote-17">{{ $data1->Engineering_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Engineering">
                                            <div class="group-input">
                                                <label for="Engineering Status of Action Item">Engineering Status of
                                                    Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Engineering_feedback" id="summernote-18">{{ $data1->Engineering_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 Engineering">
                                            <div class="group-input">
                                                <label for="Engineering assessment">Description of Action Item (By
                                                    Engineering)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Engineering_assessment" id="summernote-17">{{ $data1->Engineering_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Engineering">
                                            <div class="group-input">
                                                <label for="Engineering Status of Action Item">Engineering Status of
                                                    Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Engineering_feedback" id="summernote-18">{{ $data1->Engineering_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering attachment">Engineering Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Engineering_attachment">
                                                    @if ($data1->Engineering_attachment)
                                                        @foreach (json_decode($data1->Engineering_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile" name="Engineering_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Engineering_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering Completed By">Engineering Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Engineering_by }}"
                                                name="Engineering_by" id="Engineering_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 Engineering new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Store Completed On">Engineering
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Engineering_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Engineering_on) }}" />
                                                <input readonly type="date" name="Engineering_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Engineering_on')" />
                                            </div>
                                            @error('Engineering_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif

                                <div class="sub-head">
                                    Regulatory Affair
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->RegulatoryAffair_Review !== 'yes')
                                            $('.RegulatoryAffair').hide();

                                            $('[name="RegulatoryAffair_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.RegulatoryAffair').show();
                                                    $('.RegulatoryAffair span').show();
                                                } else {
                                                    $('.RegulatoryAffair').hide();
                                                    $('.RegulatoryAffair span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="RegulatoryAffair"> Regulatory Affair Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="RegulatoryAffair_Review" id="RegulatoryAffair_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->RegulatoryAffair_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->RegulatoryAffair_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->RegulatoryAffair_Review == 'na' || empty($data1->RegulatoryAffair_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 57,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair notification">Regulatory Affair Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->RegulatoryAffair_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="RegulatoryAffair_person" class="RegulatoryAffair_person"
                                                id="RegulatoryAffair_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->RegulatoryAffair_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair notification">Regulatory Affair HOD Person<span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->RegulatoryAffair_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_RegulatoryAffair_person" class="hod_RegulatoryAffair_person"
                                                id="hod_RegulatoryAffair_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_RegulatoryAffair_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair assessment">Description of Action Item (By
                                                Regulatory
                                                Affair) <span id="asteriskPT1"
                                                    style="display: {{ $data1->RegulatoryAffair_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->RegulatoryAffair_Review == 'yes' && $data->stage == 4) required @endif class="summernote RegulatoryAffair_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->RegulatoryAffair_person) && Auth::user()->name != $data1->RegulatoryAffair_person)) readonly @endif name="RegulatoryAffair_assessment" id="summernote-17">{{ $data1->RegulatoryAffair_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair feedback">Regulatory Affair Status of Action
                                                Item <span id="asteriskPT2"
                                                    style="display: {{ $data1->RegulatoryAffair_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote RegulatoryAffair_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->RegulatoryAffair_person) && Auth::user()->name != $data1->RegulatoryAffair_person)) readonly @endif
                                                name="RegulatoryAffair_feedback" id="summernote-18" @if ($data1->RegulatoryAffair_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->RegulatoryAffair_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair attachment">Regulatory Affair
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="RegulatoryAffair_attachment">
                                                    @if ($data1->RegulatoryAffair_attachment)
                                                        @foreach (json_decode($data1->RegulatoryAffair_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="RegulatoryAffair_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'RegulatoryAffair_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair Completed By">Regulatory Affair Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->RegulatoryAffair_by }}"
                                                name="RegulatoryAffair_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="RegulatoryAffair_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input ">
                                            <label for="Regulatory Affair Completed On">Regulatory Affair Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="RegulatoryAffair_on"
                                                name="RegulatoryAffair_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->RegulatoryAffair_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 RegulatoryAffair new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Regulatory Affair Completed On">Regulatory Affair Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="RegulatoryAffair_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->RegulatoryAffair_on) }}" />
                                                <input readonly type="date" name="RegulatoryAffair_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'RegulatoryAffair_on')" />
                                            </div>
                                            @error('RegulatoryAffair_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('RegulatoryAffair_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('RegulatoryAffair_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Regulatory Affair">Regulatory Affair Action Required ?</label>
                                            <select name="RegulatoryAffair_Review" disabled
                                                id="RegulatoryAffair_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->RegulatoryAffair_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->RegulatoryAffair_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->RegulatoryAffair_Review == 'na' || empty($data1->RegulatoryAffair_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 57,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair notification">Regulatory Affair Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="RegulatoryAffair_person" disabled
                                                id="RegulatoryAffair_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->RegulatoryAffair_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair notification">HOD Regulatory Affair Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_RegulatoryAffair_person" disabled
                                                id="hod_RegulatoryAffair_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_RegulatoryAffair_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 RegulatoryAffair">
                                            <div class="group-input">
                                                <label for="Regulatory Affair assessment">Description of Action Item (By
                                                    Regulatory
                                                    Affair)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="RegulatoryAffair_assessment" id="summernote-17">{{ $data1->RegulatoryAffair_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 RegulatoryAffair">
                                            <div class="group-input">
                                                <label for="Regulatory Affair Status of Action Item">Regulatory Affair
                                                    Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="RegulatoryAffair_feedback" id="summernote-18">{{ $data1->RegulatoryAffair_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 RegulatoryAffair">
                                            <div class="group-input">
                                                <label for="Regulatory Affair assessment">Description of Action Item (By
                                                    Regulatory
                                                    Affair)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="RegulatoryAffair_assessment" id="summernote-17">{{ $data1->RegulatoryAffair_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 RegulatoryAffair">
                                            <div class="group-input">
                                                <label for="Regulatory Affair Status of Action Item">Regulatory Affair
                                                    Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="RegulatoryAffair_feedback" id="summernote-18">{{ $data1->RegulatoryAffair_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair attachment">Regulatory Affair
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="RegulatoryAffair_attachment">
                                                    @if ($data1->RegulatoryAffair_attachment)
                                                        @foreach (json_decode($data1->RegulatoryAffair_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="RegulatoryAffair_attachment[]"
                                                        oninput="addMultipleFiles(this, 'RegulatoryAffair_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair Completed By">Regulatory Affair Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->RegulatoryAffair_by }}"
                                                name="RegulatoryAffair_by" id="RegulatoryAffair_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 RegulatoryAffair new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Regulatory Affair Completed On">Regulatory Affair
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="RegulatoryAffair_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->RegulatoryAffair_on) }}" />
                                                <input readonly type="date" name="RegulatoryAffair_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'RegulatoryAffair_on')" />
                                            </div>
                                            @error('RegulatoryAffair_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif

                                <div class="sub-head">
                                    Quality Assurance
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Quality_Assurance_Review !== 'yes')

                                            $('.quality_assurance').hide();

                                            $('[name="Quality_Assurance_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.quality_assurance').show();
                                                    $('.quality_assurance span').show();
                                                } else {
                                                    $('.quality_assurance').hide();
                                                    $('.quality_assurance span').hide();
                                                }
                                            });
                                        @endif

                                    });
                                </script>
                               <div class="col-lg-6">
                                <div class="group-input">
                                    <label for="Quality Assurance Review Required">Quality Assurance Action Required ?
                                        @if ($data->stage == 3)
                                            <span class="text-danger">*</span>
                                        @endif
                                    </label>
                                    <select name="Quality_Assurance_Review" id="Quality_Assurance_Review"
                                        @if ($data->stage != 3) disabled @endif>
                                        <option value="">-- Select --</option>
                                        <option @if ($data1->Quality_Assurance_Review == 'yes') selected @endif value="yes">Yes</option>
                                        <option @if ($data1->Quality_Assurance_Review == 'no') selected @endif value="no">No</option>
                                        <option @if ($data1->Quality_Assurance_Review == 'na' || empty($data1->Quality_Assurance_Review)) selected @endif value='na'>NA</option>
                                    </select>
                                </div>
                            </div>

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_roles_id' => 26, 'q_m_s_divisions_id' => $data->division_id])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    //$users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp
                                <div class="col-lg-6 quality_assurance">
                                    <div class="group-input">
                                        <label for="Quality Assurance Person">Quality Assurance Person <span
                                                id="asteriskQQA"
                                                style="display: {{ $data1->Quality_Assurance_Review == 'yes' ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <select name="QualityAssurance_person" class="QualityAssurance_person"
                                            id="QualityAssurance_person"
                                            @if ($data->stage == 4) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach ($users as $user)
                                                <option
                                                    {{ $data1->QualityAssurance_person == $user->name ? 'selected' : '' }}
                                                    value="{{ $user->name }}">{{ $user->name }}</option>
                                            @endforeach
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6 quality_assurance">
                                    <div class="group-input">
                                        <label for="Quality Assurance Person">HOD Quality Assurance Person <span
                                                id="asteriskQQA"
                                                style="display: {{ $data1->Quality_Assurance_Review == 'yes' ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <select name="hod_QualityAssurance_person" class="hod_QualityAssurance_person"
                                            id="hod_QualityAssurance_person"
                                            @if ($data->stage == 4) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach ($users as $user)
                                                <option
                                                    {{ $data5->hod_QualityAssurance_person == $user->name ? 'selected' : '' }}
                                                    value="{{ $user->name }}">{{ $user->name }}</option>
                                            @endforeach
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12 mb-3 quality_assurance">
                                    <div class="group-input">
                                        <label for="Description of Action Item3">Description of Action Item (By Quality
                                            Assurance) <span id="asteriskQQA1"
                                                style="display: {{ $data1->Quality_Assurance_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it does
                                                not require completion</small></div>
                                        <textarea @if ($data1->Quality_Assurance_Review == 'yes' && $data->stage == 4) required @endif class="summernote QualityAssurance_assessment"
                                            name="QualityAssurance_assessment" @if ($data->stage == 3 || Auth::user()->name != $data1->QualityAssurance_person) readonly @endif id="summernote-23">{{ $data1->QualityAssurance_assessment }}</textarea>
                                    </div>
                                </div>
                                <div class="col-md-12 mb-3 quality_assurance">
                                    <div class="group-input">
                                        <label for="Quality Assurance Feedback">Quality Assurance Status of Action Item
                                            <span id="asteriskQQA2"
                                                style="display: {{ $data1->Quality_Assurance_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it does
                                                not require completion</small></div>
                                        <textarea @if ($data1->Quality_Assurance_Review == 'yes' && $data->stage == 4) required @endif class="summernote QualityAssurance_feedback"
                                            name="QualityAssurance_feedback" @if ($data->stage == 3 || Auth::user()->name != $data1->QualityAssurance_person) readonly @endif id="summernote-24">{{ $data1->QualityAssurance_feedback }}</textarea>
                                    </div>
                                </div>

                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('Quality_Assurance_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('QualityAssurance_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskQQA');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                                <div class="col-12 quality_assurance">
                                    <div class="group-input">
                                        <label for="Quality Assurance Attachments">Quality Assurance Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="Quality_Assurance_attachment">
                                                @if ($data1->Quality_Assurance_attachment)
                                                    @foreach (json_decode($data1->Quality_Assurance_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="Quality_Assurance_attachment[]"
                                                    oninput="addMultipleFiles(this, 'Quality_Assurance_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 quality_assurance">
                                    <div class="group-input">
                                        <label for="Quality Assurance Review Completed By">Quality Assurance Action
                                            Completed By</label>
                                        <input type="text" name="QualityAssurance_by" id="QualityAssurance_by"
                                            value="{{ $data1->QualityAssurance_by }}" disabled>
                                    </div>
                                </div>
                                <div class="col-6 mb-3 quality_assurance new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Quality Assurance Review Completed On">Quality Assurance Action
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="QualityAssurance_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data1->QualityAssurance_on) }}" />
                                            <input type="date" name="QualityAssurance_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-M-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'QualityAssurance_on')" />
                                        </div>
                                        @error('QualityAssurance_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>


                                <div class="sub-head">
                                    Production (Liquid/Ointment)
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->ProductionLiquid_Review !== 'yes')
                                            $('.productionLiquid').hide();

                                            $('[name="ProductionLiquid_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.productionLiquid').show();
                                                    $('.productionLiquid span').show();
                                                } else {
                                                    $('.productionLiquid').hide();
                                                    $('.productionLiquid span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Liquid"> Production Liquid/Ointment Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="ProductionLiquid_Review" id="ProductionLiquid_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->ProductionLiquid_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->ProductionLiquid_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->ProductionLiquid_Review == 'na' || empty($data1->ProductionLiquid_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 52,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid notification">Production Liquid/Ointment Person
                                                <span id="asteriskPT"
                                                    style="display: {{ $data1->ProductionLiquid_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="ProductionLiquid_person" class="ProductionLiquid_person"
                                                id="ProductionLiquid_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->ProductionLiquid_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid notification">Production Liquid / Ointment HOD Person <span id="asteriskPT"
                                                    style="display: {{ $data1->ProductionLiquid_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_ProductionLiquid_person" class="hod_ProductionLiquid_person"
                                                id="hod_ProductionLiquid_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_ProductionLiquid_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid assessment">Description of Action Item (By
                                                Production
                                                Liquid/Ointment) <span id="asteriskPT1"
                                                    style="display: {{ $data1->ProductionLiquid_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->ProductionLiquid_Review == 'yes' && $data->stage == 4) required @endif class="summernote ProductionLiquid_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->ProductionLiquid_person) && Auth::user()->name != $data1->ProductionLiquid_person)) readonly @endif name="ProductionLiquid_assessment" id="summernote-17">{{ $data1->ProductionLiquid_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid feedback">Production Liquid/Ointment Status of
                                                action
                                                item <span id="asteriskPT2"
                                                    style="display: {{ $data1->ProductionLiquid_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote ProductionLiquid_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->ProductionLiquid_person) && Auth::user()->name != $data1->ProductionLiquid_person)) readonly @endif
                                                name="ProductionLiquid_feedback" id="summernote-18" @if ($data1->ProductionLiquid_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->ProductionLiquid_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid attachment">Production Liquid/Ointment
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="ProductionLiquid_attachment">
                                                    @if ($data1->ProductionLiquid_attachment)
                                                        @foreach (json_decode($data1->ProductionLiquid_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="ProductionLiquid_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'ProductionLiquid_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid Completed By">Production Liquid/Ointment Action
                                                Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->ProductionLiquid_by }}"
                                                name="ProductionLiquid_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="ProductionLiquid_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 productionLiquid">
                                        <div class="group-input ">
                                            <label for="Production Liquid Completed On">Production Liquid Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="ProductionLiquid_on"
                                                name="ProductionLiquid_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->ProductionLiquid_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 productionLiquid new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Liquid Completed On">Production Liquid/Ointment Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="ProductionLiquid_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->ProductionLiquid_on) }}" />
                                                <input readonly type="date" name="ProductionLiquid_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'ProductionLiquid_on')" />
                                            </div>
                                            @error('ProductionLiquid_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('ProductionLiquid_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('ProductionLiquid_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Production Liquid">Production Liquid/Ointment Action Required ?</label>
                                            <select name="ProductionLiquid_Review" disabled
                                                id="ProductionLiquid_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->ProductionLiquid_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->ProductionLiquid_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->ProductionLiquid_Review == 'na' || empty($data1->ProductionLiquid_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 52,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid notification">Production Liquid/Ointment Person
                                                <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="ProductionLiquid_person" disabled
                                                id="ProductionLiquid_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->ProductionLiquid_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid notification">HOD Production Liquid/Ointment
                                                Person <span id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_ProductionLiquid_person" disabled
                                                id="hod_ProductionLiquid_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_ProductionLiquid_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 productionLiquid">
                                            <div class="group-input">
                                                <label for="Production Liquid assessment">Description of Action Item (By
                                                    Production
                                                    Liquid/Ointment)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="ProductionLiquid_assessment" id="summernote-17">{{ $data1->ProductionLiquid_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionLiquid">
                                            <div class="group-input">
                                                <label for="Production Liquid feedback">Production Liquid/Ointment Status
                                                    of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="ProductionLiquid_feedback" id="summernote-18">{{ $data1->ProductionLiquid_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 productionLiquid">
                                            <div class="group-input">
                                                <label for="Production Liquid assessment">Description of Action Item (By
                                                    Production
                                                    Liquid/Ointment)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="ProductionLiquid_assessment" id="summernote-17">{{ $data1->ProductionLiquid_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 productionLiquid">
                                            <div class="group-input">
                                                <label for="Production Liquid feedback">Production Liquid/Ointment Status
                                                    of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="ProductionLiquid_feedback" id="summernote-18">{{ $data1->ProductionLiquid_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid attachment">Production Liquid/Ointment
                                                Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="ProductionLiquid_attachment">
                                                    @if ($data1->ProductionLiquid_attachment)
                                                        @foreach (json_decode($data1->ProductionLiquid_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="ProductionLiquid_attachment[]"
                                                        oninput="addMultipleFiles(this, 'ProductionLiquid_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid Completed By">Production Liquid/Ointment Action
                                                Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->ProductionLiquid_by }}"
                                                name="ProductionLiquid_by" id="ProductionLiquid_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 productionLiquid new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Production Liquid Completed On">Production Liquid/Ointment Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="ProductionLiquid_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->ProductionLiquid_on) }}" />
                                                <input readonly type="date" name="ProductionLiquid_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'ProductionLiquid_on')" />
                                            </div>
                                            @error('ProductionLiquid_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif


                                <div class="sub-head">
                                    Quality Control
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Quality_review !== 'yes')
                                            $('.qualityControl').hide();

                                            $('[name="Quality_review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.qualityControl').show();
                                                    $('.qualityControl span').show();
                                                } else {
                                                    $('.qualityControl').hide();
                                                    $('.qualityControl span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Quality Control"> Quality Control Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Quality_review" id="Quality_review_Review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Quality_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Quality_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Quality_review == 'na' || empty($data1->Quality_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 24,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control notification">Quality Control Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Quality_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Quality_Control_Person" class="Quality_Control_Person"
                                                id="Quality_Control_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Quality_Control_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control notification">Quality Control HOD Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Quality_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Quality_Control_Person" class="hod_Quality_Control_Person"
                                                id="hod_Quality_Control_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Quality_Control_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control assessment">Description of Action Item (By Quality
                                                Control)
                                                <span id="asteriskPT1"
                                                    style="display: {{ $data1->Quality_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Quality_review == 'yes' && $data->stage == 4) required @endif class="summernote Quality_Control_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->Quality_Control_Person) && Auth::user()->name != $data1->Quality_Control_Person)) readonly @endif name="Quality_Control_assessment" id="summernote-17">{{ $data1->Quality_Control_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control feedback">Quality Control Status of Action Item
                                                <span id="asteriskPT2"
                                                    style="display: {{ $data1->Quality_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Quality_Control_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->Quality_Control_Person) && Auth::user()->name != $data1->Quality_Control_Person)) readonly @endif
                                                name="Quality_Control_feedback" id="summernote-18" @if ($data1->Quality_review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Quality_Control_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control attachment">Quality Control Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Quality_Control_attachment">
                                                    @if ($data1->Quality_Control_attachment)
                                                        @foreach (json_decode($data1->Quality_Control_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Quality_Control_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Quality_Control_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control Completed By">Quality Control Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Quality_Control_by }}"
                                                name="Quality_Control_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Quality_Control_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 qualityControl">
                                        <div class="group-input ">
                                            <label for="Quality Control Completed On">Quality Control Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Quality_Control_on"
                                                name="Quality_Control_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->Quality_Control_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 qualityControl new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Quality Control Completed On">Quality Control Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Quality_Control_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Quality_Control_on) }}" />
                                                <input readonly type="date" name="Quality_Control_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Quality_Control_on')" />
                                            </div>
                                            @error('Quality_Control_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>

                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Quality_review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Quality_Control_Person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Quality Control">Quality Control Action Required ?</label>
                                            <select name="Quality_review" disabled id="Quality_review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Quality_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Quality_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Quality_review == 'na' || empty($data1->Quality_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 24,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control notification">Quality Control Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Quality_Control_Person" disabled id="Quality_Control_Person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Quality_Control_Person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control notification">HOD Quality Control Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_ProductionLiquid_person" disabled
                                                id="hod_ProductionLiquid_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_ProductionLiquid_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 qualityControl">
                                            <div class="group-input">
                                                <label for="Quality Control assessment">Description of Action Item (By
                                                    Quality
                                                    Control)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Quality_Control_assessment" id="summernote-17">{{ $data1->Quality_Control_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 qualityControl">
                                            <div class="group-input">
                                                <label for="Quality Control feedback">Quality Control Status of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Quality_Control_feedback" id="summernote-18">{{ $data1->Quality_Control_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 qualityControl">
                                            <div class="group-input">
                                                <label for="Quality Control assessment">Description of Action Item (By
                                                    Quality
                                                    Control)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Quality_Control_assessment" id="summernote-17">{{ $data1->Quality_Control_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 qualityControl">
                                            <div class="group-input">
                                                <label for="Quality Control feedback">Quality Control Status of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Quality_Control_feedback" id="summernote-18">{{ $data1->Quality_Control_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control attachment">Quality Control Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Quality_Control_attachment">
                                                    @if ($data1->Quality_Control_attachment)
                                                        @foreach (json_decode($data1->Quality_Control_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile" name="Store_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Quality_Control_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control Completed By">Quality Control Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Quality_Control_by }}"
                                                name="Quality_Control_by" id="Quality_Control_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 qualityControl new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Quality Control Completed On">Quality Control
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Quality_Control_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Quality_Control_on) }}" />
                                                <input readonly type="date" name="Quality_Control_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Quality_Control_on')" />
                                            </div>
                                            @error('Quality_Control_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif

                                <div class="sub-head">
                                    Microbiology
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Microbiology_Review !== 'yes')
                                            $('.Microbiology').hide();

                                            $('[name="Microbiology_Review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.Microbiology').show();
                                                    $('.Microbiology span').show();
                                                } else {
                                                    $('.Microbiology').hide();
                                                    $('.Microbiology span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Microbiology"> Microbiology Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Microbiology_Review" id="Microbiology_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Microbiology_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Microbiology_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Microbiology_Review == 'na' || empty($data1->Microbiology_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 56,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology notification">Microbiology Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Microbiology_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Microbiology_person" class="Microbiology_person"
                                                id="Microbiology_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Microbiology_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology notification">Microbiology HOD Person <span
                                                    id="asteriskPT"
                                                    style="display: {{ $data1->Microbiology_Review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Microbiology_person" class="hod_Microbiology_person"
                                                id="hod_Microbiology_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Microbiology_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology assessment">Description of Action Item (By
                                                Microbiology) <span id="asteriskPT1"
                                                    style="display: {{ $data1->Microbiology_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Microbiology_Review == 'yes' && $data->stage == 4) required @endif class="summernote Microbiology_assessment"
                                                @if ($data->stage == 3 || (isset($data1->Microbiology_person) && Auth::user()->name != $data1->Microbiology_person)) readonly @endif name="Microbiology_assessment" id="summernote-17">{{ $data1->Microbiology_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology feedback">Microbiology Status of Action Item <span
                                                    id="asteriskPT2"
                                                    style="display: {{ $data1->Microbiology_Review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Microbiology_feedback" @if ($data->stage == 3 || (isset($data1->Microbiology_person) && Auth::user()->name != $data1->Microbiology_person)) readonly @endif
                                                name="Microbiology_feedback" id="summernote-18" @if ($data1->Microbiology_Review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Microbiology_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology attachment">Microbiology Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Microbiology_attachment">
                                                    @if ($data1->Microbiology_attachment)
                                                        @foreach (json_decode($data1->Microbiology_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Microbiology_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Microbiology_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology Completed By">Microbiology Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Microbiology_by }}"
                                                name="Microbiology_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Microbiology_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 Microbiology">
                                        <div class="group-input ">
                                            <label for="Microbiology Completed On">Microbiology Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Microbiology_on"
                                                name="Microbiology_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->Microbiology_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 Microbiology new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Microbiology Completed On">Microbiology Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Microbiology_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Microbiology_on) }}" />
                                                <input readonly type="date" name="Microbiology_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Microbiology_on')" />
                                            </div>
                                            @error('Microbiology_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Microbiology_Review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Microbiology_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Microbiology">Microbiology Action Required ?</label>
                                            <select name="Microbiology_Review" disabled id="Microbiology_Review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Microbiology_Review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Microbiology_Review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Microbiology_Review == 'na' || empty($data1->Microbiology_Review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 56,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology notification">Microbiology Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Microbiology_person" disabled id="Microbiology_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Microbiology_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology notification">HOD Microbiology Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="hod_Microbiology_person" disabled
                                                id="hod_Microbiology_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Microbiology_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 Microbiology">
                                            <div class="group-input">
                                                <label for="Microbiology assessment">Description of Action Item (By
                                                    Microbiology)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Microbiology_assessment" id="summernote-17">{{ $data1->Microbiology_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Microbiology">
                                            <div class="group-input">
                                                <label for="Microbiology feedback">Microbiology Status of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Microbiology_feedback" id="summernote-18">{{ $data1->Microbiology_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 Microbiology">
                                            <div class="group-input">
                                                <label for="Microbiology assessment">Description of Action Item (By
                                                    Microbiology)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Microbiology_assessment" id="summernote-17">{{ $data1->Microbiology_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 Microbiology">
                                            <div class="group-input">
                                                <label for="Microbiology feedback">Microbiology Status of action
                                                    item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Microbiology_feedback" id="summernote-18">{{ $data1->Microbiology_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology attachment">Microbiology Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Microbiology_attachment">
                                                    @if ($data1->Microbiology_attachment)
                                                        @foreach (json_decode($data1->Microbiology_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile" name="Microbiology_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Microbiology_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology Completed By">Microbiology Action Completed
                                                By</label>
                                            <input readonly type="text" value="{{ $data1->Microbiology_by }}"
                                                name="Microbiology_by" id="Microbiology_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 Microbiology new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Microbiology Completed On">Microbiology Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Microbiology_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Microbiology_on) }}" />
                                                <input readonly type="date" name="Microbiology_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Microbiology_on')" />
                                            </div>
                                            @error('Microbiology_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif



                                <div class="sub-head">
                                    Safety
                                </div>
                                <script>
                                    $(document).ready(function() {
                                        @if ($data1->Environment_Health_review !== 'yes')
                                            $('.safety').hide();

                                            $('[name="Environment_Health_review"]').change(function() {
                                                if ($(this).val() === 'yes') {

                                                    $('.safety').show();
                                                    $('.safety span').show();
                                                } else {
                                                    $('.safety').hide();
                                                    $('.safety span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                                @php
                                    $data1 = DB::table('management_cfts')
                                        ->where('ManagementReview_id', $data->id)
                                        ->first();
                                @endphp

                                @if ($data->stage == 3 || $data->stage == 4)
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Safety"> Safety Action Required ? <span
                                                    class="text-danger">*</span></label>
                                            <select name="Environment_Health_review" id="Environment_Health_review"
                                                @if ($data->stage == 4) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Environment_Health_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Environment_Health_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Environment_Health_review == 'na' || empty($data1->Environment_Health_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 59,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 safety">
                                        <div class="group-input">
                                            <label for="Safety notification">Safety Person <span id="asteriskPT"
                                                    style="display: {{ $data1->Environment_Health_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="Environment_Health_Safety_person"
                                                class="Environment_Health_Safety_person"
                                                id="Environment_Health_Safety_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data1->Environment_Health_Safety_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 safety">
                                        <div class="group-input">
                                            <label for="Safety notification">Safety HOD Person <span id="asteriskPT"
                                                    style="display: {{ $data1->Environment_Health_review == 'yes' ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span>
                                            </label>
                                            <select @if ($data->stage == 4) disabled @endif
                                                name="hod_Environment_Health_Safety_person"
                                                class="hod_Environment_Health_Safety_person"
                                                id="hod_Environment_Health_Safety_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Environment_Health_Safety_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety assessment">Description of Action Item (By Safety) <span
                                                    id="asteriskPT1"
                                                    style="display: {{ $data1->Environment_Health_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea @if ($data1->Environment_Health_review == 'yes' && $data->stage == 4) required @endif class="summernote Health_Safety_assessment"
                                                @if (
                                                    $data->stage == 3 ||
                                                        (isset($data1->Environment_Health_Safety_person) &&
                                                            Auth::user()->name != $data1->Environment_Health_Safety_person)) readonly @endif name="Health_Safety_assessment" id="summernote-17">{{ $data1->Health_Safety_assessment }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-md-12 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety feedback">Safety Status of Action Item <span
                                                    id="asteriskPT2"
                                                    style="display: {{ $data1->Environment_Health_review == 'yes' && $data->stage == 4 ? 'inline' : 'none' }}"
                                                    class="text-danger">*</span></label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if it
                                                    does not require completion</small></div>
                                            <textarea class="summernote Health_Safety_feedback" @if (
                                                $data->stage == 3 ||
                                                    (isset($data1->Environment_Health_Safety_person) &&
                                                        Auth::user()->name != $data1->Environment_Health_Safety_person)) readonly @endif
                                                name="Health_Safety_feedback" id="summernote-18" @if ($data1->Environment_Health_review == 'yes' && $data->stage == 4) required @endif>{{ $data1->Health_Safety_feedback }}</textarea>
                                        </div>
                                    </div>
                                    <div class="col-12 safety">
                                        <div class="group-input">
                                            <label for="Safety attachment">Safety Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Environment_Health_Safety_attachment">
                                                    @if ($data1->Environment_Health_Safety_attachment)
                                                        @foreach (json_decode($data1->Environment_Health_Safety_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Environment_Health_Safety_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                        oninput="addMultipleFiles(this, 'Environment_Health_Safety_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety Completed By">Safety Action Completed
                                                By</label>
                                            <input readonly type="text"
                                                value="{{ $data1->Environment_Health_Safety_by }}"
                                                name="Environment_Health_Safety_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                                id="Environment_Health_Safety_by">


                                        </div>
                                    </div>
                                    {{-- <div class="col-lg-6 safety">
                                        <div class="group-input ">
                                            <label for="Safety Completed On">Safety Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Environment_Health_Safety_on"
                                                name="Environment_Health_Safety_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data1->Environment_Health_Safety_on }}">
                                        </div>
                                    </div> --}}
                                    <div class="col-lg-6 safety new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Safety Completed On">Safety Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Environment_Health_Safety_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Environment_Health_Safety_on) }}" />
                                                <input readonly type="date" name="Environment_Health_Safety_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Environment_Health_Safety_on')" />
                                            </div>
                                            @error('Environment_Health_Safety_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                    <script>
                                        document.addEventListener('DOMContentLoaded', function() {
                                            var selectField = document.getElementById('Environment_Health_review');
                                            var inputsToToggle = [];

                                            // Add elements with class 'facility-name' to inputsToToggle
                                            var facilityNameInputs = document.getElementsByClassName('Environment_Health_Safety_person');
                                            for (var i = 0; i < facilityNameInputs.length; i++) {
                                                inputsToToggle.push(facilityNameInputs[i]);
                                            }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }
                                            // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                            // for (var i = 0; i < facilityNameInputs.length; i++) {
                                            //     inputsToToggle.push(facilityNameInputs[i]);
                                            // }

                                            selectField.addEventListener('change', function() {
                                                var isRequired = this.value === 'yes';
                                                console.log(this.value, isRequired, 'value');

                                                inputsToToggle.forEach(function(input) {
                                                    input.required = isRequired;
                                                    console.log(input.required, isRequired, 'input req');
                                                });

                                                // Show or hide the asterisk icon based on the selected value
                                                var asteriskIcon = document.getElementById('asteriskPT');
                                                asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            });
                                        });
                                    </script>
                                @else
                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Safety">Safety Action Required ?</label>
                                            <select name="Environment_Health_review" disabled
                                                id="Environment_Health_review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data1->Environment_Health_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data1->Environment_Health_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                    <option @if ($data1->Environment_Health_review == 'na' || empty($data1->Environment_Health_review)) selected @endif value='na'>NA</option>
                                            </select>

                                        </div>
                                    </div>
                                    @php
                                        $userRoles = DB::table('user_roles')
                                            ->where([
                                                'q_m_s_roles_id' => 59,
                                                'q_m_s_divisions_id' => $data->division_id,
                                            ])
                                            ->get();
                                        $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                        $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                    @endphp
                                    <div class="col-lg-6 safety">
                                        <div class="group-input">
                                            <label for="Safety notification">Safety Person <span id="asteriskInvi11"
                                                    style="display: none" class="text-danger">*</span></label>
                                            <select name="Environment_Health_Safety_person" disabled
                                                id="Environment_Health_Safety_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->Environment_Health_Safety_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 safety">
                                        <div class="group-input">
                                            <label for="Safety notification">HOD Safety Person <span id="asteriskInvi11"
                                                    style="display: none" class="text-danger">*</span></label>
                                            <select name="hod_Environment_Health_Safety_person" disabled
                                                id="hod_Environment_Health_Safety_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->hod_Environment_Health_Safety_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div>
                                    @if ($data->stage == 4)
                                        <div class="col-md-12 mb-3 safety">
                                            <div class="group-input">
                                                <label for="Safety assessment">Description of Action Item (By
                                                    Safety)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Health_Safety_assessment" id="summernote-17">{{ $data1->Health_Safety_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 safety">
                                            <div class="group-input">
                                                <label for="Safety feedback">Safety Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Health_Safety_feedback" id="summernote-18">{{ $data1->Health_Safety_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @else
                                        <div class="col-md-12 mb-3 safety">
                                            <div class="group-input">
                                                <label for="Safety assessment">Description of Action Item (By
                                                    Safety)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Health_Safety_assessment" id="summernote-17">{{ $data1->Health_Safety_assessment }}</textarea>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb-3 safety">
                                            <div class="group-input">
                                                <label for="Safety feedback">Safety Status of Action Item</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea disabled class="tiny" name="Health_Safety_feedback" id="summernote-18">{{ $data1->Health_Safety_feedback }}</textarea>
                                            </div>
                                        </div>
                                    @endif
                                    <div class="col-12 safety">
                                        <div class="group-input">
                                            <label for="Safety attachment">Safety Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting
                                                    documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list"
                                                    id="Environment_Health_Safety_attachment">
                                                    @if ($data1->Environment_Health_Safety_attachment)
                                                        @foreach (json_decode($data1->Environment_Health_Safety_attachment) as $file)
                                                            <h6 type="button" class="file-container text-dark"
                                                                style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}"
                                                                    target="_blank"><i class="fa fa-eye text-primary"
                                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                                <a type="button" class="remove-file"
                                                                    data-file-name="{{ $file }}"><i
                                                                        class="fa-solid fa-circle-xmark"
                                                                        style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input disabled
                                                        {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                        type="file" id="myfile"
                                                        name="Environment_Health_Safety_attachment[]"
                                                        oninput="addMultipleFiles(this, 'Environment_Health_Safety_attachment')"
                                                        multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety Completed By">Safety Action Completed
                                                By</label>
                                            <input readonly type="text"
                                                value="{{ $data1->Environment_Health_Safety_by }}"
                                                name="Environment_Health_Safety_by" id="Environment_Health_Safety_by">


                                        </div>
                                    </div>
                                    <div class="col-lg-6 safety new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Safety Completed On">Safety Action
                                                Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Environment_Health_Safety_on" readonly
                                                    placeholder="DD-MMM-YYYY"
                                                    value="{{ Helpers::getdateFormat($data1->Environment_Health_Safety_on) }}" />
                                                <input readonly type="date" name="Environment_Health_Safety_on"
                                                    min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                    class="hide-input"
                                                    oninput="handleDateInput(this, 'Environment_Health_Safety_on')" />
                                            </div>
                                            @error('Environment_Health_Safety_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>
                                @endif




                                <div class="sub-head">
                                    Other's 1 (Additional Person Action From Departments If Required)
                                </div>

                                <script>
                                    $(document).ready(function () {
                                        // Function to toggle visibility based on "yes" value
                                        function toggleOther1Fields(value) {
                                            if (value === 'yes') {
                                                $('.other1_reviews').show();
                                                $('.other1_reviews span').show();
                                                $('#Other1_person').prop('required', true);
                                                $('#hod_Other1_person').prop('required', true);
                                                $('#Other1_Department_person').prop('required', true);
                                                $('#asterisko1').show();
                                            } else {
                                                $('.other1_reviews').hide();
                                                $('.other1_reviews span').hide();
                                                $('#Other1_person').prop('required', false);
                                                $('#hod_Other1_person').prop('required', false);
                                                $('#Other1_Department_person').prop('required', false);
                                                $('#asterisko1').hide();
                                            }
                                        }

                                        // Initial toggle on page load
                                        toggleOther1Fields($('[name="Other1_review"]').val());

                                        // Toggle on value change
                                        $('[name="Other1_review"]').change(function () {
                                            toggleOther1Fields($(this).val());
                                        });
                                    });
                                </script>

                                <div class="col-lg-6">
                                    <div class="group-input">
                                        <label for="Review Required1">Other's 1 Action Required?</label>
                                        <select name="Other1_review" id="Other1_review"  @if ($data->stage != 3) disabled @endif>
                                            <option value="">-- Select --</option>
                                            <option value="yes" @if ($data1->Other1_review == 'yes') selected @endif>Yes</option>
                                            <option value="no" @if ($data1->Other1_review == 'no') selected @endif>No</option>
                                            <option value="na" @if ($data1->Other1_review == 'na') selected @endif>NA</option>
                                        </select>
                                    </div>
                                </div>

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                <div class="col-lg-6 other1_reviews">
                                    <div class="group-input">
                                        <label for="Person1">Other's 1 Person <span id="asterisko1" class="text-danger">*</span></label>
                                        <select name="Other1_person" id="Other1_person" @if ($data->stage == 4) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach ($users as $user)
                                                <option value="{{ $user->name }}" @if ($data1->Other1_person == $user->name) selected @endif>{{ $user->name }}</option>
                                            @endforeach
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-6 other1_reviews">
                                    <div class="group-input">
                                        <label for="hod_Other1_person">Other's 1 HOD Person <span id="asterisko1" class="text-danger">*</span></label>
                                        <select name="hod_Other1_person" id="hod_Other1_person" @if ($data->stage == 4) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach ($users as $user)
                                                <option value="{{ $user->name }}" @if ($data5->hod_Other1_person == $user->name) selected @endif>{{ $user->name }}</option>
                                            @endforeach
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-12 other1_reviews">
                                    <div class="group-input">
                                        <label for="Department1">Other's 1 Department <span id="asterisko1" class="text-danger">*</span></label>
                                        <select name="Other1_Department_person" id="Other1_Department_person" @if ($data->stage != 3) disabled @endif>
                                            <option value="">-- Select --</option>
                                            @foreach (Helpers::getDepartments() as $key => $name)
                                                <option value="{{ $key }}" @if ($data1->Other1_Department_person == $key) selected @endif>{{ $name }}</option>
                                            @endforeach
                                        </select>
                                        @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="Other1_Department_person" value="{{ $data1->Other1_Department_person }}">
                                        @endif
                                        @error('Other1_Department_person')
                                            <p class="text-danger">{{ $message }}</p>
                                        @enderror
                                    </div>
                                </div>

                                <div class="col-md-12 mb-3 other1_reviews">
                                    <div class="group-input">
                                        <label for="Description of Action Item12">Description of Action Item (By Other's 1)</label>
                                        <textarea class="tiny" name="Other1_assessment" id="summernote-41"
                                            @if ($data->stage != 4 || Auth::user()->name != $data1->Other1_person) readonly @endif>{{ $data1->Other1_assessment }}</textarea>
                                    </div>
                                </div>

                                <div class="col-md-12 mb-3 other1_reviews">
                                    <div class="group-input">
                                        <label for="Feedback1">Other's 1 Status of Action Item</label>
                                        <textarea class="tiny" name="Other1_feedback" id="summernote-42"
                                            @if ($data->stage != 4 || Auth::user()->name != $data1->Other1_person) readonly @endif>{{ $data1->Other1_feedback }}</textarea>
                                    </div>
                                </div>

                                <div class="col-12 other1_reviews">
                                    <div class="group-input">
                                        <label for="Audit Attachments">Other's 1 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="Other1_attachment">
                                                @if ($data1->Other1_attachment)
                                                    @foreach (json_decode($data1->Other1_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark" style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}" target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px;"></i></a>
                                                            <a type="button" class="remove-file" data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }} type="file" id="myfile"
                                                    name="Other1_attachment[]" oninput="addMultipleFiles(this, 'Other1_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6 mb-3 other1_reviews">
                                    <div class="group-input">
                                        <label for="Review Completed By1">Other's 1 Action Completed By</label>
                                        <input type="text" name="Other1_by" id="Other1_by" value="{{ $data1->Other1_by }}" disabled>
                                    </div>
                                </div>

                                <div class="col-6 other1_reviews new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Others 1 Completed On">Others 1 Action Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="Other1_on" readonly placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data1->Other1_on) }}" />
                                            <input readonly type="date" name="Other1_on" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                                class="hide-input" oninput="handleDateInput(this, 'Other1_on')" />
                                        </div>
                                        @error('Other1_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>


                                <!-- Other's 2 Section -->
                                    <div class="sub-head">
                                        Other's 2 (Additional Person Action From Departments If Required)
                                    </div>

                                    <script>
                                        $(document).ready(function () {
                                            // Function to toggle visibility based on "yes" value
                                            function toggleOther2Fields(value) {
                                                if (value === 'yes') {
                                                    $('.Other2_reviews').show();
                                                    $('.Other2_reviews span').show();
                                                    $('#Other2_person').prop('required', true);
                                                    $('#hod_Other2_person').prop('required', true);
                                                    $('#Other2_Department_person').prop('required', true);
                                                    $('#asterisko2').show();
                                                } else {
                                                    $('.Other2_reviews').hide();
                                                    $('.Other2_reviews span').hide();
                                                    $('#Other2_person').prop('required', false);
                                                    $('#hod_Other2_person').prop('required', false);
                                                    $('#Other2_Department_person').prop('required', false);
                                                    $('#asterisko2').hide();
                                                }
                                            }

                                            // Initial toggle on page load
                                            toggleOther2Fields($('[name="Other2_review"]').val());

                                            // Toggle on value change
                                            $('[name="Other2_review"]').change(function () {
                                                toggleOther2Fields($(this).val());
                                            });
                                        });
                                    </script>

                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="review2">Other's 2 Action Required?</label>
                                            <select name="Other2_review" id="Other2_review" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option value="yes" @if ($data1->Other2_review == 'yes') selected @endif>Yes</option>
                                                <option value="no" @if ($data1->Other2_review == 'no') selected @endif>No</option>
                                                <option value="na" @if ($data1->Other2_review == 'na') selected @endif>NA</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Person2">Other's 2 Person <span id="asterisko2" class="text-danger">*</span></label>
                                            <select name="Other2_person" id="Other2_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data1->Other2_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="Other2_person" value="{{ $data1->Other2_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other2_reviews">
                                        <div class="group-input">
                                            <label for="hod_Other2_person">Other's 2 HOD Person <span id="asterisko2" class="text-danger">*</span></label>
                                            <select name="hod_Other2_person" id="hod_Other2_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data5->hod_Other2_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="hod_Other2_person" value="{{ $data5->hod_Other2_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-12 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Department2">Other's 2 Department <span id="asteriskod2" class="text-danger">*</span></label>
                                            <select name="Other2_Department_person" id="Other2_Department_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach (Helpers::getDepartments() as $key => $name)
                                                    <option value="{{ $key }}" @if ($data1->Other2_Department_person == $key) selected @endif>{{ $name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                                <!-- Hidden field to retain the value if select is disabled -->
                                                <input type="hidden" name="Other2_Department_person" value="{{ $data1->Other2_Department_person }}">
                                            @endif
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Description of Action Item13">Description of Action Item (By Other's 2)</label>
                                            <textarea class="tiny" name="Other2_Assessment" id="summernote-43"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other2_person) readonly @endif>{{ $data1->Other2_Assessment }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Feedback2">Other's 2 Status of Action Item</label>
                                            <textarea class="tiny" name="Other2_feedback" id="summernote-44"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other2_person) readonly @endif>{{ $data1->Other2_feedback }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Audit Attachments">Other's 2 Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Other2_attachment">
                                                    @if ($data1->Other2_attachment)
                                                        @foreach (json_decode($data1->Other2_attachment) as $file)
                                                            <h6 class="file-container text-dark" style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}" target="_blank"><i class="fa fa-eye text-primary" style="font-size:20px;"></i></a>
                                                                <a type="button" class="remove-file" data-file-name="{{ $file }}"><i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }} type="file" id="myfile" name="Other2_attachment[]" oninput="addMultipleFiles(this, 'Other2_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-3 Other2_reviews">
                                        <div class="group-input">
                                            <label for="Review Completed By2">Other's 2 Action Completed By</label>
                                            <input type="text" name="Other2_by" id="Other2_by" value="{{ $data1->Other2_by }}" disabled>
                                        </div>
                                    </div>

                                    <div class="col-6 Other2_reviews new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Others 2 Completed On">Others 2 Action Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Other2_on" readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data1->Other2_on) }}" />
                                                <input readonly type="date" name="Other2_on" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" class="hide-input" oninput="handleDateInput(this, 'Other2_on')" />
                                            </div>
                                            @error('Other2_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>

                                    <!-- Other's 3 Section -->

                                    <div class="sub-head">
                                        Other's 3 (Additional Person Action From Departments If Required)
                                    </div>

                                    <script>
                                        $(document).ready(function () {
                                            // Function to toggle visibility based on "yes" value
                                            function toggleOther3Fields(value) {
                                                if (value === 'yes') {
                                                    $('.Other3_reviews').show();
                                                    $('.Other3_reviews span').show();
                                                    $('#Other3_person').prop('required', true);
                                                    $('#hod_Other3_person').prop('required', true);
                                                    $('#Other3_Department_person').prop('required', true);
                                                    $('#asterisko3').show();
                                                } else {
                                                    $('.Other3_reviews').hide();
                                                    $('.Other3_reviews span').hide();
                                                    $('#Other3_person').prop('required', false);
                                                    $('#hod_Other3_person').prop('required', false);
                                                    $('#Other3_Department_person').prop('required', false);
                                                    $('#asterisko3').hide();
                                                }
                                            }

                                            // Initial toggle on page load
                                            toggleOther3Fields($('[name="Other3_review"]').val());

                                            // Toggle on value change
                                            $('[name="Other3_review"]').change(function () {
                                                toggleOther3Fields($(this).val());
                                            });
                                        });
                                    </script>

                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="review3">Other's 3 Action Required?</label>
                                            <select name="Other3_review" id="Other3_review" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option value="yes" @if ($data1->Other3_review == 'yes') selected @endif>Yes</option>
                                                <option value="no" @if ($data1->Other3_review == 'no') selected @endif>No</option>
                                                <option value="na" @if ($data1->Other3_review == 'na') selected @endif>NA</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other3_reviews">
                                        <div class="group-input">
                                            <label for="Person3">Other's 3 Person <span id="asterisko3" class="text-danger">*</span></label>
                                            <select name="Other3_person" id="Other3_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data1->Other3_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="Other3_person" value="{{ $data1->Other3_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other3_reviews">
                                        <div class="group-input">
                                            <label for="hod_Other3_person">Other's 3 HOD Person <span id="asterisko3" class="text-danger">*</span></label>
                                            <select name="hod_Other3_person" id="hod_Other3_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data5->hod_Other3_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="hod_Other3_person" value="{{ $data5->hod_Other3_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-12 Other3_reviews">
                                        <div class="group-input">
                                            <label for="Department3">Other's 3 Department <span id="asteriskod3" class="text-danger">*</span></label>
                                            <select name="Other3_Department_person" id="Other3_Department_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach (Helpers::getDepartments() as $key => $name)
                                                    <option value="{{ $key }}" @if ($data1->Other3_Department_person == $key) selected @endif>{{ $name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                                <!-- Hidden field to retain the value if select is disabled -->
                                                <input type="hidden" name="Other3_Department_person" value="{{ $data1->Other3_Department_person }}">
                                            @endif
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other3_reviews">
                                        <div class="group-input">
                                            <label for="Description of Action Item14">Description of Action Item (By Other's 3)</label>
                                            <textarea class="tiny" name="Other3_Assessment" id="summernote-45"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other3_person) readonly @endif>{{ $data1->Other3_Assessment }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other3_reviews">
                                        <div class="group-input">
                                            <label for="feedback3">Other's 3 Status of Action Item</label>
                                            <textarea class="tiny" name="Other3_feedback" id="summernote-46"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other3_person) readonly @endif>{{ $data1->Other3_feedback }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 Other3_reviews">
                                        <div class="group-input">
                                            <label for="Audit Attachments">Other's 3 Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Other3_attachment">
                                                    @if ($data1->Other3_attachment)
                                                        @foreach (json_decode($data1->Other3_attachment) as $file)
                                                            <h6 class="file-container text-dark" style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}" target="_blank"><i class="fa fa-eye text-primary" style="font-size:20px;"></i></a>
                                                                <a type="button" class="remove-file" data-file-name="{{ $file }}"><i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }} type="file" id="myfile" name="Other3_attachment[]" oninput="addMultipleFiles(this, 'Other3_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-3 Other3_reviews">
                                        <div class="group-input">
                                            <label for="productionfeedback">Other's 3 Action Completed By</label>
                                            <input type="text" name="Other3_by" id="Other3_by" value="{{ $data1->Other3_by }}" disabled>
                                        </div>
                                    </div>

                                    <div class="col-6 Other3_reviews new-date-data-field">
                                        <div class="group-input input-date">
                                            <label for="Others 3 Completed On">Others 3 Action Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Other3_on" readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data1->Other3_on) }}" />
                                                <input readonly type="date" name="Other3_on" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" class="hide-input" oninput="handleDateInput(this, 'Other3_on')" />
                                            </div>
                                            @error('Other3_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>


                                    <!-- Other's 4 Section -->
                                    <div class="sub-head">
                                        Other's 4 (Additional Person Action From Departments If Required)
                                    </div>

                                    <script>
                                        $(document).ready(function () {
                                            // Function to toggle visibility based on "yes" value
                                            function toggleOther4Fields(value) {
                                                if (value === 'yes') {
                                                    $('.Other4_reviews').show();
                                                    $('.Other4_reviews span').show();
                                                    $('#Other4_person').prop('required', true);
                                                    $('#hod_Other4_person').prop('required', true);
                                                    $('#Other4_Department_person').prop('required', true);
                                                    $('#asterisko4').show();
                                                } else {
                                                    $('.Other4_reviews').hide();
                                                    $('.Other4_reviews span').hide();
                                                    $('#Other4_person').prop('required', false);
                                                    $('#hod_Other4_person').prop('required', false);
                                                    $('#Other4_Department_person').prop('required', false);
                                                    $('#asterisko4').hide();
                                                }
                                            }

                                            // Initial toggle on page load
                                            toggleOther4Fields($('[name="Other4_review"]').val());

                                            // Toggle on value change
                                            $('[name="Other4_review"]').change(function () {
                                                toggleOther4Fields($(this).val());
                                            });
                                        });
                                    </script>

                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="review4">Other's 4 Action Required?</label>
                                            <select name="Other4_review" id="Other4_review" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option value="yes" @if ($data1->Other4_review == 'yes') selected @endif>Yes</option>
                                                <option value="no" @if ($data1->Other4_review == 'no') selected @endif>No</option>
                                                <option value="na" @if ($data1->Other4_review == 'na') selected @endif>NA</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other4_reviews">
                                        <div class="group-input">
                                            <label for="Person4">Other's 4 Person <span id="asterisko4" class="text-danger">*</span></label>
                                            <select name="Other4_person" id="Other4_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data1->Other4_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="Other4_person" value="{{ $data1->Other4_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other4_reviews">
                                        <div class="group-input">
                                            <label for="hod_Other4_person"> Other's 4 HOD Person <span id="asterisko4" class="text-danger">*</span></label>
                                            <select name="hod_Other4_person" id="hod_Other4_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data5->hod_Other4_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="hod_Other4_person" value="{{ $data5->hod_Other4_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-12 Other4_reviews">
                                        <div class="group-input">
                                            <label for="Department4">Other's 4 Department <span id="asteriskod4" class="text-danger">*</span></label>
                                            <select name="Other4_Department_person" id="Other4_Department_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach (Helpers::getDepartments() as $key => $name)
                                                    <option value="{{ $key }}" @if ($data1->Other4_Department_person == $key) selected @endif>{{ $name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                                <!-- Hidden field to retain the value if select is disabled -->
                                                <input type="hidden" name="Other4_Department_person" value="{{ $data1->Other4_Department_person }}">
                                            @endif
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other4_reviews">
                                        <div class="group-input">
                                            <label for="Description of Action Item15">Description of Action Item (By Other's 4)</label>
                                            <textarea class="tiny" name="Other4_Assessment" id="summernote-47"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other4_person) readonly @endif>{{ $data1->Other4_Assessment }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other4_reviews">
                                        <div class="group-input">
                                            <label for="feedback4">Other's 4 Status of Action Item</label>
                                            <textarea class="tiny" name="Other4_feedback" id="summernote-48"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other4_person) readonly @endif>{{ $data1->Other4_feedback }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 Other4_reviews">
                                        <div class="group-input">
                                            <label for="Audit Attachments">Other's 4 Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Other4_attachment">
                                                    @if ($data1->Other4_attachment)
                                                        @foreach (json_decode($data1->Other4_attachment) as $file)
                                                            <h6 class="file-container text-dark" style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}" target="_blank"><i class="fa fa-eye text-primary" style="font-size:20px;"></i></a>
                                                                <a type="button" class="remove-file" data-file-name="{{ $file }}"><i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }} type="file" id="myfile" name="Other4_attachment[]" oninput="addMultipleFiles(this, 'Other4_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-3 Other4_reviews">
                                        <div class="group-input">
                                            <label for="Review Completed By4">Other's 4 Action Completed By</label>
                                            <input type="text" name="Other4_by" id="Other4_by" value="{{ $data1->Other4_by }}" disabled>
                                        </div>
                                    </div>

                                    <div class="col-6 new-date-data-field Other4_reviews">
                                        <div class="group-input input-date">
                                            <label for="Others 4 Completed On">Others 4 Action Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Other4_on" readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data1->Other4_on) }}" />
                                                <input readonly type="date" name="Other4_on" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" class="hide-input" oninput="handleDateInput(this, 'Other4_on')" />
                                            </div>
                                            @error('Other4_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>

                                    <!-- Other's 5 Section -->

                                    <div class="sub-head">
                                        Other's 5 (Additional Person Action From Departments If Required)
                                    </div>

                                    <script>
                                        $(document).ready(function () {
                                            // Function to toggle visibility based on "yes" value
                                            function toggleOther5Fields(value) {
                                                if (value === 'yes') {
                                                    $('.Other5_reviews').show();
                                                    $('.Other5_reviews span').show();
                                                    $('#Other5_person').prop('required', true);
                                                    $('#hod_Other5_person').prop('required', true);
                                                    $('#Other5_Department_person').prop('required', true);
                                                    $('#asterisko5').show();
                                                } else {
                                                    $('.Other5_reviews').hide();
                                                    $('.Other5_reviews span').hide();
                                                    $('#Other5_person').prop('required', false);
                                                    $('#hod_Other5_person').prop('required', false);
                                                    $('#Other5_Department_person').prop('required', false);
                                                    $('#asterisko5').hide();
                                                }
                                            }

                                            // Initial toggle on page load
                                            toggleOther5Fields($('[name="Other5_review"]').val());

                                            // Toggle on value change
                                            $('[name="Other5_review"]').change(function () {
                                                toggleOther5Fields($(this).val());
                                            });
                                        });
                                    </script>

                                    <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="review5">Other's 5 Action Required?</label>
                                            <select name="Other5_review" id="Other5_review" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                <option value="yes" @if ($data1->Other5_review == 'yes') selected @endif>Yes</option>
                                                <option value="no" @if ($data1->Other5_review == 'no') selected @endif>No</option>
                                                <option value="na" @if ($data1->Other5_review == 'na') selected @endif>NA</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Person5">Other's 5 Person <span id="asterisko5" class="text-danger">*</span></label>
                                            <select name="Other5_person" id="Other5_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data1->Other5_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="Other5_person" value="{{ $data1->Other5_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-6 Other5_reviews">
                                        <div class="group-input">
                                            <label for="hod_Other5_person">Other's 5 HOD Person <span id="asterisko5" class="text-danger">*</span></label>
                                            <select name="hod_Other5_person" id="hod_Other5_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}" @if ($data5->hod_Other5_person == $user->name) selected @endif>{{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                            <!-- Hidden field to retain the value if select is disabled -->
                                            <input type="hidden" name="hod_Other5_person" value="{{ $data5->hod_Other5_person }}">
                                        @endif
                                        </div>
                                    </div>

                                    <div class="col-lg-12 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Department5">Other's 5 Department <span id="asteriskod5" class="text-danger">*</span></label>
                                            <select name="Other5_Department_person" id="Other5_Department_person" @if ($data->stage != 3) disabled @endif>
                                                <option value="">-- Select --</option>
                                                @foreach (Helpers::getDepartments() as $key => $name)
                                                    <option value="{{ $key }}" @if ($data1->Other5_Department_person == $key) selected @endif>{{ $name }}</option>
                                                @endforeach
                                            </select>
                                            @if ($data->stage != 3)
                                                <!-- Hidden field to retain the value if select is disabled -->
                                                <input type="hidden" name="Other5_Department_person" value="{{ $data1->Other5_Department_person }}">
                                            @endif
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Description of Action Item16">Description of Action Item (By Other's 5)</label>
                                            <textarea class="tiny" name="Other5_Assessment" id="summernote-49"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other5_person) readonly @endif>{{ $data1->Other5_Assessment }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-md-12 mb-3 Other5_reviews">
                                        <div class="group-input">
                                            <label for="productionfeedback">Other's 5 Status of Action Item</label>
                                            <textarea class="tiny" name="Other5_feedback" id="summernote-50"
                                                @if ($data->stage != 4 || Auth::user()->name != $data1->Other5_person) readonly @endif>{{ $data1->Other5_feedback }}</textarea>
                                        </div>
                                    </div>

                                    <div class="col-12 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Audit Attachments">Other's 5 Attachments</label>
                                            <div><small class="text-primary">Please Attach all relevant or supporting documents</small></div>
                                            <div class="file-attachment-field">
                                                <div disabled class="file-attachment-list" id="Other5_attachment">
                                                    @if ($data1->Other5_attachment)
                                                        @foreach (json_decode($data1->Other5_attachment) as $file)
                                                            <h6 class="file-container text-dark" style="background-color: rgb(243, 242, 240);">
                                                                <b>{{ $file }}</b>
                                                                <a href="{{ asset('upload/' . $file) }}" target="_blank"><i class="fa fa-eye text-primary" style="font-size:20px;"></i></a>
                                                                <a type="button" class="remove-file" data-file-name="{{ $file }}"><i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i></a>
                                                            </h6>
                                                        @endforeach
                                                    @endif
                                                </div>
                                                <div class="add-btn">
                                                    <div>Add</div>
                                                    <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }} type="file" id="myfile" name="Other5_attachment[]" oninput="addMultipleFiles(this, 'Other5_attachment')" multiple>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-3 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Review Completed By5">Other's 5 Action Completed By</label>
                                            <input type="text" name="Other5_by" id="Other5_by" value="{{ $data1->Other5_by }}" disabled>
                                        </div>
                                    </div>

                                    <div class="col-6 new-date-data-field Other5_reviews">
                                        <div class="group-input input-date">
                                            <label for="Others 5 Completed On">Others 5 Action Completed On</label>
                                            <div class="calenderauditee">
                                                <input type="text" id="Other5_on" readonly placeholder="DD-MMM-YYYY" value="{{ Helpers::getdateFormat($data1->Other5_on) }}" />
                                                <input readonly type="date" name="Other5_on" min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" class="hide-input" oninput="handleDateInput(this, 'Other5_on')" />
                                            </div>
                                            @error('Other5_on')
                                                <div class="text-danger">{{ $message }}</div>
                                            @enderror
                                        </div>
                                    </div>

                                <!-- HTML Section -->








                            </div>
                            <div class="button-block">
                                <button style=" justify-content: center; width: 4rem; margin-left: 1px;;"
                                    type="submit"{{ $data->stage == 0 || $data->stage == 7 || $data->stage == 12 ? 'disabled' : '' }}
                                    id="ChangesaveButton" class="saveButton saveAuditFormBtn d-flex"
                                    style="align-items: center;">
                                    <div class="spinner-border spinner-border-sm auditFormSpinner" style="display: none"
                                        role="status">
                                        <span class="sr-only">Loading...</span>
                                    </div>
                                    Save
                                </button>
                                <button type="button" class="backButton" onclick="previousStep()">Back</button>
                                <button style=" justify-content: center; width: 4rem; margin-left: 1px;;"
                                    type="button"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }}
                                    id="ChangeNextButton" class="nextButton">Next</button>
                                <button style=" justify-content: center; width: 4rem; margin-left: 1px;;"
                                    type="button"> <a href="{{ url('rcms/qms-dashboard') }}" class="text-white">
                                        Exit </a> </button>
                                @if (
                                    $data->stage == 2 ||
                                        $data->stage == 3 ||
                                        $data->stage == 4 ||
                                        $data->stage == 5 ||
                                        $data->stage == 6 ||
                                        $data->stage == 7)
                                    {{-- <a style="  justify-content: center; width: 10rem; margin-left: 1px;;" type="button"
                                            class="button  launch_extension" data-bs-toggle="modal"
                                            data-bs-target="#launch_extension">
                                            Launch Extension
                                        </a> --}}
                                @endif
                                <!-- <a type="button" class="button  launch_extension" data-bs-toggle="modal"
                                                                                                                                                                                                                                                                                                                                                                                                data-bs-target="#effectivenss_extension">
                                                                                                                                                                                                                                                                                                                                                                                                Launch Effectiveness Check
                                                                                                                                                                                                                                                                                                                                                                                            </a> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div id="CCForm7" class="inner-block cctabcontent">
                    <div class="inner-block-content">
                        <div class="row">
                            <div class="sub-head">
                                Production (Tablet/Capsule/Powder)
                            </div>
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 68,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 productionTable">
                                    <div class="group-input">
                                        <label for="Production Tablet feedback">Production Tablet/Capsule/Powder HOD Person <span id="asteriskPT2"
                                                style="display: {{ $data1->Production_Table_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Production_Table_Feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Production_Table_Person) && Auth::user()->name != $data5->hod_Production_Table_Person)) readonly @endif
                                            name="hod_Production_Table_Feedback" id="summernote-18" @if ($data1->Production_Table_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Production_Table_Feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 productionTable">
                                    <div class="group-input">
                                        <label for="Production Tablet attachment">HOD Production Tablet/Capsule/Powder
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Production_Table_Attachment">
                                                @if ($data5->hod_Production_Table_Attachment)
                                                    @foreach (json_decode($data5->hod_Production_Table_Attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Production_Table_Attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Production_Table_Attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6 mb-3 productionTable">
                                    <div class="group-input">
                                        <label for="Production Tablet Completed By">HOD Production Tablet/Capsule Powder Review Completed By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Production_Table_By }}"
                                            name="hod_Production_Table_By"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Production_Table_By">


                                    </div>
                                </div>
                                <div class="col-6 mb-3 productionTable new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Tablet Completed On">HOD Production Tablet/Capsule Powder Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Production_Table_On" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Production_Table_On) }}" />
                                            <input readonly type="date" name="hod_Production_Table_On"
                                                min="{{ \Carbon\Carbon::now()->format('d-M-Y') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Production_Table_On')" />
                                        </div>
                                        @error('hod_Production_Table_On')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>




                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('Production_Table_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Production_Table_Person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Table_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Table_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 68,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp
                                @if ($data->stage == 5)
                                @else
                                    <div class="col-md-12 mb-3 productionTable">
                                        <div class="group-input">
                                            <label for="Production Tablet feedback">HOD Production Tablet/Capsule Powder Review
                                                Comments
                                                <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                            </label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Production_Table_Feedback" id="summernote-18">{{ $data5->hod_Production_Table_Feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 productionTable">
                                    <div class="group-input">
                                        <label for="Production Tablet attachment">Production Tablet/Capsule Powder
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Production_Table_Attachment">
                                                @if ($data5->hod_Production_Table_Attachment)
                                                    @foreach (json_decode($data5->hod_Production_Table_Attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Production_Table_Attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Production_Table_Attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 productionTable">
                                    <div class="group-input">
                                        <label for="Production Tablet Completed By">Production Tablet/Capsule Powder Review
                                            Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Production_Table_By }}"
                                            name="hod_Production_Table_By" id="hod_Production_Table_By">


                                    </div>
                                </div>
                                <div class="col-6 mb-3 productionTable new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Tablet Completed On">Production Tablet/Capsule Powder Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Production_Table_On" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Production_Table_On) }}" />
                                            <input readonly type="date" name="hod_Production_Table_On"
                                                min="{{ \Carbon\Carbon::now()->format('d-M-Y') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Production_Table_On')" />
                                        </div>
                                        @error('hod_Production_Table_On')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif

                            <div class="sub-head">
                                Production Injection
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Production_Injection_Review !== 'yes')
                                        $('.productionInjection').hide();

                                        $('[name="hod_Production_Injection_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.productionInjection').show();
                                                $('.productionInjection span').show();
                                            } else {
                                                $('.productionInjection').hide();
                                                $('.productionInjection span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 70,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 productionInjection">
                                    <div class="group-input">
                                        <label for="Production Injection Status of Action Item">HOD Production Injection Review
                                            Comments <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_Production_Injection_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote Production_Injection_Feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Production_Injection_Person) &&
                                                    Auth::user()->name != $data5->hod_Production_Injection_Person)) readonly @endif
                                            name="hod_Production_Injection_Feedback" id="summernote-18"
                                            @if ($data5->hod_Production_Injection_Review == 'yes' && $data->stage == 5) disable @endif>{{ $data5->hod_Production_Injection_Feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 productionInjection">
                                    <div class="group-input">
                                        <label for="Production Injection attachment">HOD Production Injection
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Production_Injection_Attachment">
                                                @if ($data5->hod_Production_Injection_Attachment)
                                                    @foreach (json_decode($data5->hod_Production_Injection_Attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Production_Injection_Attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Production_Injection_Attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 productionInjection">
                                    <div class="group-input">
                                        <label for="Production Injection Completed By">HOD Production Injection Review Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_Production_Injection_By }}"
                                            name="hod_Production_Injection_By"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Production_Injection_By">


                                    </div>
                                </div>
                                <div class="col-6 productionInjection new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Injection Completed On"> HOD Production Injection Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Production_Injection_On" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Production_Injection_On) }}" />
                                            <input readonly type="date" name="hod_Production_Injection_On"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Production_Injection_On')" />
                                        </div>
                                        @error('hod_Production_Injection_On')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>




                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('Production_Injection_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('Production_Injection_Person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 70,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection Status of Action Item">HOD Production
                                                Injection Review Comment
                                                <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                            </label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Production_Injection_Feedback" id="summernote-18">{{ $data5->hod_Production_Injection_Feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 productionInjection">
                                        <div class="group-input">
                                            <label for="Production Injection Status of Action Item">HOD Production
                                                Injection Review Comments
                                                <!-- <span
                                                                                                                                                                                                                                                                                                                                                                                                                                                        id="asteriskInvi22" style="display: none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="text-danger">*</span> -->
                                            </label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Production_Injection_Feedback" id="summernote-18">{{ $data5->hod_Production_Injection_Feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 productionInjection">
                                    <div class="group-input">
                                        <label for="Production Injection attachment">HOD Production Injection
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Production_Injection_Attachment">
                                                @if ($data5->hod_Production_Injection_Attachment)
                                                    @foreach (json_decode($data5->hod_Production_Injection_Attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Production_Injection_Attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Production_Injection_Attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 productionInjection">
                                    <div class="group-input">
                                        <label for="Production Injection Completed By">HOD Production Injection Review Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_Production_Injection_By }}"
                                            name="hod_Production_Injection_By" id="hod_Production_Injection_By">


                                    </div>
                                </div>
                                <div class="col-6 productionInjection new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Injection Completed On">HOD Production Injection Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Production_Injection_On" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Production_Injection_On) }}" />
                                            <input readonly type="date" name="hod_Production_Injection_On"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Production_Injection_On')" />
                                        </div>
                                        @error('hod_Production_Injection_On')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif


                            <div class="sub-head">
                                Research & Development
                            </div>
                            <!-- <script>
                                $(document).ready(function() {

                                    @if ($data5->hod_ResearchDevelopment_Review !== 'yes')
                                        $('.researchDevelopment').hide();

                                        $('[name="hod_ResearchDevelopment_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.researchDevelopment').show();
                                                $('.researchDevelopment span').show();
                                            } else {
                                                $('.researchDevelopment').hide();
                                                $('.researchDevelopment span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 72,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp



                                <div class="col-md-12 mb-3 researchDevelopment">
                                    <div class="group-input">
                                        <label for="Research Development Status of Action Item">Research & Development HOD Person
                                            Comments <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_ResearchDevelopment_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote ResearchDevelopment_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_ResearchDevelopment_person) && Auth::user()->name != $data5->hod_ResearchDevelopment_person)) readonly @endif
                                            name="hod_ResearchDevelopment_feedback" id="summernote-18"
                                            @if ($data5->hod_ResearchDevelopment_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_ResearchDevelopment_feedback }}</textarea>
                                    </div>
                                </div>

                                <div class="col-12 researchDevelopment">
                                    <div class="group-input">
                                        <label for="Research Development attachment">HOD Research & Development
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_ResearchDevelopment_attachment">
                                                @if ($data5->hod_ResearchDevelopment_attachment)
                                                    @foreach (json_decode($data5->hod_ResearchDevelopment_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_ResearchDevelopment_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_ResearchDevelopment_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 researchDevelopment">
                                    <div class="group-input">
                                        <label for="Research Development Completed By">HOD Research & Development Review
                                            Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_ResearchDevelopment_by }}"
                                            name="hod_ResearchDevelopment_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_ResearchDevelopment_by">


                                    </div>
                                </div>

                                <div class="col-6 researchDevelopment new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Research Development Completed On">HOD Research & Development Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_ResearchDevelopment_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_ResearchDevelopment_on) }}" />
                                            <input readonly type="date" name="hod_ResearchDevelopment_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_ResearchDevelopment_on')" />
                                        </div>
                                        @error('hod_ResearchDevelopment_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('ResearchDevelopment_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('ResearchDevelopment_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 72,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development Status of Action Item"> HOD Research &
                                                Development Review
                                                Feedback</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_ResearchDevelopment_feedback" id="summernote-18">{{ $data5->hod_ResearchDevelopment_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 researchDevelopment">
                                        <div class="group-input">
                                            <label for="Research Development Status of Action Item">HOD Research &
                                                Development
                                                Feedback</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_ResearchDevelopment_feedback" id="summernote-18">{{ $data5->hod_ResearchDevelopment_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 researchDevelopment">
                                    <div class="group-input">
                                        <label for="Research Development attachment"> HOD Research Development
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_ResearchDevelopment_attachment">
                                                @if ($data5->hod_ResearchDevelopment_attachment)
                                                    @foreach (json_decode($data5->hod_ResearchDevelopment_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_ResearchDevelopment_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_ResearchDevelopment_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 researchDevelopment">
                                    <div class="group-input">
                                        <label for="Research Development Completed By">HOD Research Development Review Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_ResearchDevelopment_by }}"
                                            name="hod_ResearchDevelopment_by" id="Storhod_ResearchDevelopment_by">


                                    </div>
                                </div>
                                <div class="col-6 researchDevelopment new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Research Development Completed On">HOD Research Development Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_ResearchDevelopment_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_ResearchDevelopment_on) }}" />
                                            <input readonly type="date" name="hod_ResearchDevelopment_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_ResearchDevelopment_on')" />
                                        </div>
                                        @error('hod_ResearchDevelopment_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif



                            <div class="sub-head">
                                Human Resource
                            </div>
                            <!-- <script>
                                $(document).ready(function() {

                                    @if ($data5->hod_Human_Resource_review !== 'yes')
                                        $('.Human_Resource').hide();

                                        $('[name="hod_Human_Resource_review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.Human_Resource').show();
                                                $('.Human_Resource span').show();
                                            } else {
                                                $('.Human_Resource').hide();
                                                $('.Human_Resource span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 77,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 Human_Resource">
                                    <div class="group-input">
                                        <label for="Human Resource Status of Action Item">HOD Human Resource Review Comments
                                            <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_Human_Resource_review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Human_Resource_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Human_Resource_person) && Auth::user()->name != $data5->hod_Human_Resource_person)) readonly @endif
                                            name="hod_Human_Resource_feedback" id="summernote-18" @if ($data5->hod_Human_Resource_review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Human_Resource_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Human_Resource">
                                    <div class="group-input">
                                        <label for="Human Resource attachment">HOD Human Resource Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Human_Resource_attachment">
                                                @if ($data5->hod_Human_Resource_attachment)
                                                    @foreach (json_decode($data5->hod_Human_Resource_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Human_Resource_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Human_Resource_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Human_Resource">
                                    <div class="group-input">
                                        <label for="Human Resource Completed By">HOD Human Resource Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Human_Resource_by }}"
                                            name="hod_Human_Resource_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Human_Resource_by">


                                    </div>
                                </div>

                                <div class="col-lg-6 Human_Resource new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Human Resource Completed On">HOD Human Resource Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Human_Resource_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Human_Resource_on) }}" />
                                            <input readonly type="date" name="hod_Human_Resource_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Human_Resource_on')" />
                                        </div>
                                        @error('hod_Human_Resource_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Human_Resource_review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Human_Resource_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                {{-- <div class="col-lg-6">
                                        <div class="group-input">
                                            <label for="Human Resource">Human Resource Required ?</label>
                                            <select name="Human_Resource_review" disabled id="Human_Resource_review">
                                                <option value="">-- Select --</option>
                                                <option @if ($data5->Human_Resource_review == 'yes') selected @endif
                                                    value='yes'>
                                                    Yes</option>
                                                <option @if ($data5->Human_Resource_review == 'no') selected @endif
                                                    value='no'>
                                                    No</option>
                                                <option @if ($data5->Human_Resource_review == 'na') selected @endif
                                                    value='na'>
                                                    NA</option>
                                            </select>

                                        </div>
                                    </div> --}}
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 77,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp
                                {{-- <div class="col-lg-6 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource notification">Human Resource Person <span
                                                    id="asteriskInvi11" style="display: none"
                                                    class="text-danger">*</span></label>
                                            <select name="Human_Resource_person" disabled id="Human_Resource_person">
                                                <option value="">-- Select --</option>
                                                @foreach ($users as $user)
                                                    <option value="{{ $user->name }}"
                                                        @if ($user->name == $data5->Human_Resource_person) selected @endif>
                                                        {{ $user->name }}</option>
                                                @endforeach
                                            </select>
                                        </div>
                                    </div> --}}
                                @if ($data->stage == 5)
                                    {{-- <div class="col-md-12 mb-3 Human_Resource">
                                            <div class="group-input">
                                                <label for="Human Resource assessment">Description of Action Item (By Human
                                                    Resource)</label>
                                                <div><small class="text-primary">Please insert "NA" in the data field if
                                                        it
                                                        does not require completion</small></div>
                                                <textarea class="tiny" name="Human_Resource_assessment" id="summernote-17">{{ $data5->Human_Resource_assessment }}</textarea>
                                            </div>
                                        </div> --}}
                                    <div class="col-md-12 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource Status of Action Item">HOD Human Resource Review
                                                Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Human_Resource_feedback" id="summernote-18">{{ $data5->hod_Human_Resource_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 Human_Resource">
                                        <div class="group-input">
                                            <label for="Human Resource Status of Action Item">HOD Human Resource Review
                                                Comment</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Human_Resource_feedback" id="summernote-18">{{ $data5->hod_Human_Resource_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 Human_Resource">
                                    <div class="group-input">
                                        <label for="Human Resource attachment">HOD Human Resource Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Human_Resource_attachment">
                                                @if ($data5->hod_Human_Resource_attachment)
                                                    @foreach (json_decode($data5->hod_Human_Resource_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Human_Resource_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Human_Resource_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Human_Resource">
                                    <div class="group-input">
                                        <label for="Human Resource Completed By">HOD Human Resource Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Human_Resource_by }}"
                                            name="hod_Human_Resource_by" id="hod_Human_Resource_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 Human_Resource new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Human Resource Completed On">HOD Human Resource Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Human_Resource_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Human_Resource_on) }}" />
                                            <input readonly type="date" name="hod_Human_Resource_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Human_Resource_on')" />
                                        </div>
                                        @error('hod_Human_Resource_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif





                            <div class="sub-head">
                                Corporate Quality Assurance
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_CorporateQualityAssurance_Review !== 'yes')
                                        $('.CQA').hide();

                                        $('[name="hod_CorporateQualityAssurance_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.CQA').show();
                                                $('.CQA span').show();
                                            } else {
                                                $('.CQA').hide();
                                                $('.CQA span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 74,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 CQA">
                                    <div class="group-input">
                                        <label for="Corporate Quality Assurance feedback">HOD Corporate Quality Assurance Review
                                            Comments <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_CorporateQualityAssurance_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_CorporateQualityAssurance_feedback"
                                            @if (
                                                $data->stage == 3 ||
                                                    (isset($data5->hod_CorporateQualityAssurance_person) &&
                                                        Auth::user()->name != $data5->hod_CorporateQualityAssurance_person)) readonly @endif name="hod_CorporateQualityAssurance_feedback"
                                            id="summernote-18" @if ($data5->hod_CorporateQualityAssurance_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_CorporateQualityAssurance_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 CQA">
                                    <div class="group-input">
                                        <label for="Corporate Quality Assurance attachment">HOD Corporate Quality
                                            Assurance
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_CorporateQualityAssurance_attachment">
                                                @if ($data5->hod_CorporateQualityAssurance_attachment)
                                                    @foreach (json_decode($data5->hod_CorporateQualityAssurance_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_CorporateQualityAssurance_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_CorporateQualityAssurance_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {{-- @php
                                dd( $data5->hod_CorporateQualityAssurance_by);
                            @endphp --}}
                                <div class="col-md-6 mb-3 CQA">
                                    <div class="group-input">
                                        <label for="Corporate Quality Assurance Completed By">HOD Corporate Quality Assurance Review Completed By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_CorporateQualityAssurance_by }}"
                                            name="hod_CorporateQualityAssurance_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_CorporateQualityAssurance_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 CQA">
                                        <div class="group-input ">
                                            <label for="Corporate Quality Assurance Completed On">Corporate Quality
                                                Assurance Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="CorporateQualityAssurance_on"
                                                name="CorporateQualityAssurance_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->CorporateQualityAssurance_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 CQA new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Corporate Quality Assurance Completed On">HOD Corporate Quality
                                            Assurance Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_CorporateQualityAssurance_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_CorporateQualityAssurance_on) }}" />
                                            <input readonly type="date" name="hod_CorporateQualityAssurance_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_CorporateQualityAssurance_on')" />
                                        </div>
                                        @error('hod_CorporateQualityAssurance_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_CorporateQualityAssurance_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_CorporateQualityAssurance_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 74,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance feedback">HOD Corporate Quality Review
                                                Assurance
                                                Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_CorporateQualityAssurance_feedback" id="summernote-18">{{ $data5->hod_CorporateQualityAssurance_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 CQA">
                                        <div class="group-input">
                                            <label for="Corporate Quality Assurance feedback">HOD Corporate Quality
                                                Assurance Review
                                                Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_CorporateQualityAssurance_feedback" id="summernote-18">{{ $data5->hod_CorporateQualityAssurance_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 CQA">
                                    <div class="group-input">
                                        <label for="Corporate Quality Assurance attachment">HOD Corporate Quality
                                            Assurance
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_CorporateQualityAssurance_attachment">
                                                @if ($data5->hod_CorporateQualityAssurance_attachment)
                                                    @foreach (json_decode($data5->hod_CorporateQualityAssurance_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_CorporateQualityAssurance_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_CorporateQualityAssurance_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6 mb-3 CQA">
                                    <div class="group-input">
                                        <label for="Corporate Quality Assurance Completed By">HOD Corporate Quality Assurance Review Completed By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_CorporateQualityAssurance_by }}"
                                            name="hod_CorporateQualityAssurance_by"
                                            id="hod_CorporateQualityAssurance_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 CQA new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Corporate Quality Assurance Completed On">HOD Corporate Quality
                                            Assurance Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_CorporateQualityAssurance_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_CorporateQualityAssurance_on) }}" />
                                            <input readonly type="date" name="hod_CorporateQualityAssurance_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_CorporateQualityAssurance_on')" />
                                        </div>
                                        @error('hod_CorporateQualityAssurance_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif



                            <div class="sub-head">
                                Stores
                            </div>
                            <!-- <script>
                                $(document).ready(function() {

                                    @if ($data5->hod_Store_Review !== 'yes')
                                        $('.store').hide();

                                        $('[name="hod_Store_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.store').show();
                                                $('.store span').show();
                                            } else {
                                                $('.store').hide();
                                                $('.store span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 71,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 store">
                                    <div class="group-input">
                                        <label for="store feedback">HOD Store Review Comments <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_Store_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Store_feedback" @if ($data->stage == 3 || (isset($data5->hod_Store_person) && Auth::user()->name != $data5->hod_Store_person)) readonly @endif
                                            name="hod_Store_feedback" id="summernote-18" @if ($data5->hod_Store_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Store_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 store">
                                    <div class="group-input">
                                        <label for="Store attachment">HOD Store Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Store_attachment">
                                                @if ($data5->hod_Store_attachment)
                                                    @foreach (json_decode($data5->hod_Store_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Store_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Store_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 store">
                                    <div class="group-input">
                                        <label for="Store Completed By">HOD Store Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Store_by }}"
                                            name="hod_Store_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Store_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 store">
                                        <div class="group-input ">
                                            <label for="Store Completed On">Store Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Store_on"
                                                name="Store_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->Store_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 store new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Store Completed On">HOD Store Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Store_on" readonly placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Store_on) }}" />
                                            <input readonly type="date" name="hod_Store_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Store_on')" />
                                        </div>
                                        @error('hod_Store_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Store_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Store_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 71,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 store">
                                        <div class="group-input">
                                            <label for="Store feedback"> HOD Store Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Store_feedback" id="summernote-18">{{ $data5->hod_Store_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 store">
                                        <div class="group-input">
                                            <label for="Store feedback">HOD Store Review Comment</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Store_feedback" id="summernote-18">{{ $data5->hod_Store_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 store">
                                    <div class="group-input">
                                        <label for="Store attachment">HOD Store Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Store_attachment">
                                                @if ($data5->hod_Store_attachment)
                                                    @foreach (json_decode($data5->hod_Store_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Store_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Store_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 store">
                                    <div class="group-input">
                                        <label for="Store Completed By">HOD Store Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Store_by }}"
                                            name="hod_Store_by" id="hod_Store_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 store">
                                        <div class="group-input">
                                            <label for="Store Completed On">Store Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input readonly type="date" id="Store_on" name="Store_on"
                                                value="{{ $data5->Store_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 store new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Store Completed On">HOD Store Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Store_on" readonly placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Store_on) }}" />
                                            <input readonly type="date" name="hod_Store_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Store_on')" />
                                        </div>
                                        @error('hod_Store_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif
                            <div class="sub-head">
                                Engineering
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Engineering_review !== 'yes')
                                        $('.Engineering').hide();

                                        $('[name="hod_Engineering_review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.Engineering').show();
                                                $('.Engineering span').show();
                                            } else {
                                                $('.Engineering').hide();
                                                $('.Engineering span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 78,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 Engineering">
                                    <div class="group-input">
                                        <label for="Engineering feedback">HOD Engineering Review Comments <span
                                                id="asteriskPT2"
                                                style="display: {{ $data5->hod_Engineering_review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Engineering_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Engineering_person) && Auth::user()->name != $data5->hod_Engineering_person)) readonly @endif
                                            name="hod_Engineering_feedback" id="summernote-18" @if ($data5->hod_Engineering_review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Engineering_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Engineering">
                                    <div class="group-input">
                                        <label for="Engineering attachment">HOD Engineering Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Engineering_attachment">
                                                @if ($data5->hod_Engineering_attachment)
                                                    @foreach (json_decode($data5->hod_Engineering_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Engineering_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Engineering_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Engineering">
                                    <div class="group-input">
                                        <label for="Engineering Completed By">HOD Engineering Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Engineering_by }}"
                                            name="hod_Engineering_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Engineering_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 Engineering">
                                        <div class="group-input ">
                                            <label for="Engineering Completed On">Engineering Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Engineering_on"
                                                name="Engineering_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->Engineering_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 Engineering new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Store Completed On">HOD Engineering Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Engineering_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Engineering_on) }}" />
                                            <input readonly type="date" name="hod_Engineering_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Engineering_on')" />
                                        </div>
                                        @error('hod_Engineering_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Engineering_review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Engineering_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 78,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering feedback">HOD Engineering Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Engineering_feedback" id="summernote-18">{{ $data5->hod_Engineering_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 Engineering">
                                        <div class="group-input">
                                            <label for="Engineering feedback">HOD Engineering Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Engineering_feedback" id="summernote-18">{{ $data5->hod_Engineering_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 Engineering">
                                    <div class="group-input">
                                        <label for="Engineering attachment">HOD Engineering Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Engineering_attachment">
                                                @if ($data5->hod_Engineering_attachment)
                                                    @foreach (json_decode($data5->hod_Engineering_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Engineering_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Engineering_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Engineering">
                                    <div class="group-input">
                                        <label for="Engineering Completed By">HOD Engineering Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Engineering_by }}"
                                            name="hod_Engineering_by" id="hod_Engineering_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 Engineering new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Store Completed On">HOD Engineering Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Engineering_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Engineering_on) }}" />
                                            <input readonly type="date" name="hod_Engineering_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Engineering_on')" />
                                        </div>
                                        @error('hod_Engineering_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif

                            <div class="sub-head">
                                Regulatory Affair
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_RegulatoryAffair_Review !== 'yes')
                                        $('.RegulatoryAffair').hide();

                                        $('[name="hod_RegulatoryAffair_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.RegulatoryAffair').show();
                                                $('.RegulatoryAffair span').show();
                                            } else {
                                                $('.RegulatoryAffair').hide();
                                                $('.RegulatoryAffair span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 81,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 RegulatoryAffair">
                                    <div class="group-input">
                                        <label for="Regulatory Affair feedback">HOD Regulatory Affair Review Comments <span
                                                id="asteriskPT2"
                                                style="display: {{ $data5->hod_RegulatoryAffair_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_RegulatoryAffair_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_RegulatoryAffair_person) && Auth::user()->name != $data5->hod_RegulatoryAffair_person)) readonly @endif
                                            name="hod_RegulatoryAffair_feedback" id="summernote-18" @if ($data5->hod_RegulatoryAffair_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_RegulatoryAffair_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 RegulatoryAffair">
                                    <div class="group-input">
                                        <label for="Regulatory Affair attachment">HOD Regulatory Affair
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_RegulatoryAffair_attachment">
                                                @if ($data5->hod_RegulatoryAffair_attachment)
                                                    @foreach (json_decode($data5->hod_RegulatoryAffair_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_RegulatoryAffair_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_RegulatoryAffair_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 RegulatoryAffair">
                                    <div class="group-input">
                                        <label for="Regulatory Affair Completed By">HOD Regulatory Affair Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_RegulatoryAffair_by }}"
                                            name="hod_RegulatoryAffair_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_RegulatoryAffair_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 RegulatoryAffair">
                                        <div class="group-input ">
                                            <label for="Regulatory Affair Completed On">Regulatory Affair Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="RegulatoryAffair_on"
                                                name="RegulatoryAffair_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->RegulatoryAffair_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 RegulatoryAffair new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Regulatory Affair Completed On">HOD Regulatory Affair Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_RegulatoryAffair_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_RegulatoryAffair_on) }}" />
                                            <input readonly type="date" name="hod_RegulatoryAffair_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_RegulatoryAffair_on')" />
                                        </div>
                                        @error('hod_RegulatoryAffair_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_RegulatoryAffair_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_RegulatoryAffair_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 81,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair feedback">HOD Regulatory Affair Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_RegulatoryAffair_Review" id="summernote-18">{{ $data5->hod_RegulatoryAffair_Review }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 RegulatoryAffair">
                                        <div class="group-input">
                                            <label for="Regulatory Affair feedback">HOD Regulatory Affair Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_RegulatoryAffair_Review" id="summernote-18">{{ $data5->hod_RegulatoryAffair_Review }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 RegulatoryAffair">
                                    <div class="group-input">
                                        <label for="Regulatory Affair attachment">HOD Regulatory Affair
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_RegulatoryAffair_attachment">
                                                @if ($data5->hod_RegulatoryAffair_attachment)
                                                    @foreach (json_decode($data5->hod_RegulatoryAffair_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_RegulatoryAffair_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_RegulatoryAffair_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 RegulatoryAffair">
                                    <div class="group-input">
                                        <label for="Regulatory Affair Completed By">HOD Regulatory Affair Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_RegulatoryAffair_by }}"
                                            name="hod_RegulatoryAffair_by" id="hod_RegulatoryAffair_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 RegulatoryAffair new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Regulatory Affair Completed On">HOD Regulatory Affair Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_RegulatoryAffair_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_RegulatoryAffair_on) }}" />
                                            <input readonly type="date" name="hod_RegulatoryAffair_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_RegulatoryAffair_on')" />
                                        </div>
                                        @error('hod_RegulatoryAffair_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif









                            <div class="sub-head">
                                Quality Assurance
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Quality_Assurance_Review !== 'yes')

                                        $('.quality_assurance').hide();

                                        $('[name="hod_Quality_Assurance_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {
                                                $('.quality_assurance').show();
                                                $('.quality_assurance span').show();
                                            } else {
                                                $('.quality_assurance').hide();
                                                $('.quality_assurance span').hide();
                                            }
                                        });
                                    @endif

                                });
                            </script> -->

                            @php
                                $userRoles = DB::table('user_roles')
                                    ->where(['q_m_s_roles_id' => 79, 'q_m_s_divisions_id' => $data->division_id])
                                    ->get();
                                $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                //$users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                            @endphp


                            <div class="col-md-12 mb-3 quality_assurance">
                                <div class="group-input">
                                    <label for="Quality Assurance Feedback">HOD Quality Assurance Review Comments <span
                                            id="asteriskQQA2"
                                            style="display: {{ $data5->hod_Quality_Assurance_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                            class="text-danger">*</span></label>
                                    <div><small class="text-primary">Please insert "NA" in the data field if it does
                                            not require completion</small></div>
                                    <textarea @if ($data5->hod_Quality_Assurance_Review == 'yes' && $data->stage == 5) required @endif class="summernote hod_QualityAssurance_feedback"
                                        name="hod_QualityAssurance_feedback" @if ($data->stage == 3 || Auth::user()->name != $data5->hod_QualityAssurance_person) readonly @endif id="summernote-24">{{ $data5->hod_QualityAssurance_feedback }}</textarea>
                                </div>
                            </div>

                            <script>
                                document.addEventListener('DOMContentLoaded', function() {
                                    var selectField = document.getElementById('hod_Quality_Assurance_Review');
                                    var inputsToToggle = [];

                                    // Add elements with class 'facility-name' to inputsToToggle
                                    var facilityNameInputs = document.getElementsByClassName('hod_QualityAssurance_person');
                                    for (var i = 0; i < facilityNameInputs.length; i++) {
                                        inputsToToggle.push(facilityNameInputs[i]);
                                    }

                                    selectField.addEventListener('change', function() {
                                        var isRequired = this.value === 'yes';

                                        inputsToToggle.forEach(function(input) {
                                            input.required = isRequired;
                                        });

                                        // Show or hide the asterisk icon based on the selected value
                                        var asteriskIcon = document.getElementById('asteriskQQA');
                                        asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                    });
                                });
                            </script>
                            <div class="col-12 quality_assurance">
                                <div class="group-input">
                                    <label for="Quality Assurance Attachments">HOD Quality Assurance Attachments</label>
                                    <div><small class="text-primary">Please Attach all relevant or supporting
                                            documents</small></div>
                                    <div class="file-attachment-field">
                                        <div disabled class="file-attachment-list"
                                            id="hod_Quality_Assurance_attachment">
                                            @if ($data5->hod_Quality_Assurance_attachment)
                                                @foreach (json_decode($data5->hod_Quality_Assurance_attachment) as $file)
                                                    <h6 type="button" class="file-container text-dark"
                                                        style="background-color: rgb(243, 242, 240);">
                                                        <b>{{ $file }}</b>
                                                        <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                                class="fa fa-eye text-primary"
                                                                style="font-size:20px; margin-right:-10px;"></i></a>
                                                        <a type="button" class="remove-file"
                                                            data-file-name="{{ $file }}"><i
                                                                class="fa-solid fa-circle-xmark"
                                                                style="color:red; font-size:20px;"></i></a>
                                                    </h6>
                                                @endforeach
                                            @endif
                                        </div>
                                        <div class="add-btn">
                                            <div>Add</div>
                                            <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                type="file" id="myfile"
                                                name="hod_Quality_Assurance_attachment[]"
                                                oninput="addMultipleFiles(this, 'hod_Quality_Assurance_attachment')"
                                                multiple>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3 quality_assurance">
                                <div class="group-input">
                                    <label for="Quality Assurance Review Completed By">HOD Quality Assurance Review
                                        Completed By</label>
                                    <input type="text" name="hod_QualityAssurance_by" id="hod_QualityAssurance_by"
                                        value="{{ $data5->hod_QualityAssurance_by }}" disabled>
                                </div>
                            </div>
                            <div class="col-6 mb-3 quality_assurance new-date-data-field">
                                <div class="group-input input-date">
                                    <label for="Quality Assurance Review Completed On">HOD Quality Assurance Review
                                        Completed On</label>
                                    <div class="calenderauditee">
                                        <input type="text" id="hod_QualityAssurance_on" readonly
                                            placeholder="DD-MMM-YYYY"
                                            value="{{ Helpers::getdateFormat($data5->hod_QualityAssurance_on) }}" />
                                        <input type="date" name="hod_QualityAssurance_on"
                                            min="{{ \Carbon\Carbon::now()->format('Y-M-d') }}" value=""
                                            class="hide-input"
                                            oninput="handleDateInput(this, 'hod_QualityAssurance_on')" />
                                    </div>
                                    @error('hod_QualityAssurance_on')
                                        <div class="text-danger">{{ $message }}</div>
                                    @enderror
                                </div>
                            </div>


                            <div class="sub-head">
                                Production (Liquid/Ointment)
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_ProductionLiquid_Review !== 'yes')
                                        $('.productionLiquid').hide();

                                        $('[name="hod_ProductionLiquid_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.productionLiquid').show();
                                                $('.productionLiquid span').show();
                                            } else {
                                                $('.productionLiquid').hide();
                                                $('.productionLiquid span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 69,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 productionLiquid">
                                    <div class="group-input">
                                        <label for="Production Liquid feedback">HOD Production Liquid/Ointment Review Comments
                                            <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_ProductionLiquid_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_ProductionLiquid_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_ProductionLiquid_person) && Auth::user()->name != $data5->hod_ProductionLiquid_person)) readonly @endif
                                            name="hod_ProductionLiquid_feedback" id="summernote-18" @if ($data5->hod_ProductionLiquid_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_ProductionLiquid_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 productionLiquid">
                                    <div class="group-input">
                                        <label for="Production Liquid attachment">HOD Production Liquid/Ointment
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_ProductionLiquid_attachment">
                                                @if ($data5->hod_ProductionLiquid_attachment)
                                                    @foreach (json_decode($data5->hod_ProductionLiquid_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_ProductionLiquid_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_ProductionLiquid_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 productionLiquid">
                                    <div class="group-input">
                                        <label for="Production Liquid Completed By">HOD Production Liquid/Ointment Review
                                            Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_ProductionLiquid_by }}"
                                            name="hod_ProductionLiquid_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_ProductionLiquid_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 productionLiquid">
                                        <div class="group-input ">
                                            <label for="Production Liquid Completed On">Production Liquid Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="ProductionLiquid_on"
                                                name="ProductionLiquid_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->ProductionLiquid_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 productionLiquid new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Liquid Completed On">HOD Production Liquid/Ointment Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_ProductionLiquid_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_ProductionLiquid_on) }}" />
                                            <input readonly type="date" name="hod_ProductionLiquid_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_ProductionLiquid_on')" />
                                        </div>
                                        @error('hod_ProductionLiquid_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_ProductionLiquid_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_ProductionLiquid_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 69,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid Comment">HOD Production Liquid/Ointment Review
                                                Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_ProductionLiquid_feedback" id="summernote-18">{{ $data5->hod_ProductionLiquid_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 productionLiquid">
                                        <div class="group-input">
                                            <label for="Production Liquid feedback">HOD Production Liquid/Ointment Review
                                                Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_ProductionLiquid_feedback" id="summernote-18">{{ $data5->hod_ProductionLiquid_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 productionLiquid">
                                    <div class="group-input">
                                        <label for="Production Liquid attachment">HOD Production Liquid/Ointment
                                            Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_ProductionLiquid_attachment">
                                                @if ($data5->hod_ProductionLiquid_attachment)
                                                    @foreach (json_decode($data5->hod_ProductionLiquid_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_ProductionLiquid_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_ProductionLiquid_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 productionLiquid">
                                    <div class="group-input">
                                        <label for="Production Liquid Completed By">HOD Production Liquid/Ointment Review
                                            Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_ProductionLiquid_by }}"
                                            name="hod_ProductionLiquid_by" id="hod_ProductionLiquid_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 productionLiquid new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Production Liquid Completed On">HOD Production Liquid/Ointment Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_ProductionLiquid_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_ProductionLiquid_on) }}" />
                                            <input readonly type="date" name="hod_ProductionLiquid_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_ProductionLiquid_on')" />
                                        </div>
                                        @error('hod_ProductionLiquid_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif


                            <div class="sub-head">
                                Quality Control
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Quality_review !== 'yes')
                                        $('.qualityControl').hide();

                                        $('[name="hod_Quality_review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.qualityControl').show();
                                                $('.qualityControl span').show();
                                            } else {
                                                $('.qualityControl').hide();
                                                $('.qualityControl span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 80,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 qualityControl">
                                    <div class="group-input">
                                        <label for="Quality Control feedback">HOD Quality Control Review Comments <span
                                                id="asteriskPT2"
                                                style="display: {{ $data5->hod_Quality_review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Quality_Control_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Quality_Control_Person) && Auth::user()->name != $data5->hod_Quality_Control_Person)) readonly @endif
                                            name="hod_Quality_Control_feedback" id="summernote-18" @if ($data5->hod_Quality_review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Quality_Control_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 qualityControl">
                                    <div class="group-input">
                                        <label for="Quality Control attachment">HOD Quality Control Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Quality_Control_attachment">
                                                @if ($data5->hod_Quality_Control_attachment)
                                                    @foreach (json_decode($data5->hod_Quality_Control_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Quality_Control_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Quality_Control_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 qualityControl">
                                    <div class="group-input">
                                        <label for="Quality Control Completed By">HOD Quality Control Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Quality_Control_by }}"
                                            name="hod_Quality_Control_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Quality_Control_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 qualityControl">
                                        <div class="group-input ">
                                            <label for="Quality Control Completed On">Quality Control Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Quality_Control_on"
                                                name="Quality_Control_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->Quality_Control_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 qualityControl new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Quality Control Completed On">HOD Quality Control Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Quality_Control_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Quality_Control_on) }}" />
                                            <input readonly type="date" name="hod_Quality_Control_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Quality_Control_on')" />
                                        </div>
                                        @error('hod_Quality_Control_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Quality_review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Quality_Control_Person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 80,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control feedback">HOD Quality Control Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Quality_Control_feedback" id="summernote-18">{{ $data5->hod_Quality_Control_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 qualityControl">
                                        <div class="group-input">
                                            <label for="Quality Control feedback">HOD Quality Control ReviewComments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Quality_Control_feedback" id="summernote-18">{{ $data5->hod_Quality_Control_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 qualityControl">
                                    <div class="group-input">
                                        <label for="Quality Control attachment">HOD Quality Control Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Quality_Control_attachment">
                                                @if ($data5->hod_Quality_Control_attachment)
                                                    @foreach (json_decode($data5->hod_Quality_Control_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="Store_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Quality_Control_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 qualityControl">
                                    <div class="group-input">
                                        <label for="Quality Control Completed By">HOD Quality Control Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Quality_Control_by }}"
                                            name="hod_Quality_Control_by" id="hod_Quality_Control_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 qualityControl new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Quality Control Completed On">HOD Quality Control Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Quality_Control_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Quality_Control_on) }}" />
                                            <input readonly type="date" name="hod_Quality_Control_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Quality_Control_on')" />
                                        </div>
                                        @error('hod_Quality_Control_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif

                            <div class="sub-head">
                                Microbiology
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Microbiology_Review !== 'yes')
                                        $('.Microbiology').hide();

                                        $('[name="hod_Microbiology_Review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.Microbiology').show();
                                                $('.Microbiology span').show();
                                            } else {
                                                $('.Microbiology').hide();
                                                $('.Microbiology span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 73,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 Microbiology">
                                    <div class="group-input">
                                        <label for="Microbiology feedback">HOD Microbiology Review Comments <span
                                                id="asteriskPT2"
                                                style="display: {{ $data5->hod_Microbiology_Review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Microbiology_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Microbiology_person) && Auth::user()->name != $data5->hod_Microbiology_person)) readonly @endif
                                            name="hod_Microbiology_feedback" id="summernote-18" @if ($data5->hod_Microbiology_Review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Microbiology_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Microbiology">
                                    <div class="group-input">
                                        <label for="Microbiology attachment">HOD Microbiology Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Microbiology_attachment">
                                                @if ($data5->hod_Microbiology_attachment)
                                                    @foreach (json_decode($data5->hod_Microbiology_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Microbiology_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Microbiology_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Microbiology">
                                    <div class="group-input">
                                        <label for="Microbiology Completed By">HOD Microbiology Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Microbiology_by }}"
                                            name="hod_Microbiology_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Microbiology_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 Microbiology">
                                        <div class="group-input ">
                                            <label for="Microbiology Completed On">Microbiology Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Microbiology_on"
                                                name="Microbiology_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->Microbiology_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 Microbiology new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Microbiology Completed On">HOD Microbiology Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Microbiology_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Microbiology_on) }}" />
                                            <input readonly type="date" name="hod_Microbiology_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Microbiology_on')" />
                                        </div>
                                        @error('hod_Microbiology_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Microbiology_Review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Microbiology_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 73,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology feedback">HOD Microbiology Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Microbiology_feedback" id="summernote-18">{{ $data5->hod_Microbiology_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 Microbiology">
                                        <div class="group-input">
                                            <label for="Microbiology feedback">HOD Microbiology Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Microbiology_feedback" id="summernote-18">{{ $data5->hod_Microbiology_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 Microbiology">
                                    <div class="group-input">
                                        <label for="Microbiology attachment">HOD Microbiology Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Microbiology_attachment">
                                                @if ($data5->hod_Microbiology_attachment)
                                                    @foreach (json_decode($data5->hod_Microbiology_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Microbiology_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Microbiology_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Microbiology">
                                    <div class="group-input">
                                        <label for="Microbiology Completed By">HOD Microbiology Review Completed
                                            By</label>
                                        <input readonly type="text" value="{{ $data5->hod_Microbiology_by }}"
                                            name="hod_Microbiology_by" id="hod_Microbiology_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 Microbiology new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Microbiology Completed On">HOD Microbiology Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Microbiology_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Microbiology_on) }}" />
                                            <input readonly type="date" name="hod_Microbiology_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Microbiology_on')" />
                                        </div>
                                        @error('hod_Microbiology_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif



                            <div class="sub-head">
                                Safety
                            </div>
                            <!-- <script>
                                $(document).ready(function() {
                                    @if ($data5->hod_Environment_Health_review !== 'yes')
                                        $('.safety').hide();

                                        $('[name="hod_Environment_Health_review"]').change(function() {
                                            if ($(this).val() === 'yes') {

                                                $('.safety').show();
                                                $('.safety span').show();
                                            } else {
                                                $('.safety').hide();
                                                $('.safety span').hide();
                                            }
                                        });
                                    @endif
                                });
                            </script> -->
                            @php
                                $data5 = DB::table('hodmanagement_cfts')
                                    ->where('ManagementReview_id', $data->id)
                                    ->first();
                            @endphp

                            @if ($data->stage == 3 || $data->stage == 5)

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 75,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3 safety">
                                    <div class="group-input">
                                        <label for="Safety feedback">HOD Safety Review Comments <span id="asteriskPT2"
                                                style="display: {{ $data5->hod_Environment_Health_review == 'yes' && $data->stage == 5 ? 'inline' : 'none' }}"
                                                class="text-danger">*</span></label>
                                        <div><small class="text-primary">Please insert "NA" in the data field if it
                                                does not require completion</small></div>
                                        <textarea class="summernote hod_Health_Safety_feedback" @if (
                                            $data->stage == 3 ||
                                                (isset($data5->hod_Environment_Health_Safety_person) &&
                                                    Auth::user()->name != $data5->hod_Environment_Health_Safety_person)) readonly @endif
                                            name="hod_Health_Safety_feedback" id="summernote-18" @if ($data5->hod_Environment_Health_review == 'yes' && $data->stage == 5) required @endif>{{ $data5->hod_Health_Safety_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 safety">
                                    <div class="group-input">
                                        <label for="Safety attachment">HOD Safety Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Environment_Health_Safety_attachment">
                                                @if ($data5->hod_Environment_Health_Safety_attachment)
                                                    @foreach (json_decode($data5->hod_Environment_Health_Safety_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Environment_Health_Safety_attachment[]"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                    oninput="addMultipleFiles(this, 'hod_Environment_Health_Safety_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 safety">
                                    <div class="group-input">
                                        <label for="Safety Completed By">HOD Safety Review Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_Environment_Health_Safety_by }}"
                                            name="hod_Environment_Health_Safety_by"{{ $data->stage == 0 || $data->stage == 7 ? 'readonly' : '' }}
                                            id="hod_Environment_Health_Safety_by">


                                    </div>
                                </div>
                                {{-- <div class="col-lg-6 safety">
                                        <div class="group-input ">
                                            <label for="Safety Completed On">Safety Completed
                                                On</label>
                                            <!-- <div><small class="text-primary">Please select related information</small></div> -->
                                            <input type="date"id="Environment_Health_Safety_on"
                                                name="Environment_Health_Safety_on"{{ $data->stage == 0 || $data->stage == 7 ? 'disabled' : '' }}
                                                value="{{ $data5->Environment_Health_Safety_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-lg-6 safety new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Safety Completed On">HOD Safety Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Environment_Health_Safety_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Environment_Health_Safety_on) }}" />
                                            <input readonly type="date" name="hod_Environment_Health_Safety_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Environment_Health_Safety_on')" />
                                        </div>
                                        @error('hod_Environment_Health_Safety_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Environment_Health_review');
                                        var inputsToToggle = [];

                                        // Add elements with class 'facility-name' to inputsToToggle
                                        var facilityNameInputs = document.getElementsByClassName('hod_Environment_Health_Safety_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Assessment');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }
                                        // var facilityNameInputs = document.getElementsByClassName('Production_Injection_Feedback');
                                        // for (var i = 0; i < facilityNameInputs.length; i++) {
                                        //     inputsToToggle.push(facilityNameInputs[i]);
                                        // }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';
                                            console.log(this.value, isRequired, 'value');

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                                console.log(input.required, isRequired, 'input req');
                                            });

                                            // Show or hide the asterisk icon based on the selected value
                                            var asteriskIcon = document.getElementById('asteriskPT');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                            @else
                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where([
                                            'q_m_s_roles_id' => 75,
                                            'q_m_s_divisions_id' => $data->division_id,
                                        ])
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp

                                @if ($data->stage == 5)
                                    <div class="col-md-12 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety feedback">HOD Safety Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea class="tiny" name="hod_Health_Safety_feedback" id="summernote-18">{{ $data5->hod_Health_Safety_feedback }}</textarea>
                                        </div>
                                    </div>
                                @else
                                    <div class="col-md-12 mb-3 safety">
                                        <div class="group-input">
                                            <label for="Safety feedback">HOD Safety Review Comments</label>
                                            <div><small class="text-primary">Please insert "NA" in the data field if
                                                    it
                                                    does not require completion</small></div>
                                            <textarea disabled class="tiny" name="hod_Health_Safety_feedback" id="summernote-18">{{ $data5->hod_Health_Safety_feedback }}</textarea>
                                        </div>
                                    </div>
                                @endif
                                <div class="col-12 safety">
                                    <div class="group-input">
                                        <label for="Safety attachment">HOD Safety Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list"
                                                id="hod_Environment_Health_Safety_attachment">
                                                @if ($data5->hod_Environment_Health_Safety_attachment)
                                                    @foreach (json_decode($data5->hod_Environment_Health_Safety_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input disabled
                                                    {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile"
                                                    name="hod_Environment_Health_Safety_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Environment_Health_Safety_attachment')"
                                                    multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 safety">
                                    <div class="group-input">
                                        <label for="Safety Completed By">HOD Safety Review Completed
                                            By</label>
                                        <input readonly type="text"
                                            value="{{ $data5->hod_Environment_Health_Safety_by }}"
                                            name="hod_Environment_Health_Safety_by"
                                            id="hod_Environment_Health_Safety_by">


                                    </div>
                                </div>
                                <div class="col-lg-6 safety new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Safety Completed On">HOD Safety Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Environment_Health_Safety_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Environment_Health_Safety_on) }}" />
                                            <input readonly type="date" name="hod_Environment_Health_Safety_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input"
                                                oninput="handleDateInput(this, 'hod_Environment_Health_Safety_on')" />
                                        </div>
                                        @error('hod_Environment_Health_Safety_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @endif





                            <!-- HTML Section -->



                            @if ($data->stage == 3 || $data->stage == 5)
                                <div class="sub-head">
                                    Other's 1 ( Additional Person Review From Departments If Required)
                                </div>
                                <!-- <script>
                                    $(document).ready(function() {
                                        @if ($data5->hod_Other1_review !== 'yes')
                                            $('.hod_Other1_reviews').hide();

                                            $('[name="hod_Other1_review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.hod_Other1_reviews').show();
                                                    $('.hod_Other1_reviews span').show();
                                                } else {
                                                    $('.hod_Other1_reviews').hide();
                                                    $('.hod_Other1_reviews span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script> -->

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp




                                {{-- <div class="col-md-12 mb-3 hod_Other1_reviews">
                                    <div class="group-input">
                                        <label for="Feedback1"> HOD Other's 1 Comments
                                        </label>
                                        <textarea @if ($data5->hod_Other1_review == 'yes' && $data->stage == 5) required @endif class="tiny" name="hod_Other1_feedback"
                                            @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other1_person) readonly @endif id="summernote-42">{{ $data5->hod_Other1_feedback }}</textarea>
                                    </div>
                                </div> --}}
                                <div class="col-md-12 mb-3 hod_Other1_reviews">
                                    <div class="group-input">
                                        <label for="Feedback1"> HOD Other's 1 Review Comments
                                        </label>
                                        <textarea @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other1_person) readonly @endif class="tiny" name="hod_Other1_feedback"
                                            @if ($data5->hod_Other1_review == 'yes' && $data->stage == 5) required @endif id="summernote-44">{{ $data5->hod_Other1_feedback }}</textarea>
                                    </div>
                                </div>
                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('Other1_review');
                                        var inputsToToggle = [];

                                        var facilityNameInputs = document.getElementsByClassName('Other1_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        var facilityNameInputs = document.getElementsByClassName('Other1_Department_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            var asteriskIcon = document.getElementById('asterisko1');
                                            var asteriskIcon1 = document.getElementById('asteriskod1');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            asteriskIcon1.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>
                                <div class="col-12 other1_reviews ">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 1 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other1_attachment">
                                                @if ($data5->hod_Other1_attachment)
                                                    @foreach (json_decode($data5->hod_Other1_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other1_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other1_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 other1_reviews ">
                                    <div class="group-input">
                                        <label for="Review Completed By1"> HOD Other's 1 Review Completed By</label>
                                        <input disabled type="text" value="{{ $data5->hod_Other1_by }}"
                                            name="hod_Other1_by" id="hod_Other1_by">

                                    </div>
                                </div>
                                {{-- <div class="col-md-6 mb-3 other1_reviews ">
                                        <div class="group-input">
                                            <label for="Review Completed On1">Other's 1 Review Completed On</label>
                                            <input disabled type="date" name="Other1_on" id="Other1_on"
                                                value="{{ $data5->Other1_on }}">

                                        </div>
                                    </div> --}}
                                <div class="col-6 other1_reviews new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Others 1 Completed On">HOD Others 1 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other1_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other1_on) }}" />
                                            <input readonly type="date" name="hod_Other1_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other1_on')" />
                                        </div>
                                        @error('hod_Other1_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <div class="sub-head">
                                    Other's 2 ( Additional Person Review From Departments If Required)
                                </div>
                                <!-- <script>
                                    $(document).ready(function() {
                                        @if ($data5->hod_Other2_review !== 'yes')
                                            $('.hod_Other2_reviews').hide();

                                            $('[name="Other2_review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.Other2_reviews').show();
                                                    $('.Other2_reviews span').show();
                                                } else {
                                                    $('.Other2_reviews').hide();
                                                    $('.Other2_reviews span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script> -->


                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Other2_review');
                                        var inputsToToggle = [];

                                        var facilityNameInputs = document.getElementsByClassName('Other2_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        var facilityNameInputs = document.getElementsByClassName('Other2_Department_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            var asteriskIcon = document.getElementById('asterisko2');
                                            var asteriskIcon1 = document.getElementById('asteriskod2');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            asteriskIcon1.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>

                                <div class="col-md-12 mb-3 Other2_reviews">
                                    <div class="group-input">
                                        <label for="Feedback2"> HOD Other's 2 Review Comments
                                        </label>
                                        <textarea @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other2_person) readonly @endif class="tiny" name="hod_Other2_feedback"
                                            @if ($data5->hod_Other2_review == 'yes' && $data->stage == 5) required @endif id="summernote-44">{{ $data5->hod_Other2_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Other2_reviews">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 2 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other2_attachment">
                                                @if ($data5->hod_Other2_attachment)
                                                    @foreach (json_decode($data5->hod_Other2_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other2_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other2_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Other2_reviews">
                                    <div class="group-input">
                                        <label for="Review Completed By2"> HOD Other's 2 Review Completed By</label>
                                        <input type="text" name="hod_Other2_by" id="hod_Other2_by"
                                            value="{{ $data5->hod_Other2_by }}" disabled>

                                    </div>
                                </div>
                                <div class="col-6 Other2_reviews new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Others 2 Completed On">HOD Others 2 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other2_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other2_on) }}" />
                                            <input readonly type="date" name="hod_Other2_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other2_on')" />
                                        </div>
                                        @error('hod_Other2_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <div class="sub-head">
                                    Other's 3 ( Additional Person Review From Departments If Required)
                                </div>
                                <!-- <script>
                                    $(document).ready(function() {
                                        @if ($data5->hod_Other3_review !== 'yes')
                                            $('.hod_Other3_reviews').hide();

                                            $('[name="Other3_review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.Other3_reviews').show();
                                                    $('.Other3_reviews span').show();
                                                } else {
                                                    $('.Other3_reviews').hide();
                                                    $('.Other3_reviews span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script>
                 -->

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Other3_review');
                                        var inputsToToggle = [];

                                        var facilityNameInputs = document.getElementsByClassName('Other3_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        var facilityNameInputs = document.getElementsByClassName('Other3_Department_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            var asteriskIcon = document.getElementById('asterisko3');
                                            var asteriskIcon1 = document.getElementById('asteriskod3');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            asteriskIcon1.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>

                                <div class="col-md-12 mb-3 Other3_reviews">
                                    <div class="group-input">
                                        <label for="feedback3">HOD Other's 3 Review Comments
                                        </label>
                                        <textarea @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other3_person) readonly @endif class="tiny" name="hod_Other3_feedback"
                                            @if ($data5->hod_Other3_review == 'yes' && $data->stage == 5) required @endif id="summernote-46">{{ $data5->hod_Other3_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Other3_reviews">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 3 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other3_attachment">
                                                @if ($data5->hod_Other3_attachment)
                                                    @foreach (json_decode($data5->hod_Other3_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other3_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other3_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Other3_reviews">
                                    <div class="group-input">
                                        <label for="productionfeedback">HOD Other's 3 Review Completed By</label>
                                        <input type="text" name="hod_Other3_by" id="hod_Other3_by"
                                            value="{{ $data5->hod_Other3_by }}" disabled>

                                    </div>
                                </div>
                                {{-- <div class="col-md-6 mb-3 Other3_reviews">
                                        <div class="group-input">
                                            <label for="productionfeedback">Other's 3 Review Completed On</label>
                                            <input disabled type="date" name="Other3_on" id="Other3_on"
                                                value="{{ $data5->Other3_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-6  new-date-data-field Other3_reviews">
                                    <div class="group-input input-date">
                                        <label for="Others 3 Completed On">HOD Others 3 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other3_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other3_on) }}" />
                                            <input readonly type="date" name="hod_Other3_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other3_on')" />
                                        </div>
                                        @error('hod_Other3_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <div class="sub-head">
                                    Other's 4 ( Additional Person Review From Departments If Required)
                                </div>
                                <!-- <script>
                                    $(document).ready(function() {
                                        @if ($data5->hod_Other4_review !== 'yes')
                                            $('.hod_Other4_review').hide();

                                            $('[name="Other4_review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.Other4_reviews').show();
                                                    $('.Other4_reviews span').show();
                                                } else {
                                                    $('.Other4_reviews').hide();
                                                    $('.Other4_reviews span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script> -->


                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Other4_review');
                                        var inputsToToggle = [];

                                        var facilityNameInputs = document.getElementsByClassName('Other4_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        var facilityNameInputs = document.getElementsByClassName('Other4_Department_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            var asteriskIcon = document.getElementById('asterisko4');
                                            var asteriskIcon1 = document.getElementById('asteriskod4');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            asteriskIcon1.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>

                                <div class="col-md-12 mb-3 Other4_reviews">
                                    <div class="group-input">
                                        <label for="feedback4"> HOD Other's 4 Review Comments
                                        </label>
                                        <textarea @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other4_person) readonly @endif class="tiny" name="Other4_feedback"
                                            @if ($data5->hod_Other4_review == 'yes' && $data->stage == 5) required @endif id="summernote-48">{{ $data5->Other4_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12 Other4_reviews">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 4 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other4_attachment">
                                                @if ($data5->hod_Other4_attachment)
                                                    @foreach (json_decode($data5->hod_Other4_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other4_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other4_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Other4_reviews">
                                    <div class="group-input">
                                        <label for="Review Completed By4"> HOD Other's 4 Review Completed By</label>
                                        <input type="text" name="hod_Other4_by" id="hod_Other4_by"
                                            value="{{ $data5->hod_Other4_by }}" disabled>

                                    </div>
                                </div>
                                <div class="col-6  new-date-data-field Other3_reviews">
                                    <div class="group-input input-date">
                                        <label for="Others 4 Completed On">HOD Others 4 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other4_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other4_on) }}" />
                                            <input readonly type="date" name="hod_Other4_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other4_on')" />
                                        </div>
                                        @error('hod_Other4_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>



                                <div class="sub-head">
                                    Other's 5 ( Additional Person Review From Departments If Required)
                                </div>
                                <!-- <script>
                                    $(document).ready(function() {
                                        @if ($data5->hod_Other5_review !== 'yes')
                                            $('.hod_Other5_reviews').hide();

                                            $('[name="Other5_review"]').change(function() {
                                                if ($(this).val() === 'yes') {
                                                    $('.Other5_reviews').show();
                                                    $('.Other5_reviews span').show();
                                                } else {
                                                    $('.Other5_reviews').hide();
                                                    $('.Other5_reviews span').hide();
                                                }
                                            });
                                        @endif
                                    });
                                </script> -->

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <script>
                                    document.addEventListener('DOMContentLoaded', function() {
                                        var selectField = document.getElementById('hod_Other5_review');
                                        var inputsToToggle = [];

                                        var facilityNameInputs = document.getElementsByClassName('Other5_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }
                                        var facilityNameInputs = document.getElementsByClassName('Other5_Department_person');
                                        for (var i = 0; i < facilityNameInputs.length; i++) {
                                            inputsToToggle.push(facilityNameInputs[i]);
                                        }

                                        selectField.addEventListener('change', function() {
                                            var isRequired = this.value === 'yes';

                                            inputsToToggle.forEach(function(input) {
                                                input.required = isRequired;
                                            });

                                            var asteriskIcon = document.getElementById('asterisko5');
                                            var asteriskIcon1 = document.getElementById('asteriskod5');
                                            asteriskIcon.style.display = isRequired ? 'inline' : 'none';
                                            asteriskIcon1.style.display = isRequired ? 'inline' : 'none';
                                        });
                                    });
                                </script>

                                <div class="col-md-12 mb-3 Other5_reviews">
                                    <div class="group-input">
                                        <label for="productionfeedback">HOD Other's 5 Review Comments
                                        </label>
                                        <textarea @if ($data->stage == 3 || Auth::user()->name != $data5->hod_Other5_person) readonly @endif class="tiny"
                                            name="hod_Other5_feedback"@if ($data5->hod_Other5_review == 'yes' && $data->stage == 5) required @endif id="summernote-50">{{ $data5->hod_Other5_feedback }}</textarea>
                                    </div>
                                </div>

                                <div class="col-12 Other5_reviews">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 5 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other5_attachment">
                                                @if ($data5->hod_Other5_attachment)
                                                    @foreach (json_decode($data5->hod_Other5_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other5_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other5_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3 Other5_reviews">
                                    <div class="group-input">
                                        <label for="Review Completed By5"> HOD Other's 5 Review Completed By</label>
                                        <input type="text" name="hod_Other5_by" id="hod_Other5_by"
                                            value="{{ $data5->hod_Other5_by }}" disabled>

                                    </div>
                                </div>
                                {{-- <div class="col-md-6 mb-3 Other5_reviews">
                                        <div class="group-input">
                                            <label for="Review Completed On5">Other's 5 Review Completed On</label>
                                            <input disabled type="date" name="Other5_on" id="Other5_on"
                                                value="{{ $data5->Other5_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-6  new-date-data-field Other5_reviews">
                                    <div class="group-input input-date">
                                        <label for="Others 5 Completed On">HOD Others 5 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other5_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other5_on) }}" />
                                            <input readonly type="date" name="hod_Other5_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other5_on')" />
                                        </div>
                                        @error('hod_Other5_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                            @else
                                <div class="sub-head">
                                    Other's 1 ( Additional Person Review From Departments If Required)
                                </div>

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp


                                <div class="col-md-12 mb-3">
                                    <div class="group-input">
                                        <label for="Feedback1"> HOD Other's 1 Review Comments</label>
                                        <textarea disabled class="tiny"
                                            name="hod_Other1_feedback"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }} id="summernote-42">{{ $data5->hod_Other1_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 1 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other1_attachment">
                                                @if ($data5->hod_Other1_attachment)
                                                    @foreach (json_decode($data5->hod_Other1_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other1_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other1_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="Review Completed By1"> HOD Other's 1 Review Completed By</label>
                                        <input disabled type="text" value="{{ $data5->hod_Other1_by }}"
                                            name="hod_Other1_by" id="hod_Other1_by">

                                    </div>
                                </div>
                                <div class="col-6 other1_reviews new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Others 1 Completed On">HOD Others 1 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other1_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other1_on) }}" />
                                            <input readonly type="date" name="hod_Other1_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other1_on')" />
                                        </div>
                                        @error('hod_Other1_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <div class="sub-head">
                                    Other's 2 ( Additional Person Review From Departments If Required)
                                </div>


                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp




                                <div class="col-md-12 mb-3">
                                    <div class="group-input">
                                        <label for="Feedback2"> HOD Other's 2 Review Comments</label>
                                        <textarea disabled class="tiny"
                                            name="hod_Other2_feedback"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }} id="summernote-44">{{ $data5->hod_Other2_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 2 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other2_attachment">
                                                @if ($data5->hod_Other2_attachment)
                                                    @foreach (json_decode($data5->hod_Other2_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other2_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other2_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="Review Completed By2"> HOD Other's 2 Review Completed By</label>
                                        <input type="text" name="hod_Other2_by" id="hod_Other2_by"
                                            value="{{ $data5->hod_Other2_by }}" disabled>

                                    </div>
                                </div>
                                {{-- <div class="col-md-6 mb-3">
                                        <div class="group-input">
                                            <label for="Review Completed On2">Other's 2 Review Completed On</label>
                                            <input disabled type="date" name="Other2_on" id="Other2_on"
                                                value="{{ $data5->Other2_on }}">
                                        </div>
                                    </div> --}}
                                <div class="col-6 Other2_reviews new-date-data-field">
                                    <div class="group-input input-date">
                                        <label for="Others 2 Completed On">HOD Others 2 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other2_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other2_on) }}" />
                                            <input readonly type="date" name="hod_Other2_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other2_on')" />
                                        </div>
                                        @error('hod_Other2_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>

                                <div class="sub-head">
                                    Other's 3 ( Additional Person Review From Departments If Required)
                                </div>


                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp



                                <div class="col-md-12 mb-3">
                                    <div class="group-input">
                                        <label for="feedback3">HOD Other's 3 Review Comment</label>
                                        <textarea disabled class="tiny"
                                            name="hod_Other3_feedback"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }} id="summernote-46">{{ $data5->hod_Other3_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 3 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other3_attachment">
                                                @if ($data5->hod_Other3_attachment)
                                                    @foreach (json_decode($data5->hod_Other3_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other3_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other3_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="productionfeedback">HOD Other's 3 Review Completed By</label>
                                        <input type="text" name="hod_Other3_by" id="hod_Other3_by"
                                            value="{{ $data5->hod_Other3_by }}" disabled>

                                    </div>
                                </div>
                                <div class="col-6  new-date-data-field Other3_reviews">
                                    <div class="group-input input-date">
                                        <label for="Others 3 Completed On">HOD Others 3 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other3_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other3_on) }}" />
                                            <input readonly type="date" name="hod_Other3_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other3_on')" />
                                        </div>
                                        @error('hod_Other3_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>
                                <div class="sub-head">
                                    Other's 4 ( Additional Person Review From Departments If Required)
                                </div>


                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp



                                <div class="col-md-12 mb-3">
                                    <div class="group-input">
                                        <label for="feedback4">HOD Other's 4 Review Comments</label>
                                        <textarea disabled class="tiny"
                                            name="Other4_feedback"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }} id="summernote-48">{{ $data5->Other4_feedback }}</textarea>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 4 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other4_attachment">
                                                @if ($data5->hod_Other4_attachment)
                                                    @foreach (json_decode($data5->hod_Other4_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other4_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other4_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="Review Completed By4"> HOD Other's 4 Review Completed By</label>
                                        <input type="text" name="hod_Other4_by" id="hod_Other4_by"
                                            value="{{ $data5->hod_Other4_by }}" disabled>

                                    </div>
                                </div>
                                {{-- <div class="col-md-6 mb-3">
                                        <div class="group-input">
                                            <label for="Review Completed On4">Other's 4 Review Completed On</label>
                                            <input disabled type="date" name="Other4_on" id="Other4_on"
                                                value="{{ $data5->Other4_on }}">

                                        </div>
                                    </div> --}}
                                <div class="col-6  new-date-data-field Other3_reviews">
                                    <div class="group-input input-date">
                                        <label for="Others 4 Completed On">HOD Others 4 Review
                                            Completed On</label>
                                        <div class="calenderauditee">
                                            <input type="text" id="hod_Other4_on" readonly
                                                placeholder="DD-MMM-YYYY"
                                                value="{{ Helpers::getdateFormat($data5->hod_Other4_on) }}" />
                                            <input readonly type="date" name="hod_Other4_on"
                                                min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}" value=""
                                                class="hide-input" oninput="handleDateInput(this, 'hod_Other4_on')" />
                                        </div>
                                        @error('hod_Other4_on')
                                            <div class="text-danger">{{ $message }}</div>
                                        @enderror
                                    </div>
                                </div>



                                <div class="sub-head">
                                    Other's 5 ( Additional Person Review From Departments If Required)
                                </div>

                                @php
                                    $userRoles = DB::table('user_roles')
                                        ->where(['q_m_s_divisions_id' => $data->division_id])
                                        ->select('user_id')
                                        ->distinct()
                                        ->get();
                                    $userRoleIds = $userRoles->pluck('user_id')->toArray();
                                    $users = DB::table('users')->whereIn('id', $userRoleIds)->get(); // Fetch user data based on user IDs
                                @endphp



                                <div class="col-md-12 mb-3">
                                    <div class="group-input">
                                        <label for="productionfeedback">HOD Other's 5 Review Comments</label>
                                        <textarea disabled class="tiny"
                                            name="hod_Other5_feedback"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }} id="summernote-50">{{ $data5->hod_Other5_feedback }}</textarea>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="group-input">
                                        <label for="Audit Attachments">HOD Other's 5 Attachments</label>
                                        <div><small class="text-primary">Please Attach all relevant or supporting
                                                documents</small></div>
                                        <div class="file-attachment-field">
                                            <div disabled class="file-attachment-list" id="hod_Other5_attachment">
                                                @if ($data5->hod_Other5_attachment)
                                                    @foreach (json_decode($data5->hod_Other5_attachment) as $file)
                                                        <h6 type="button" class="file-container text-dark"
                                                            style="background-color: rgb(243, 242, 240);">
                                                            <b>{{ $file }}</b>
                                                            <a href="{{ asset('upload/' . $file) }}"
                                                                target="_blank"><i class="fa fa-eye text-primary"
                                                                    style="font-size:20px; margin-right:-10px;"></i></a>
                                                            <a type="button" class="remove-file"
                                                                data-file-name="{{ $file }}"><i
                                                                    class="fa-solid fa-circle-xmark"
                                                                    style="color:red; font-size:20px;"></i></a>
                                                        </h6>
                                                    @endforeach
                                                @endif
                                            </div>
                                            <div class="add-btn">
                                                <div>Add</div>
                                                <input {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}
                                                    type="file" id="myfile" name="hod_Other5_attachment[]"
                                                    oninput="addMultipleFiles(this, 'hod_Other5_attachment')" multiple>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="Review Completed By5"> HOD Other's 5 Review Completed By</label>
                                        <input type="text" name="hod_Other5_by" id="hod_Other5_by"
                                            value="{{ $data5->hod_Other5_by }}" disabled>

                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="group-input">
                                        <label for="Review Completed On5">HOD Other's 5 Review Completed On</label>
                                        <input disabled type="date" name="hod_Other5_on" id="hod_Other5_on"
                                            value="{{ $data5->hod_Other5_on }}">
                                    </div>
                                </div>
                            @endif

                        </div>
                        <div class="button-block">
                            <button style=" justify-content: center; width: 4rem; margin-left: 1px;;"
                                type="submit"{{ $data->stage == 0 || $data->stage == 7 || $data->stage == 12 ? 'disabled' : '' }}
                                id="ChangesaveButton" class="saveButton saveAuditFormBtn d-flex"
                                style="align-items: center;">
                                <div class="spinner-border spinner-border-sm auditFormSpinner" style="display: none"
                                    role="status">
                                    <span class="sr-only">Loading...</span>
                                </div>
                                Save
                            </button>
                            <button type="button" class="backButton" onclick="previousStep()">Back</button>
                            <button style=" justify-content: center; width: 4rem; margin-left: 1px;;"
                                type="button"{{ $data->stage == 0 || $data->stage == 12 ? 'disabled' : '' }}
                                id="ChangeNextButton" class="nextButton">Next</button>
                            <button style=" justify-content: center; width: 4rem; margin-left: 1px;;" type="button"> <a
                                    href="{{ url('rcms/qms-dashboard') }}" class="text-white">
                                    Exit </a> </button>
                            @if (
                                $data->stage == 2 ||
                                    $data->stage == 3 ||
                                    $data->stage == 4 ||
                                    $data->stage == 5 ||
                                    $data->stage == 6 ||
                                    $data->stage == 7)
                                {{-- <a style="  justify-content: center; width: 10rem; margin-left: 1px;;" type="button"
                                            class="button  launch_extension" data-bs-toggle="modal"
                                            data-bs-target="#launch_extension">
                                            Launch Extension
                                        </a> --}}
                            @endif
                            <!-- <a type="button" class="button  launch_extension" data-bs-toggle="modal"
                                                                                                                                                                                                                                                                                                                                                                                                data-bs-target="#effectivenss_extension">
                                                                                                                                                                                                                                                                                                                                                                                                Launch Effectiveness Check
                                                                                                                                                                                                                                                                                                                                                                                            </a> -->
                        </div>
                    </div>
                </div>

                <div id="CCForm8" class="inner-block cctabcontent">
                    <div class="inner-block-content">

                        {{-- <div class="group-input">
    <label for="additional_suport_required">
        QA verification Comment <span class="text-danger">*</span>
        <span class="text-primary" data-bs-toggle="modal"
            data-bs-target="#management-review-additional_suport_required-instruction-modal"
            style="font-size: 0.8rem; font-weight: 400; cursor:pointer;">
            (Launch Instruction)
        </span>
    </label>
    <textarea name="additional_suport_required" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }} required>{{ $data->additional_suport_required }}</textarea>
</div> --}}
                        <div class="col-md-12">
                            @if ($data->stage == 6)
                                <div class="group-input">
                                    <label for="HOD Remarks">QA Verification Comment <span
                                            class="text-danger">*</span></label>
                                    <div><small class="text-primary">Please insert "NA" in the data field if it
                                            does not require completion</small></div>
                                    <textarea class="tiny" name="additional_suport_required" id="summernote-4" required>{{ $data->additional_suport_required }}</textarea>
                                </div>
                            @else
                                <div class="group-input">
                                    <label for="HOD Remarks">QA Verification Comment</label>
                                    <div><small class="text-primary">Please insert "NA" in the data field if it
                                            does not require completion</small></div>
                                    <textarea readonly class="tiny" name="additional_suport_required" id="summernote-4">{{ $data->additional_suport_required }}</textarea>
                                </div>
                            @endif
                            @error('additional_suport_required')
                                <div class="text-danger">{{ $message }}</div>
                            @enderror
                        </div>

                        {{-- <div class="col-12">
                            <div class="group-input">
                                <label for="Inv Attachments">Action Item Status Attachment</label>
                                <div>
                                    <small class="text-primary">
                                        Please Attach all relevant or supporting documents
                                    </small>
                                </div>
                                <div class="file-attachment-field">
                                    <div class="file-attachment-list" id="qa_verification_file">
                                        @if ($data->qa_verification_file)
                                            @foreach (json_decode($data->qa_verification_file) as $file)
                                                <h6 type="button" class="file-container text-dark"
                                                    style="background-color: rgb(243, 242, 240);">
                                                    <b>{{ $file }}</b>
                                                    <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                            class="fa fa-eye text-primary"
                                                            style="font-size:20px; margin-right:-10px;"></i></a>
                                                    <a type="button" class="remove-file"
                                                        data-file-name="{{ $file }}"><i
                                                            class="fa-solid fa-circle-xmark"
                                                            style="color:red; font-size:20px;"></i></a>
                                                </h6>
                                            @endforeach
                                        @endif
                                    </div>
                                    <div class="add-btn">
                                        <div>Add</div>
                                        <input type="file" id="qa_verification_file" name="qa_verification_file[]"
                                            {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                            oninput="addMultipleFiles(this, 'qa_verification_file')" multiple>
                                    </div>
                                </div>
                                <!-- Hidden input to store removed files -->
                                <input type="hidden" name="removed_files" id="removed_files">
                            </div>
                        </div> --}}
                        <div class="col-12">
                            <div class="group-input">
                                <label for="qa_verification_file">QA Verification Attachment</label>
                                <div><small class="text-primary">Please Attach all relevant or supporting
                                        documents</small></div>
                                <div class="file-attachment-field">
                                    <div class="file-attachment-list" id="qa_verification_file">
                                        @if ($data->qa_verification_file)
                                            @foreach (json_decode($data->qa_verification_file) as $file)
                                                <h6 type="button" class="file-container text-dark"
                                                    style="background-color: rgb(243, 242, 240);">
                                                    <b>{{ $file }}</b>
                                                    <a href="{{ asset('upload/' . $file) }}" target="_blank">
                                                        <i class="fa fa-eye text-primary"
                                                            style="font-size:20px; margin-right:-10px;"></i>
                                                    </a>
                                                    <a type="button" class="remove-file"
                                                        data-file-name="{{ $file }}">
                                                        <i class="fa-solid fa-circle-xmark"
                                                            style="color:red; font-size:20px;"></i>
                                                    </a>
                                                    <input type="hidden" name="existing_qa_verification_file[]"
                                                        value="{{ $file }}">
                                                </h6>
                                            @endforeach
                                        @endif
                                    </div>
                                    <div class="add-btn">
                                        <div>Add</div>
                                        <input type="file" id="myfile" name="qa_verification_file[]"
                                        {{ $data->stage != 6 ? 'disabled' : '' }}
                                            oninput="addMultipleFiles(this, 'qa_verification_file')" multiple>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hidden field to keep track of files to be deleted -->
                        <input type="hidden" id="deleted_qa_verification_file" name="deleted_qa_verification_file"
                            value="">

                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const removeButtons = document.querySelectorAll('.remove-file');

                                removeButtons.forEach(button => {
                                    button.addEventListener('click', function() {
                                        const fileName = this.getAttribute('data-file-name');
                                        const fileContainer = this.closest('.file-container');

                                        // Hide the file container
                                        if (fileContainer) {
                                            fileContainer.style.display = 'none';
                                            // Remove hidden input associated with this file
                                            const hiddenInput = fileContainer.querySelector('input[type="hidden"]');
                                            if (hiddenInput) {
                                                hiddenInput.remove();
                                            }

                                            // Add the file name to the deleted files list
                                            const deletedFilesInput = document.getElementById(
                                                'deleted_qa_verification_file');
                                            let deletedFiles = deletedFilesInput.value ? deletedFilesInput.value.split(
                                                ',') : [];
                                            deletedFiles.push(fileName);
                                            deletedFilesInput.value = deletedFiles.join(',');
                                        }
                                    });
                                });
                            });

                            function addMultipleFiles(input, id) {
                                const fileListContainer = document.getElementById(id);
                                const files = input.files;

                                for (let i = 0; i < files.length; i++) {
                                    const file = files[i];
                                    const fileName = file.name;
                                    const fileContainer = document.createElement('h6');
                                    fileContainer.classList.add('file-container', 'text-dark');
                                    fileContainer.style.backgroundColor = 'rgb(243, 242, 240)';

                                    const fileText = document.createElement('b');
                                    fileText.textContent = fileName;

                                    const viewLink = document.createElement('a');
                                    viewLink.href = '#'; // You might need to adjust this to handle local previews
                                    viewLink.target = '_blank';
                                    viewLink.innerHTML = '<i class="fa fa-eye text-primary" style="font-size:20px; margin-right:-10px;"></i>';

                                    const removeLink = document.createElement('a');
                                    removeLink.classList.add('remove-file');
                                    removeLink.dataset.fileName = fileName;
                                    removeLink.innerHTML = '<i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i>';
                                    removeLink.addEventListener('click', function() {
                                        fileContainer.style.display = 'none';
                                    });

                                    fileContainer.appendChild(fileText);
                                    fileContainer.appendChild(viewLink);
                                    fileContainer.appendChild(removeLink);

                                    fileListContainer.appendChild(fileContainer);
                                }
                            }
                        </script>


                        <div class="button-block">
                            <button type="submit" class="saveButton">Save</button>
                            <button type="button" class="backButton" onclick="previousStep()">Back</button>
                            <button type="button" class="nextButton" onclick="nextStep()">Next</button>
                            <button type="button"> <a href="{{ url('rcms/qms-dashboard') }}" class="text-white">
                                    Exit </a> </button>
                        </div>
                    </div>
                </div>

                <div id="CCForm4" class="inner-block cctabcontent">
                    <div class="inner-block-content">

                        {{-- <div class="new-date-data-field">
                            <div class="group-input input-date">
                                <label for="next_managment_review_date">Next Management Review Date</label>
                                <div class="calenderauditee">
                                    <input type="text" id="next_managment_review_date" readonly
                                        {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                        placeholder="DD-MMM-YYYY"
                                        value="{{ Helpers::getdateFormat($data->next_managment_review_date) }}" />
                                    <input type="date" name="next_managment_review_date"
                                        {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                        min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"
                                        value="{{ $data->next_managment_review_date }} " class="hide-input"
                                        oninput="handleDateInput(this, 'next_managment_review_date')" />
                                </div>
                            </div>
                        </div> --}}
                        {{-- <div class="group-input">
                                <label for="summary_recommendation">Summary & Recommendation</label>
                                <textarea name="summary_recommendation" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->summary_recommendation }}</textarea>
                            </div> --}}
                        {{-- <div class="group-input">
    <label for="conclusion">QA Head Comment <span class="text-danger">*</span></label>
    <textarea name="conclusion_new" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }} required>{{ $data->conclusion_new }}</textarea>
</div> --}}
                        <div class="col-md-12">
                            @if ($data->stage == 7)
                                <div class="group-input">
                                    <label for="HOD Remarks">QA Head Comment <span class="text-danger">*</span></label>
                                    <div><small class="text-primary">Please insert "NA" in the data field if it
                                            does not require completion</small></div>
                                    <textarea class="tiny" name="conclusion_new" id="summernote-4" required>{{ $data->conclusion_new }}</textarea>
                                </div>
                            @else
                                <div class="group-input">
                                    <label for="HOD Remarks">QA Head Comment</label>
                                    <div><small class="text-primary">Please insert "NA" in the data field if it
                                            does not require completion</small></div>
                                    <textarea readonly class="tiny" name="conclusion_new" id="summernote-4">{{ $data->conclusion_new }}</textarea>
                                </div>
                            @endif
                            @error('conclusion_new')
                                <div class="text-danger">{{ $message }}</div>
                            @enderror
                        </div>

                        {{-- <div class="group-input">
                            <label for="closure_attachments">Closure Attachments</label>
                            <div><small class="text-primary">Please Attach all relevant or supporting
                                    documents</small></div>
                            <div class="file-attachment-field">
                                <div disabled class="file-attachment-list" id="closure_attachments">
                                    @if ($data->closure_attachments)
                                        @foreach (json_decode($data->closure_attachments) as $file)
                                            <h6 type="button" class="file-container text-dark"
                                                style="background-color: rgb(243, 242, 240);">
                                                <b>{{ $file }}</b>
                                                <a href="{{ asset('upload/' . $file) }}" target="_blank"><i
                                                        class="fa fa-eye text-primary"
                                                        style="font-size:20px; margin-right:-10px;"></i></a>
                                                <a type="button" class="remove-file"
                                                    data-file-name="{{ $file }}"><i
                                                        class="fa-solid fa-circle-xmark"
                                                        style="color:red; font-size:20px;"></i></a>
                                            </h6>
                                        @endforeach
                                    @endif
                                </div>
                                <div class="add-btn">
                                    <div>Add</div>
                                    <input type="file" id="myfile" name="closure_attachments[]"
                                        {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}
                                        oninput="addMultipleFiles(this, 'closure_attachments')" multiple>
                                </div>
                            </div>
                        </div> --}}
                        <div class="col-12">
                            <div class="group-input">
                                <label for="closure_attachments">Closure Attachments</label>
                                <div><small class="text-primary">Please Attach all relevant or supporting
                                        documents</small></div>
                                <div class="file-attachment-field">
                                    <div class="file-attachment-list" id="closure_attachments">
                                        @if ($data->closure_attachments)
                                            @foreach (json_decode($data->closure_attachments) as $file)
                                                <h6 type="button" class="file-container text-dark"
                                                    style="background-color: rgb(243, 242, 240);">
                                                    <b>{{ $file }}</b>
                                                    <a href="{{ asset('upload/' . $file) }}" target="_blank">
                                                        <i class="fa fa-eye text-primary"
                                                            style="font-size:20px; margin-right:-10px;"></i>
                                                    </a>
                                                    <a type="button" class="remove-file"
                                                        data-file-name="{{ $file }}">
                                                        <i class="fa-solid fa-circle-xmark"
                                                            style="color:red; font-size:20px;"></i>
                                                    </a>
                                                    <input type="hidden" name="existing_closure_attachments[]"
                                                        value="{{ $file }}">
                                                </h6>
                                            @endforeach
                                        @endif
                                    </div>
                                    <div class="add-btn">
                                        <div>Add</div>
                                        <input type="file" id="myfile" name="closure_attachments[]"
                                        {{ $data->stage != 7 ? 'disabled' : '' }}
                                            oninput="addMultipleFiles(this, 'closure_attachments')" multiple>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hidden field to keep track of files to be deleted -->
                        <input type="hidden" id="deleted_closure_attachments" name="deleted_closure_attachments"
                            value="">

                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const removeButtons = document.querySelectorAll('.remove-file');

                                removeButtons.forEach(button => {
                                    button.addEventListener('click', function() {
                                        const fileName = this.getAttribute('data-file-name');
                                        const fileContainer = this.closest('.file-container');

                                        // Hide the file container
                                        if (fileContainer) {
                                            fileContainer.style.display = 'none';
                                            // Remove hidden input associated with this file
                                            const hiddenInput = fileContainer.querySelector('input[type="hidden"]');
                                            if (hiddenInput) {
                                                hiddenInput.remove();
                                            }

                                            // Add the file name to the deleted files list
                                            const deletedFilesInput = document.getElementById(
                                                'deleted_closure_attachments');
                                            let deletedFiles = deletedFilesInput.value ? deletedFilesInput.value.split(
                                                ',') : [];
                                            deletedFiles.push(fileName);
                                            deletedFilesInput.value = deletedFiles.join(',');
                                        }
                                    });
                                });
                            });

                            function addMultipleFiles(input, id) {
                                const fileListContainer = document.getElementById(id);
                                const files = input.files;

                                for (let i = 0; i < files.length; i++) {
                                    const file = files[i];
                                    const fileName = file.name;
                                    const fileContainer = document.createElement('h6');
                                    fileContainer.classList.add('file-container', 'text-dark');
                                    fileContainer.style.backgroundColor = 'rgb(243, 242, 240)';

                                    const fileText = document.createElement('b');
                                    fileText.textContent = fileName;

                                    const viewLink = document.createElement('a');
                                    viewLink.href = '#'; // You might need to adjust this to handle local previews
                                    viewLink.target = '_blank';
                                    viewLink.innerHTML = '<i class="fa fa-eye text-primary" style="font-size:20px; margin-right:-10px;"></i>';

                                    const removeLink = document.createElement('a');
                                    removeLink.classList.add('remove-file');
                                    removeLink.dataset.fileName = fileName;
                                    removeLink.innerHTML = '<i class="fa-solid fa-circle-xmark" style="color:red; font-size:20px;"></i>';
                                    removeLink.addEventListener('click', function() {
                                        fileContainer.style.display = 'none';
                                    });

                                    fileContainer.appendChild(fileText);
                                    fileContainer.appendChild(viewLink);
                                    fileContainer.appendChild(removeLink);

                                    fileListContainer.appendChild(fileContainer);
                                }
                            }
                        </script>

                        {{-- <div class="sub-head">
                                Extension Justification
                            </div>
                            <div class="group-input">
                                <label for="due_date_extension">Due Date Extension Justification</label>
                                <div><small class="text-primary">Please Mention justification if due date is
                                        crossed</small></div>
                                <textarea name="due_date_extension"{{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }}>{{ $data->due_date_extension }}</textarea>
                            </div> --}}
                        <div class="button-block">
                            <button type="submit" class="saveButton">Save</button>
                            <button type="button" class="backButton" onclick="previousStep()">Back</button>
                            <button type="button" class="nextButton" onclick="nextStep()">Next</button>
                            {{-- <button type="submit">Submit</button> --}}
                            <button type="button"> <a class="text-white" href="{{ url('dashboard') }}"> Exit
                                </a>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="CCForm5" class="inner-block cctabcontent">
                    <div class="inner-block-content">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Submit By">Submit By</label>
                                    <div class="">{{ $data->Submited_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Submit On">Submit On</label>
                                    <div class="">{{ $data->Submited_on ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Submit Comment">Submit Comment</label>
                                    <div class="">{{ $data->Submited_Comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Head Review Complete By">QA Head Review Complete By</label>
                                    <div class="">{{ $data->qaHeadReviewComplete_By ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Head Review Complete On">QA Head Review Complete On</label>
                                    <div class="">{{ $data->qaHeadReviewComplete_On ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Head Review Complete Comment">QA Head Review Complete Comment</label>
                                    <div class="">{{ $data->qaHeadReviewComplete_Comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Meeting and Summary Complete By">Meeting and Summary Complete By</label>
                                    <div class="">{{ $data->meeting_summary_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Meeting and Summary Complete On">Meeting and Summary Complete On</label>
                                    <div class="">{{ $data->meeting_summary_on ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Meeting and Summary Complete Comment">Meeting and Summary Complete Comment</label>
                                    <div class="">{{ $data->meeting_summary_comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT Action Complete By">CFT Action Complete By</label>
                                    <div class="">{{ $data->ALLAICompleteby_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT Action Complete On">CFT Action Complete On</label>
                                    <div class="">{{ $data->ALLAICompleteby_on ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT Action Complete Comment">CFT Action Complete Comment</label>
                                    <div class="">{{ $data->ALLAICompleteby_comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT HOD Review Complete By">CFT HOD Review Complete By</label>
                                    <div class="">{{ $data->hodFinaleReviewComplete_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT HOD Review Complete On">CFT HOD Review Complete On</label>
                                    <div class="">{{ $data->hodFinaleReviewComplete_on ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="CFT HOD Review Complete Comment">CFT HOD Review Complete Comment</label>
                                    <div class="">{{ $data->hodFinaleReviewComplete_comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Verification Complete By">QA Verification Complete By</label>
                                    <div class="">{{ $data->QAVerificationComplete_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Verification Complete On">QA Verification Complete On</label>
                                    <div class="">{{ $data->QAVerificationComplete_On ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="QA Verification Complete Comment">QA Verification Complete Comment</label>
                                    <div class="">{{ $data->QAVerificationComplete_Comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Approved By">Approved By</label>
                                    <div class="">{{ $data->Approved_by ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Approved On">Approved On</label>
                                    <div class="">{{ $data->Approved_on ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="group-input">
                                    <label for="Approved Comment">Approved Comment</label>
                                    <div class="">{{ $data->Approved_comment ?? 'Not Applicable' }}</div>
                                </div>
                            </div>
                        </div>
                        <div class="button-block">
                            <button type="button" class="backButton" onclick="previousStep()">Back</button>
                            <button type="button">
                                <a class="text-white" href="{{ url('rcms/qms-dashboard') }}">Exit</a>
                            </button>
                        </div>
                    </div>
                </div>


        </div>
        </form>

    </div>
    </div>
    <div class="modal fade" id="child-modal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Child</h4>
                </div>
                <form action="{{ route('childmanagementReview', $data->id) }}" method="POST">
                    @csrf
                    <!-- Modal body -->
                    <div class="modal-body">
                        <div class="group-input">
                            <label for="major">
                                <input type="radio" name="revision" id="major" value="Action-Item">
                                Action Item
                            </label>

                        </div>

                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" data-bs-dismiss="modal">Close</button>
                        <button type="submit">Continue</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <div class="modal fade" id="rejection-modal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">E-Signature</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <form action="{{ route('manage_send_more_require_stage', $data->id) }}" method="POST">
                    @csrf
                    <!-- Modal body -->
                    <div class="modal-body">
                        <div class="mb-3 text-justify">
                            Please select a meaning and a outcome for this task and enter your username
                            and password for this task. You are performing an electronic signature,
                            which is legally binding equivalent of a hand written signature.
                        </div>
                        <div class="group-input">
                            <label for="username">Username <span class="text-danger">*</span></label>
                            <input type="text" name="username" required>
                        </div>
                        <div class="group-input">
                            <label for="password">Password <span class="text-danger">*</span></label>
                            <input type="password" name="password" required>
                        </div>
                        <div class="group-input">
                            <label for="comment">Comment <span class="text-danger">*</span></label>
                            <input type="comment" name="comment" required>
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <!-- <div class="modal-footer">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button type="submit" data-bs-dismiss="modal">Submit</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button>Close</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div> -->
                    <div class="modal-footer">
                        <button type="submit">Submit</button>
                        <button type="button" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="cancel-modal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">E-Signature</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <form action="{{ route('manageCancel', $data->id) }}" method="POST">
                    @csrf
                    <!-- Modal body -->
                    <div class="modal-body">
                        <div class="mb-3 text-justify">
                            Please select a meaning and a outcome for this task and enter your username
                            and password for this task. You are performing an electronic signature,
                            which is legally binding equivalent of a hand written signature.
                        </div>
                        <div class="group-input">
                            <label for="username">Username <span class="text-danger">*</span></label>
                            <input type="text" name="username" required>
                        </div>
                        <div class="group-input">
                            <label for="password">Password <span class="text-danger">*</span></label>
                            <input type="password" name="password" required>
                        </div>
                        <div class="group-input">
                            <label for="comment">Comment <span class="text-danger">*</span></label>
                            <input type="comment" name="comment" required>
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <!-- <div class="modal-footer">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button type="submit" data-bs-dismiss="modal">Submit</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button>Close</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div> -->
                    <div class="modal-footer">
                        <button type="submit">Submit</button>
                        <button type="button" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="signature-modal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">E-Signature</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="{{ route('manage_send_stage', $data->id) }}" method="POST">
                    @csrf
                    <!-- Modal body -->
                    <div class="modal-body">
                        <div class="mb-3 text-justify">
                            Please select a meaning and a outcome for this task and enter your username
                            and password for this task. You are performing an electronic signature,
                            which is legally binding equivalent of a hand written signature.
                        </div>
                        <div class="group-input">
                            <label for="username">Username <span class="text-danger">*</span></label>
                            <input type="text" name="username" required>
                        </div>
                        <div class="group-input">
                            <label for="password">Password <span class="text-danger">*</span></label>
                            <input type="password" name="password" required>
                        </div>
                        <div class="group-input">
                            <label for="comment">Comment</label>
                            <input type="comment" name="comment">
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <!-- <div class="modal-footer">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button type="submit" data-bs-dismiss="modal">Submit</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <button>Close</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div> -->
                    <div class="modal-footer">
                        <button type="submit">Submit</button>
                        <button type="button" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <style>
        #step-form>div {
            display: none
        }

        #step-form>div:nth-child(1) {
            display: block;
        }
    </style>

    <script>
        $(document).on('click', '.removeRowBtn', function() {
            $(this).closest('tr').remove();
        })
    </script>
    <script>
        $(document).on('click', '.removeRow', function() {
            $(this).closest('tr').remove();
        })
    </script>
    <script>
        $(document).on('click', '.removeBtn', function() {
            $(this).closest('tr').remove();
        })
    </script>

    <script>
        $(document).on('click', '.removeBtnaid', function() {
            $(this).closest('tr').remove();
        })
    </script>
    <script>
        $(document).on('click', '.removeRowBtnat', function() {
            $(this).closest('tr').remove();
        })
    </script>
    <script>
        VirtualSelect.init({
            ele: '#Facility, #Group, #Audit, #Auditee,#assign_to'
        });

        function addActionItemDetails(tableId) {
            var users = @json($users);
            var table = document.getElementById(tableId);
            var currentRowCount = table.rows.length;
            var newRow = table.insertRow(currentRowCount);
            newRow.setAttribute("id", "row" + currentRowCount);
            var cell1 = newRow.insertCell(0);
            cell1.innerHTML = currentRowCount;

            var cell2 = newRow.insertCell(1);
            cell2.innerHTML = "<input type='text' name='short_desc[]'>";

            var cell3 = newRow.insertCell(2);
            cell3.innerHTML =
                '<td><div class="group-input new-date-data-field mb-0"><div class="input-date "><div class="calenderauditee"> <input type="text" id="date_due' +
                currentRowCount +
                '" readonly placeholder="DD-MMM-YYYY" /><input type="date" name="date_due[]" {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}  min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"  id="date_due' +
                currentRowCount + '_checkdate"  class="hide-input" oninput="handleDateInput(this, `date_due' +
            currentRowCount + '`);checkDate(`date_due' + currentRowCount + '_checkdate`,`date_closed' +
            currentRowCount + '_checkdate`)" /></div></div></div></td>';

            var cell4 = newRow.insertCell(3);
            cell4.innerHTML = "<input type='text' name='site[]'>";

            var cell5 = newRow.insertCell(4);
            var userHtml = '<select name="responsible_person[]"><option value="">-- Select --</option>';
            for (var i = 0; i < users.length; i++) {
                userHtml += '<option value="' + users[i].id + '">' + users[i].name + '</option>';
            }
            userHtml += '</select>';

            cell5.innerHTML = userHtml;

            var cell6 = newRow.insertCell(5);
            cell6.innerHTML = "<input type='text' name='current_status[]'>";

            var cell7 = newRow.insertCell(6);
            cell7.innerHTML =
                '<td><div class="group-input new-date-data-field mb-0"><div class="input-date "><div class="calenderauditee"> <input type="text" id="date_closed' +
                currentRowCount +
                '" readonly placeholder="DD-MMM-YYYY" /><input type="date" name="date_closed[]"  min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"  id="date_closed' +
                currentRowCount + '_checkdate" class="hide-input" oninput="handleDateInput(this, `date_closed' +
            currentRowCount + '`);checkDate(`date_due' + currentRowCount + '_checkdate`,`date_closed' +
            currentRowCount + '_checkdate`)" /></div></div></div></td>';

            var cell8 = newRow.insertCell(7);
            cell8.innerHTML = "<input type='text' name='remark[]'>";

            var cell9 = newRow.insertCell(8);
            cell9.innerHTML = "<button type='text' class='removeRow' name='Action[]' readonly>Remove</button>";

            for (var i = 1; i < currentRowCount; i++) {
                var row = table.rows[i];
                row.cells[0].innerHTML = i;
            }
        }

        function addPerformanceEvoluation(tableId) {
            var table = document.getElementById(tableId);
            var currentRowCount = table.rows.length;
            var newRow = table.insertRow(currentRowCount);
            newRow.setAttribute("id", "row" + currentRowCount);
            var cell1 = newRow.insertCell(0);
            cell1.innerHTML = currentRowCount;

            var cell2 = newRow.insertCell(1);
            cell2.innerHTML = "<input type='text' name='monitoring[]'>";

            var cell3 = newRow.insertCell(2);
            cell3.innerHTML = "<input type='text' name='measurement[]'>";

            var cell4 = newRow.insertCell(3);
            cell4.innerHTML = "<input type='text' name='analysis[]'>";

            var cell5 = newRow.insertCell(4);
            cell5.innerHTML = "<input type='text' name='evaluation[]'>";

            var cell6 = newRow.insertCell(5);
            cell6.innerHTML = "<button type='text' class='removeBtn' name='Action[]' readonly>Remove</button>";

            for (var i = 1; i < currentRowCount; i++) {
                var row = table.rows[i];
                row.cells[0].innerHTML = i;
            }
        }

        // ================================ SIX INPUTS
        function addAgendaManRev(tableId) {
            var table = document.getElementById(tableId);
            var currentRowCount = table.rows.length;
            var newRow = table.insertRow(currentRowCount);
            newRow.setAttribute("id", "row" + currentRowCount);
            var cell1 = newRow.insertCell(0);
            cell1.innerHTML = currentRowCount;

            var cell2 = newRow.insertCell(1);
            cell2.innerHTML =
                '<td><div class="group-input new-date-data-field mb-0"><div class="input-date "><div class="calenderauditee"> <input type="text" id="date' +
                currentRowCount +
                '" readonly placeholder="DD-MMM-YYYY" /><input type="date" name="date[]" {{ $data->stage == 0 || $data->stage == 6 ? 'disabled' : '' }}  min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"  id="date' +
                currentRowCount + '_checkdate"  class="hide-input" oninput="handleDateInput(this, `date' + currentRowCount +
            '`);" /></div></div></div></td>';

            var cell3 = newRow.insertCell(2);
            cell3.innerHTML = "<input type='text' name='topic[]' >";

            var cell4 = newRow.insertCell(3);
            cell4.innerHTML = "<input type='text' name='responsible[]'>";

            var cell5 = newRow.insertCell(4);
            cell5.innerHTML = "<input type='time' name='start_time[]'>";

            var cell6 = newRow.insertCell(5);
            cell6.innerHTML = "<input type='time' name='end_time[]'>";

            var cell7 = newRow.insertCell(6);
            cell7.innerHTML = "<input type='text' name='comment[]'>";

            var cell8 = newRow.insertCell(7);
            cell8.innerHTML = "<button type='text' class='removeRowBtnat' name='Action[]' readonly>Remove</button>";

            for (var i = 1; i < currentRowCount; i++) {
                var row = table.rows[i];
                row.cells[0].innerHTML = i;
            }
        }

        function openCity(evt, cityName) {
            var i, cctabcontent, cctablinks;
            cctabcontent = document.getElementsByClassName("cctabcontent");
            for (i = 0; i < cctabcontent.length; i++) {
                cctabcontent[i].style.display = "none";
            }
            cctablinks = document.getElementsByClassName("cctablinks");
            for (i = 0; i < cctablinks.length; i++) {
                cctablinks[i].className = cctablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }



        function openCity(evt, cityName) {
            var i, cctabcontent, cctablinks;
            cctabcontent = document.getElementsByClassName("cctabcontent");
            for (i = 0; i < cctabcontent.length; i++) {
                cctabcontent[i].style.display = "none";
            }
            cctablinks = document.getElementsByClassName("cctablinks");
            for (i = 0; i < cctablinks.length; i++) {
                cctablinks[i].className = cctablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";

            // Find the index of the clicked tab button
            const index = Array.from(cctablinks).findIndex(button => button === evt.currentTarget);

            // Update the currentStep to the index of the clicked tab
            currentStep = index;
        }

        const saveButtons = document.querySelectorAll(".saveButton");
        const nextButtons = document.querySelectorAll(".nextButton");
        const form = document.getElementById("step-form");
        const stepButtons = document.querySelectorAll(".cctablinks");
        const steps = document.querySelectorAll(".cctabcontent");
        let currentStep = 0;

        function nextStep() {
            // Check if there is a next step
            if (currentStep < steps.length - 1) {
                // Hide current step
                steps[currentStep].style.display = "none";

                // Show next step
                steps[currentStep + 1].style.display = "block";

                // Add active class to next button
                stepButtons[currentStep + 1].classList.add("active");

                // Remove active class from current button
                stepButtons[currentStep].classList.remove("active");

                // Update current step
                currentStep++;
            }
        }

        function previousStep() {
            // Check if there is a previous step
            if (currentStep > 0) {
                // Hide current step
                steps[currentStep].style.display = "none";

                // Show previous step
                steps[currentStep - 1].style.display = "block";

                // Add active class to previous button
                stepButtons[currentStep - 1].classList.add("active");

                // Remove active class from current button
                stepButtons[currentStep].classList.remove("active");

                // Update current step
                currentStep--;
            }
        }
    </script>

    <script>
        // JavaScript
        document.getElementById('initiator_group').addEventListener('change', function() {
            var selectedValue = this.value;
            document.getElementById('initiator_group_code').value = selectedValue;
        });
    </script>
    <script>
        $(document).ready(function() {
            $('#capa_detail').click(function(e) {
                function generateTableRow(serialNumber) {
                    var users = @json($users);
                    console.log(users);
                    var html =
                        '<tr>' +
                        '<td><input disabled type="text" name="serial_number[]" value="' + serialNumber +
                        '"></td>' +

                        '<td><input type="text" name="Details[]">' +
                        '<td><select id="select-state" placeholder="Select..." name="capa_type[]">' +
                        '<option value="">Select a value</option>' +
                        '<option value="corrective">Corrective Action</option>' +
                        '<option value="preventive">Preventive Action</option>' +
                        '<option value="corrective_preventive">Corrective & Preventive Action</option>' +
                        '</select></td>' +

                        '<td><input type="text" name="site2[]">' +
                        '<td><select name="responsible_person2[]">' +
                        '<option value="">Select a value</option>';

                    for (var i = 0; i < users.length; i++) {
                        html += '<option value="' + users[i].id + '">' + users[i].name + '</option>';
                    }

                    html += '</select></td>' +

                        '<td><input type="text" name="current_status2[]">' +

                        '<td><div class="group-input new-date-data-field mb-0"><div class="input-date "><div class="calenderauditee"><input type="text" id="date_closed2' +
                        serialNumber +
                        '" readonly placeholder="DD-MMM-YYYY" /><input type="date" name="date_closed2[]" {{ $data->stage == 0 || $data->stage == 8 ? 'disabled' : '' }} min="{{ \Carbon\Carbon::now()->format('Y-m-d') }}"  class="hide-input" oninput="handleDateInput(this, `date_closed2' +
                    serialNumber + '`)" /></div></div></div></td>' +

                        '<td><input type="text" name="remark2[]"></td>' +

                        '<td><button type="text" class="removeRowBtn" name="Action[]" readonly>Remove</button></td>' +

                        '</tr>';
                    return html;
                }

                var tableBody = $('#capa_detail_details tbody');
                var rowCount = tableBody.children('tr').length;
                var newRow = generateTableRow(rowCount + 1);
                tableBody.append(newRow);
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const removeButtons = document.querySelectorAll('.remove-file');

            removeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const fileName = this.getAttribute('data-file-name');
                    const fileContainer = this.closest('.file-container');

                    // Hide the file container
                    if (fileContainer) {
                        fileContainer.style.display = 'none';
                    }
                });
            });
        });
    </script>
    <script>
        console.log('Script working')

        $(document).ready(function() {


            function submitForm() {

                let auditForm = document.getElementById('auditForm');


                console.log('sumitting form')

                document.querySelectorAll('.saveAuditFormBtn').forEach(function(button) {
                    button.disabled = true;
                })

                document.querySelectorAll('.auditFormSpinner').forEach(function(spinner) {
                    spinner.style.display = 'flex';
                })

                auditForm.submit();
            }

            $('#ChangesaveButton01').click(function() {
                document.getElementById('formNameField').value = 'general-open';
                submitForm();
            });

            $('#ChangesaveButton02').click(function() {
                document.getElementById('formNameField').value = 'hod';
                submitForm();
            });
            $('#ChangesaveButton02221').click(function() {
                document.getElementById('formNameField').value = 'pending';
                submitForm();
            });
            $('#ChangesaveButton02222').click(function() {
                document.getElementById('formNameField').value = 'hod final';
                submitForm();
            });

            $('#ChangesaveButton03').click(function() {
                document.getElementById('formNameField').value = 'qa';
                submitForm();
            });

            $('#ChangesaveButton04').click(function() {
                document.getElementById('formNameField').value = 'capa';
                submitForm();
            });
            $('#ChangesaveButton022').click(function() {
                document.getElementById('formNameField').value = 'qrm';
                submitForm();
            });
            $('#ChangesaveButton023').click(function() {
                document.getElementById('formNameField').value = 'inv';
                submitForm();
            });

            $('#ChangesaveButton05').click(function() {
                document.getElementById('formNameField').value = 'qa-final';
                submitForm();
            });

            $('#ChangesaveButton06').click(function() {
                document.getElementById('formNameField').value = 'qah';
                submitForm();
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            var signatureForm = document.getElementById('signatureModalForm');

            signatureForm.addEventListener('submit', function(e) {

                var submitButton = signatureForm.querySelector('.signatureModalButton');
                var spinner = signatureForm.querySelector('.signatureModalSpinner');

                submitButton.disabled = true;

                spinner.style.display = 'inline-block';
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            var signatureForm = document.getElementById('pendingInitiatorForm');

            signatureForm.addEventListener('submit', function(e) {

                var submitButton = signatureForm.querySelector('.pendingInitiatorModalButton');
                var spinner = signatureForm.querySelector('.pendingInitiatorModalSpinner');

                submitButton.disabled = true;

                spinner.style.display = 'inline-block';
            });
        });


        // =========================
        wow = new WOW({
            boxClass: 'wow', // default
            animateClass: 'animated', // default
            offset: 0, // default
            mobile: true, // default
            live: true // default
        })
        wow.init();
    </script>
    <script>
        var maxLength = 255;
        $('#docname').keyup(function() {
            var textlen = maxLength - $(this).val().length;
            $('#rchars').text(textlen);
        });
    </script>
@endsection
